---
title: CRowset – třída
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 6af7b30ef7055fbf5b3c998dba6f3b84d0129c31
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/31/2018
ms.locfileid: "50543062"
---
# <a name="crowset-class"></a>CRowset – třída

Zapouzdřuje objektu sady řádků OLE DB a několika související rozhraní a poskytuje metody zpracování pro datové sady řádků.

## <a name="syntax"></a>Syntaxe

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parametry

*TAccessor*<br/>
Třídu přistupujícího objektu. Výchozí hodnota je `CAccessorBase`.

## <a name="requirements"></a>Požadavky

**Záhlaví:** také atldbcli.h

## <a name="members"></a>Členové

### <a name="methods"></a>Metody

|||
|-|-|
|[Addrefrows –](#addrefrows)|Zvýší počet odkazů spojené s aktuálním řádku.|
|[Zavřít](#close)|Uvolní řádků a aktuální `IRowset` rozhraní.|
|[Compare](#compare)|Porovná dvě záložky pomocí [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539).|
|[CRowset –](#crowset)|Vytvoří novou `CRowset` objektu a přidruží ji k (volitelně) `IRowset` rozhraní zadanou jako parametr.|
|[Delete](#delete)|Odstraní řádky z řádků pomocí [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v%3dvs.85)).|
|[FindNextRow](#findnextrow)|Vyhledá další odpovídající řádek po zadanou záložkou.|
|[Getapproximateposition –](#getapproximateposition)|Vrátí přibližné pozici řádku odpovídající záložku.|
|[GetData](#getdata)|Načte data z dané sadě řádků kopii řádku.|
|[GetDataHere](#getdatahere)|Načte data ze zadané vyrovnávací paměti.|
|[GetOriginalData](#getoriginaldata)|Načte data naposledy načtených z nebo přeneseno do zdroje dat, ignoruje se čekající změny.|
|[GetRowStatus –](#getrowstatus)|Vrátí stav všech řádků.|
|[Vložit](#insert)|Vytvoří a vloží nový řádek pomocí [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921).|
|[Issamerow –](#issamerow)|Porovná zadaný řádek s aktuálním řádkem.|
|[MoveFirst](#movefirst)|Přemístí další načtení umístění na počáteční pozici.|
|[MoveLast](#movelast)|Přejde na poslední záznam.|
|[Metoda MoveNext](#movenext)|Načte data z dalšího řádku sekvenční nebo určený počet pozic za další řádek.|
|[MovePrev](#moveprev)|Přesune na předchozí záznam.|
|[MoveToBookmark](#movetobookmark)|Načte řádek označený záložkou nebo řádek na zadaný posun z tuto záložku.|
|[Movetoratio –](#movetoratio)|Načte řádky začínající od desetinné pozice v dané sadě řádků.|
|[Releaserows –](#releaserows)|Volání [IRowset::ReleaseRows](/previous-versions/windows/desktop/ms719771) uvolnit popisovač aktuálního řádku.|
|[SetData](#setdata)|Nastaví hodnoty dat v řádku použití jednoho nebo více sloupců [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232).|
|[Vrácení zpět](#undo)|Vrátí zpět všechny změny provedené od posledního načtení řádek nebo [aktualizace](../../data/oledb/crowset-update.md).|
|[Aktualizace](#update)|Odesílá všechny neuložené změny provedené od posledního načtení nebo aktualizace na aktuálním řádku.|
|[UpdateAll](#updateall)|Odesílá všechny neuložené změny provedené od posledního načtení nebo aktualizace pro všechny řádky.|

## <a name="remarks"></a>Poznámky

Sady řádků v OLE DB, je objekt, jehož prostřednictvím programu nastaví a načítá data.

Tato třída není určena k vytvoření instance, ale spíše předán jako parametr šablony `CTable` nebo `CCommand` (`CRowset` je výchozí nastavení).

## <a name="addrefrows"></a> CRowset::AddRefRows

Volání [IRowset::AddRefRows](/previous-versions/windows/desktop/ms719619) přírůstku (jeden) počet odkazů spojené s aktuálním popisovač řádku.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda zvýší počet odkazů pro popisovač aktuálního řádku. Volání [releaserows –](../../data/oledb/crowset-releaserows.md) se sníží počet. Řádky vrácené přesunutí metody mají referenční počet jeden.

## <a name="close"></a> CRowset::Close

Uvolní řádků a aktuální [IRowset](/previous-versions/windows/desktop/ms720986) rozhraní.

### <a name="syntax"></a>Syntaxe

```cpp
void Close() throw();
```

### <a name="remarks"></a>Poznámky

Tato metoda uvolní všechny řádky aktuálně v dané sadě řádků.

## <a name="compare"></a> CRowset::Compare

Porovná dvě záložky pomocí [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539).

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1, 
   const CBookmarkBase& bookmark2, 
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parametry

*Bookmark1*<br/>
[in] Prvním záložek k porovnání.

*Bookmark2*<br/>
[in] Druhý záložku k porovnání.

*pComparison*<br/>
[out] Ukazatel na výsledek porovnání.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, volitelné rozhraní `IRowsetLocate`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetLocate` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

Informace o používání záložek v příjemci najdete v tématu [pomocí záložky](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a> CRowset::CRowset

Vytvoří novou `CRowset` objektu a přidruží ji k (volitelně) [IRowset](/previous-versions/windows/desktop/ms720986) rozhraní zadanou jako parametr.

### <a name="syntax"></a>Syntaxe

```cpp
CRowset(); 

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parametry

*pRowset*<br/>
[in] Ukazatel `IRowset` rozhraní má být přidružena k této třídy.

## <a name="delete"></a> CRowset::Delete

Volání [IRowsetChange::DeleteRows](/previous-versions/windows/desktop/ms724362(v%3dvs.85)) odstranit aktuální řádek ze sady řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

## <a name="findnextrow"></a> CRowset::FindNextRow

Vyhledá další odpovídající řádek po zadanou záložkou.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT FindNextRow(DBCOMPAREOP op, 
   BYTE* pData, 
   DBTYPE wType, 
   DBLENGTH nLength, 
   BYTE bPrecision, 
   BYTE bScale, 
   BOOL bSkipCurrent = TRUE, 
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*OP*<br/>
[in] Operace pro použití v porovnávání hodnot řádků. Hodnoty, najdete v části [IRowsetFind::FindNextRow](/previous-versions/windows/desktop/ms723091).

*pData*<br/>
[in] Ukazatel na hodnotu, která si měly odpovídat.

*wType*<br/>
[in] Určuje datový typ z část hodnoty vyrovnávací paměti. Informace o typ ukazatele, naleznete v tématu [datové typy](/previous-versions/windows/desktop/ms723969) v *OLE DB referenční informace pro programátory* v sadě Windows SDK.

*nLength*<br/>
[in] Délka v bajtech, datové struktury příjemce přidělené pro hodnotu data. Podrobnosti najdete v tématu Popis `cbMaxLen` v [DBBINDING struktury](/previous-versions/windows/desktop/ms716845) v *OLE DB referenční informace pro programátory.*

*bPrecision*<br/>
[in] Při získávání dat maximální přesnost. Používá pouze tehdy, pokud *wType* je DBTYPE_NUMERIC. Další informace najdete v tématu [převody zahrnující DBTYPE_NUMERIC nebo DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714) v *OLE DB referenční informace pro programátory*.

*bScale*<br/>
[in] Při získávání dat stupnice. Používá pouze tehdy, pokud *wType* DBTYPE_NUMERIC nebo DBTYPE_DECIMAL. Další informace najdete v tématu [převody zahrnující DBTYPE_NUMERIC nebo DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714) v *OLE DB referenční informace pro programátory*.

*bSkipCurrent*<br/>
[in] Počet řádků ze záložky, ve kterém se má spustit vyhledávání.

*pBookmark*<br/>
[in] Záložka pro umístění, ve kterém se má spustit vyhledávání.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, volitelné rozhraní `IRowsetFind`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetFind` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

Informace o používání záložek v příjemci najdete v tématu [pomocí záložky](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition

Vrátí přibližné pozici řádku odpovídající záložku.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark, 
   DBCOUNTITEM* pPosition, 
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parametry

*pBookmark*<br/>
[in] Ukazatel na záložku, která určuje řádek, jehož pozice se má nacházet. Pokud počet řádků je vyžadována pouze s hodnotou NULL.

*pPosition*<br/>
[out] Ukazatel do umístění, kde `GetApproximatePosition` vrátí pozici řádku. Hodnota NULL, pokud pozice není potřeba.

*pcRows*<br/>
[out] Ukazatel do umístění, kde `GetApproximatePosition` vrátí celkový počet řádků. Hodnota NULL, pokud počet řádků se nevyžaduje.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, volitelné rozhraní `IRowsetScroll`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetScroll` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

Informace o používání záložek v příjemci najdete v tématu [pomocí záložky](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a> CRowset::GetData

Načte data z dané sadě řádků kopii řádku.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetData() throw(); 

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
[in] Číslo indexu (nula posun) přistupujícího objektu pro přístup k data.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Pokud zadáte přistupující objekt, který není objekt automaticky přistupující objekt v [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), pomocí této metody můžete explicitně získat data předáním číslo přistupujícího objektu.

## <a name="getdatahere"></a> CRowset::GetDataHere

Načte data z aktuální řádek a umístí jej do zadané vyrovnávací paměti.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetDataHere(int nAccessor, 
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
[in] Indexové číslo přístupový objekt pro účely přístupu k datům.

*pBuffer*<br/>
[out] Vyrovnávací paměť do kterého chcete uložit data pro aktuální záznam.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Příklad toho, jak tuto funkci použít, najdete v článku [MultiRead ukázka](../../visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData

Volání `IRowsetUpdate::GetOriginalData` k načtení dat naposledy načtených z nebo přeneseno do zdroje dat.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda načítá data z načteno jako poslední nebo přeneseno do zdroje dat; Tato možnost nenačte hodnoty na základě čekajících změn.

Tato metoda vyžaduje, volitelné rozhraní `IRowsetUpdate`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetUpdate` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

## <a name="getrowstatus"></a> CRowset::GetRowStatus

Vrátí stav všech řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parametry

*pStatus*<br/>
[out] Ukazatel na umístění kde `GetRowStatus` vrátí hodnotu stavu. Zobrazit DBPENDINGSTATUS v odkazu na programátora OLE DB.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, volitelné rozhraní `IRowsetUpdate`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetUpdate` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

## <a name="insert"></a> CRowset::Insert

Vytvoří a inicializuje nový řádek pomocí dat z přistupujícího objektu.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Insert(int nAccessor = 0, 
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
[in] Počet přistupující objekt používaná pro vkládání dat

*bGetHRow*<br/>
[in] Označuje, zda je načíst popisovač vloženého řádku.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, volitelné rozhraní `IRowsetChange`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetChange` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

Vložit může selhat, pokud jeden nebo více sloupců se nedá zapisovat. Upravte mapu kurzor to chcete opravit.

### <a name="example"></a>Příklad

Následující příklad ukazuje, jak přístup ke zdroji dat prostřednictvím sady řádků a vložte řetězec pomocí tabulky v této sadě řádků.

Nejprve vytvořte třídu tabulku vložíte-li objekt knihovny ATL do projektu. Například, klikněte pravým tlačítkem na projekt v podokně pracovní prostor a vyberte **nový objekt knihovny ATL**. Z **přístup k datům** vyberte **příjemce**. Vytvořte objekt příjemce typu **tabulky**. (Výběr **tabulky** vytvoří sadu řádků přímo z tabulky; výběr **příkaz** vytvoří pomocí příkazu SQL sady řádků.) Vyberte zdroj dat, zadáte tabulku, pomocí kterého je možné přistupovat k danému zdroji dat. Při volání objektu příjemce **CCustomerTable**, pak byste implementovali vložení kódu následujícím způsobem:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset::IsSameRow

Porovná zadaný řádek s aktuálním řádkem.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parametry

*hRow*<br/>
[in] Popisovač na řádek, který má být porovnán s aktuální řádek.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT. S_OK označuje, že řádky jsou stejné. Další hodnoty, najdete v části [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629) v *OLE DB referenční informace pro programátory* v sadě Windows SDK.

## <a name="movefirst"></a> CRowset::MoveFirst

Přesune kurzor počáteční pozice a načte počáteční řádek.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Volání [IRowset::RestartPosition](/previous-versions/windows/desktop/ms712877) můžete přemístit další načtení umístění na počáteční pozici (umístění, která se další načítání umístění při vytváření v sadě řádků) a načte počáteční řádek.

## <a name="movelast"></a> CRowset::MoveLast

Přesune kurzor na poslední řádek.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Volání [IRowset::RestartPosition](/previous-versions/windows/desktop/ms712877) můžete přemístit další načtení umístění na poslední pozici a načte poslední řádek.

Tato metoda vyžaduje, že jste nastavili `DBPROP_CANSCROLLBACKWARDS` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků. (Pro lepší výkon, může být také nastavena `DBPROP_QUICKRESTART` k VARIANT_TRUE.)

## <a name="movenext"></a> CRowset::MoveNext

Přesune kurzor na další záznam.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip, 
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parametry

*lSkip*<br/>
[in] Počet řádků, které mají přeskočit načítáním.

*bForward*<br/>
[in] Předejte **true** Přesun na další záznam, **false** pro přechod dozadu.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT. Když se dosáhne konce řádků, vrátí DB_S_ENDOFROWSET.

### <a name="remarks"></a>Poznámky

Načte další sekvenční řádek z `CRowset` objekt pamatovat předchozí pozici. Volitelně můžete také přeskočit *lSkip* řádků nebo přesunutí zpětně.

Tato metoda vyžaduje, nastavte následující vlastnosti před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků:

- `DBPROP_CANSCROLLBACKWARDS` Pokud musí být VARIANT_TRUE *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` Pokud musí být VARIANT_TRUE *bForward* = false

V opačném případě (Pokud *lSkip* > = 0 a *bForward* = true), není potřeba nastavovat žádné další vlastnosti.

## <a name="moveprev"></a> CRowset::MovePrev

Přesune kurzor na předchozí záznam.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, nastavte buď `DBPROP_CANFETCHBACKWARDS` nebo `DBPROP_CANSCROLLBACKWARDS` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

## <a name="movetobookmark"></a> CRowset::MoveToBookmark

Načte řádek označený záložku nebo řádek na zadaný posun (*lSkip*) z tuto záložku.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark, 
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parametry

*záložky*<br/>
[in] Záložka označení umístění, ze kterého chcete načíst data.

*lSkip*<br/>
[in] Počtu řádků ze záložky pro cílový řádek. Pokud *lSkip* je nula, první řádek načtený je označenou záložkou a doplňujte řádek. Pokud *lSkip* 1, načíst první řádek je řádek po řádku označenou záložkou a doplňujte. Pokud *lSkip* se -1, načíst první řádek je řádek před označenou záložkou a doplňujte řádek.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, volitelné rozhraní `IRowsetLocate`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetLocate` VARIANT_TRUE a nastavte `DBPROP_CANFETCHBACKWARDS` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

Informace o používání záložek v příjemci najdete v tématu [pomocí záložky](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a> CRowset::MoveToRatio

Načte řádky začínající od desetinné pozice v dané sadě řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator, 
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parametry

*nNumerator*<br/>
[in] Čítač použít k určení desetinné poziční, ze kterého se má načíst data.

*nDenominator*<br/>
[in] Jmenovatel umožňuje určit, desetinné poziční, ze kterého se má načíst data.

*bForward*<br/>
[in] Označuje, zda se má přesunout vpřed nebo vzad. Výchozí hodnota je předat dál.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

`MoveToRatio` načte řádky podle zhruba následující vzorec:

`(nNumerator *  RowsetSize ) / nDenominator`

Kde `RowsetSize` je velikost řádků, měřený v řádcích. Přesnost tohoto vzorce závisí na konkrétního zprostředkovatele. Podrobnosti najdete v tématu [IRowsetScroll::GetRowsAtRatio](/previous-versions/windows/desktop/ms709602).

Tato metoda vyžaduje, volitelné rozhraní `IRowsetScroll`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetScroll` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

## <a name="releaserows"></a> CRowset::ReleaseRows

Volání [IRowset::ReleaseRows](/previous-versions/windows/desktop/ms719771) uvolnit popisovač aktuálního řádku.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

## <a name="setdata"></a> CRowset::SetData

Nastaví hodnoty dat do jednoho nebo více sloupců řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT SetData() const throw(); 

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
[in] Počet přístupový objekt pro účely přístupu k datům.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Pro `SetData` formulář, který přijímá žádné argumenty, všechny přistupující objekty se používají pro aktualizaci. Obvykle volání `SetData` k nastavení datové hodnoty ve sloupcích za sebou, zavolejte [aktualizace](../../data/oledb/crowset-update.md) přenést tyto změny.

Tato metoda vyžaduje, volitelné rozhraní `IRowsetChange`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetChange` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

Operace nastavení může selhat, pokud jeden nebo více sloupců se nedá zapisovat. Upravte mapu kurzor to chcete opravit.

## <a name="undo"></a> CRowset::Undo

Vrátí zpět všechny změny provedené od posledního načtení řádek nebo [aktualizace](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL, 
   HROW* phRow = NULL, 
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
[out] Ukazatel do umístění, kde `Undo` vrací počet řádků se pokusila vrátit zpět v případě potřeby.

*phRow*<br/>
[out] Ukazatel do umístění, kde `Undo` vrátí pole popisovačů pro všechny řádky se pokusila vrátit zpět v případě potřeby.

*pStatus*<br/>
[out] Ukazatel do umístění, kde `Undo` vrací hodnotu stavový řádek. Pokud je vrácen žádný stav *pStatus* má hodnotu null.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, volitelné rozhraní `IRowsetUpdate`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetUpdate` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

## <a name="update"></a> CRowset::Update

Odesílá všechny neuložené změny provedené na aktuálním řádku od posledního načtení nebo `Update` zavolat.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL, 
   HROW* phRow = NULL, 
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
[out] Ukazatel do umístění, kde `Update` vrací počet řádků se pokusil aktualizovat, pokud je to nutné.

*phRow*<br/>
[out] Ukazatel do umístění, kde `Update` vrátí popisovač řádku, který se pokusil aktualizovat. Žádný popisovač je vrácena, jestliže *phRow* má hodnotu null.

*pStatus*<br/>
[out] Ukazatel do umístění, kde `Update` vrací hodnotu stavový řádek. Pokud je vrácen žádný stav *pStatus* má hodnotu null.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

### <a name="remarks"></a>Poznámky

Odesílá všechny neuložené změny provedené na aktuálním řádku od posledního načtení nebo aktualizace řádku (pomocí `Update` nebo [UpdateAll](../../data/oledb/crowset-updateall.md)). Obvykle volání [SetData](../../data/oledb/crowset-setdata.md) nastavte data hodnoty ve sloupcích za sebou, a poté zavolejte `Update` přenést tyto změny.

Tato metoda vyžaduje, volitelné rozhraní `IRowsetUpdate`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetUpdate` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

## <a name="updateall"></a> CRowset::UpdateAll

Odesílá všechny čekající změny provedené od posledního načtení všech řádků nebo `Update` zavolat.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL, 
   HROW** pphRow = NULL, 
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
[out] Ukazatel do umístění, kde `UpdateAll` vrací počet řádků se pokusil aktualizovat, pokud je to nutné.

*pphRow*<br/>
[out] Ukazatel na paměť `UpdateAll` vrátí popisovač řádku, který se pokusil aktualizovat. Žádný popisovač je vrácena, jestliže *pphRow* má hodnotu null.

*ppStatus*<br/>
[out] Ukazatel do umístění, kde `Update` vrací hodnotu stavový řádek. Pokud je vrácen žádný stav *ppStatus* má hodnotu null.

### <a name="remarks"></a>Poznámky

Odesílá všechny neuložené změny provedené na všechny řádky, protože tyto řádky byly posledního načtení nebo aktualizaci pomocí [aktualizace](../../data/oledb/crowset-update.md) nebo `UpdateAll`. `UpdateAll` aktualizuje všechny řádky, která byla změněna, bez ohledu na to, zda máte stále popisovač pro ně (viz *pphRow*) nebo ne.

Například, pokud jste použili `Insert` pro vložení pět řádků v sadě řádků, můžete buď zavolat `Update` pětkrát nebo volání `UpdateAll` jednou je všechny aktualizovat.

Tato metoda vyžaduje, volitelné rozhraní `IRowsetUpdate`, která nemusí být podporován na všichni poskytovatelé; Pokud se v případě, vrátí metoda E_NOINTERFACE. Musíte taky nastavit `DBPROP_IRowsetUpdate` k VARIANT_TRUE před voláním `Open` v tabulce nebo příkaz, který obsahuje sadu řádků.

### <a name="return-value"></a>Návratová hodnota

Standardní HRESULT.

## <a name="see-also"></a>Viz také

[Ukázka DBViewer](../../visual-cpp-samples.md)<br/>
[MultiRead vzorku](../../visual-cpp-samples.md)<br/>
[Ukázka multiRead atributů](../../visual-cpp-samples.md)<br/>
[OLE DB – šablony příjemce](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referenční dokumentace k šablonám příjemců OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)