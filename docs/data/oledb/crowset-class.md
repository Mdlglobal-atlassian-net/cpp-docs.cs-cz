---
title: CRowset – třída
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 689cd3a1f7496ad75bf83e0b1a2a14f7bd1b1f6f
ms.sourcegitcommit: 63784729604aaf526de21f6c6b62813882af930a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/17/2020
ms.locfileid: "79441175"
---
# <a name="crowset-class"></a>CRowset – třída

Zapouzdřuje OLE DB objekt sady řádků a několik souvisejících rozhraní a poskytuje metody manipulace pro data sady řádků.

## <a name="syntax"></a>Syntaxe

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parametry

*TAccessor*<br/>
Přístupová třída. Výchozí formát je `CAccessorBase`.

## <a name="requirements"></a>Požadavky

**Záhlaví:** atldbcli. h

## <a name="members"></a>Členové

### <a name="methods"></a>Metody

|||
|-|-|
|[AddRefRows](#addrefrows)|Zvýší počet odkazů přidružený k aktuálnímu řádku.|
|[Uzavírací](#close)|Uvolní řádky a aktuální `IRowset` rozhraní.|
|[Compare](#compare)|Porovná dvě záložky pomocí [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Vytvoří nový objekt `CRowset` a (volitelně) přidruží ho k rozhraní `IRowset` dodanému jako parametr.|
|[Odstranění](#delete)|Odstraní řádky ze sady řádků pomocí [IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Vyhledá další odpovídající řádek po zadané záložce.|
|[GetApproximatePosition](#getapproximateposition)|Vrátí přibližnou pozici řádku odpovídajícího záložce.|
|[GetData](#getdata)|Načte data z kopie řádku sady řádků.|
|[GetDataHere](#getdatahere)|Načte data ze zadané vyrovnávací paměti.|
|[GetOriginalData](#getoriginaldata)|Načte data, která se naposledy načítají nebo přenáší do zdroje dat, a ignoruje probíhající změny.|
|[GetRowStatus](#getrowstatus)|Vrátí stav všech řádků.|
|[Zadat](#insert)|Vytvoří a vloží nový řádek pomocí [IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Porovná zadaný řádek s aktuálním řádkem.|
|[MoveFirst](#movefirst)|Přemístí umístění dalšího načtení na počáteční pozici.|
|[MoveLast](#movelast)|Přesune se na poslední záznam.|
|[Metoda](#movenext)|Načte data z dalšího sekvenčního řádku nebo zadaného počtu pozic za další řádek.|
|[MovePrev](#moveprev)|Přesune se na předchozí záznam.|
|[MoveToBookmark](#movetobookmark)|Načte řádek označený záložkou nebo řádkem na zadaném posunu z této záložky.|
|[MoveToRatio](#movetoratio)|Načte řádky začínající ze zlomkové pozice v sadě řádků.|
|[ReleaseRows](#releaserows)|Volá [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) , aby se uvolnil aktuální popisovač řádku.|
|[SetData](#setdata)|Nastaví hodnoty dat v jednom nebo více sloupcích řádku pomocí [IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Vrátit zpět](#undo)|Vrátí všechny změny provedené na řádku od posledního načtení nebo [aktualizace](../../data/oledb/crowset-update.md).|
|[Aktualizace](#update)|Přenese všechny nedokončené změny provedené na aktuálním řádku od posledního načtení nebo aktualizace.|
|[UpdateAll](#updateall)|Přenese všechny nedokončené změny provedené na všech řádcích od posledního načtení nebo aktualizace.|

## <a name="remarks"></a>Poznámky

V OLE DB sada řádků je objekt, pomocí kterého program nastavuje a načítá data.

Tato třída nemá být vytvořena jako instance, ale místo toho předána jako parametr šablony pro `CTable` nebo `CCommand` (`CRowset` je výchozí).

## <a name="addrefrows"></a>CRowset:: AddRefRows

Volá [IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) a zvyšuje (po jednom) počet odkazů přidružený k aktuálnímu popisovači řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda zvýší počet odkazů pro aktuální popisovač řádku. Zavolejte [ReleaseRows](../../data/oledb/crowset-releaserows.md) pro snížení počtu. Řádky vrácené metodami Move mají počet odkazů na jeden.

## <a name="close"></a>CRowset:: Close

Uvolní řádky a aktuální rozhraní [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) .

### <a name="syntax"></a>Syntaxe

```cpp
void Close() throw();
```

### <a name="remarks"></a>Poznámky

Tato metoda uvolní všechny řádky, které jsou aktuálně v sadě řádků.

## <a name="compare"></a>CRowset:: Compare

Porovná dvě záložky pomocí [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parametry

*Bookmark1*<br/>
pro První záložka, která se má porovnat

*Bookmark2*<br/>
pro Druhá záložka, která se má porovnat

*pComparison*<br/>
mimo Ukazatel na výsledek porovnání.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje volitelné `IRowsetLocate`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetLocate` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

Informace o používání záložek v příjemce najdete v tématu [použití záložek](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a>CRowset:: CRowset

Vytvoří nový objekt `CRowset` a (volitelně) přidruží ho k rozhraní [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) dodanému jako parametr.

### <a name="syntax"></a>Syntaxe

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parametry

*pRowset*<br/>
pro Ukazatel na `IRowset` rozhraní, které se má přidružit k této třídě.

## <a name="delete"></a>CRowset::D dstranit

Volá [IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) pro odstranění aktuálního řádku ze sady řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

## <a name="findnextrow"></a>CRowset:: FindNextRow

Vyhledá další odpovídající řádek po zadané záložce.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*evřít*<br/>
pro Operace, která se má použít při porovnávání hodnot řádků Hodnoty naleznete v tématu [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
pro Ukazatel na hodnotu, která se má shodovat.

*wType*<br/>
pro Určuje datový typ hodnoty část vyrovnávací paměti. Informace o indikátorech typu naleznete v tématu [datové typy](/previous-versions/windows/desktop/ms723969(v=vs.85)) v *referenci OLE DB programátora* v Windows SDK.

*nLength*<br/>
pro Délka datové struktury spotřebitele přidělené pro datovou hodnotu v bajtech Podrobnosti najdete v tématu Popis `cbMaxLen` ve [strukturách DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) v referenční příručce *programátora OLE DB.*

*bPrecision*<br/>
pro Maximální přesnost, která se používá při získávání dat. Používá se pouze v případě, že je DBTYPE_NUMERIC *wType* . Další informace najdete v tématu [převody týkající se DBTYPE_NUMERIC nebo DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) v *Referenční příručce programátora OLE DB*.

*bScale*<br/>
pro Měřítko, které se používá při získávání dat. Používá se pouze v případě, DBTYPE_NUMERIC nebo DBTYPE_DECIMAL *wType* . Další informace najdete v tématu [převody týkající se DBTYPE_NUMERIC nebo DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) v *Referenční příručce programátora OLE DB*.

*bSkipCurrent*<br/>
pro Počet řádků z záložky, od které se má začít hledat

*pBookmark*<br/>
pro Záložka pro pozici, na které se má začít hledat

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje volitelné `IRowsetFind`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetFind` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

Informace o používání záložek v příjemce najdete v tématu [použití záložek](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a>CRowset:: GetApproximatePosition

Vrátí přibližnou pozici řádku odpovídajícího záložce.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parametry

*pBookmark*<br/>
pro Ukazatel na záložku, která identifikuje řádek, jehož umístění má být nalezeno. Hodnota NULL, pokud je vyžadován pouze počet řádků.

*pPosition*<br/>
mimo Ukazatel na umístění, kde `GetApproximatePosition` vrátí pozici řádku. Hodnota NULL, pokud není pozice požadována.

*pcRows*<br/>
mimo Ukazatel na místo, kde `GetApproximatePosition` vrátí celkový počet řádků. Hodnota NULL, pokud není požadovaný počet řádků.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje volitelné `IRowsetScroll`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetScroll` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

Informace o používání záložek v příjemce najdete v tématu [použití záložek](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a>CRowset:: GetData

Načte data z kopie řádku sady řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
pro Číslo indexu (nulového posunu) přistupujícího objektu, který se má použít pro přístup k datům.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Pokud zadáte přistupující objekt, který není autoaccesser v [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), použijte tuto metodu k explicitnímu získání dat předáním čísla přistupujícího objektu.

## <a name="getdatahere"></a>CRowset:: GetDataHere

Načte data z aktuálního řádku a umístí je do zadané vyrovnávací paměti.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
pro Číslo indexu přístupového objektu, který se má použít pro přístup k datům.

*pBuffer*<br/>
mimo Vyrovnávací paměť, do které se umístí data pro aktuální záznam.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Příklad použití této funkce naleznete v ukázce s více [čteními](../../overview/visual-cpp-samples.md).

## <a name="getoriginaldata"></a>CRowset:: GetOriginalData

Volá `IRowsetUpdate::GetOriginalData`, aby se načetla data, která se v poslední době načetla nebo přenesly do zdroje dat.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda načte data, která se v poslední době načítají nebo přenáší do zdroje dat; nenačítá hodnoty na základě probíhajících změn.

Tato metoda vyžaduje volitelné `IRowsetUpdate`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetUpdate` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

## <a name="getrowstatus"></a>CRowset:: GetRowStatus

Vrátí stav všech řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parametry

*pStatus*<br/>
mimo Ukazatel na umístění, kde `GetRowStatus` vrátí hodnotu stavu. Viz DBPENDINGSTATUS v referenci programátora OLE DB.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje volitelné `IRowsetUpdate`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetUpdate` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

## <a name="insert"></a>CRowset:: INSERT

Vytvoří a inicializuje nový řádek pomocí dat z přístupového objektu.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
pro Číslo přístupového objektu, který se má použít pro vložení dat

*bGetHRow*<br/>
pro Označuje, zda je načten popisovač vloženého řádku.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje volitelné `IRowsetChange`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetChange` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

Vložení se nemusí zdařit, pokud do jednoho nebo více sloupců nelze zapisovat. Opravte to tak, že upravíte mapu kurzoru.

### <a name="example"></a>Příklad

Následující příklad ukazuje, jak získat přístup ke zdroji dat prostřednictvím sady řádků a pak vložit řetězec pomocí tabulky v této sadě řádků.

Nejprve vytvořte třídu tabulky vložením nového objektu ATL do projektu. Například klikněte pravým tlačítkem myši na projekt v podokně pracovní prostor a vyberte **Nový objekt ATL**. V kategorii **přístup k datům** vyberte **příjemce**. Vytvořte objekt spotřebitele typu **tabulka**. (Výběr **tabulky** vytvoří sadu řádků přímo z tabulky. výběr **příkazu** vytvoří sadu řádků pomocí příkazu SQL.) Vyberte zdroj dat a určete tabulku, do které se má získat přístup k tomuto zdroji dat. Pokud voláte svůj objekt příjemce **CCustomerTable**, měli byste implementovat kód pro vložení následujícím způsobem:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a>CRowset:: IsSameRow

Porovná zadaný řádek s aktuálním řádkem.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parametry

*hRow*<br/>
pro Popisovač řádku, který má být porovnán s aktuálním řádkem.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT. S_OK určuje, že jsou řádky stejné. Další hodnoty naleznete v tématu [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) v *odkazu programátora OLE DB* v Windows SDK.

## <a name="movefirst"></a>CRowset:: MoveFirst

Přesune kurzor na počáteční pozici a načte počáteční řádek.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Volá [IRowset:: volání metody RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) , aby se přeumístilo umístění dalšího načtení na počáteční pozici (pozice, která byla při vytvoření sady řádků Next-Fetch), a načte počáteční řádek.

## <a name="movelast"></a>CRowset:: MoveLast

Přesune kurzor na poslední řádek.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Volání [IRowset:: volání metody RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) přemístí umístění dalšího načtení na poslední pozici a načte poslední řádek.

Tato metoda vyžaduje, abyste nastavili `DBPROP_CANSCROLLBACKWARDS` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu, který obsahuje sadu řádků. (Pro lepší výkon je také možné nastavit `DBPROP_QUICKRESTART` VARIANT_TRUE.)

## <a name="movenext"></a>CRowset:: MoveNext

Přesune kurzor na další záznam.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parametry

*lSkip*<br/>
pro Počet řádků, které se mají přeskočit před načtením

*bForward*<br/>
pro Předejte **hodnotu true** , pokud chcete přejít vpřed k dalšímu záznamu, **hodnota false** pro přesun zpět.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT. Po dosažení konce sady řádků vrátí DB_S_ENDOFROWSET.

### <a name="remarks"></a>Poznámky

Načte další sekvenční řádek z objektu `CRowset` a pamatuje předchozí pozici. Volitelně můžete zvolit, že chcete přeskočit *lSkip* řádky nebo přesunout zpět.

Tato metoda vyžaduje, abyste před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků nastavili následující vlastnosti:

- `DBPROP_CANSCROLLBACKWARDS` musí být VARIANT_TRUE, pokud *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` musí být VARIANT_TRUE, pokud *bForward* = false

Jinak (Pokud *lSkip* > = 0 a *bForward* = true), nemusíte nastavovat žádné další vlastnosti.

## <a name="moveprev"></a>CRowset:: MovePrev

Přesune kurzor na předchozí záznam.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje, abyste před voláním `Open` v tabulce nebo příkazu, který obsahuje sadu řádků, nastavili buď `DBPROP_CANFETCHBACKWARDS`, nebo `DBPROP_CANSCROLLBACKWARDS` na VARIANT_TRUE.

## <a name="movetobookmark"></a>CRowset:: MoveToBookmark

Načte řádek označený záložkou nebo řádku v zadaném posunu (*lSkip*) z této záložky.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parametry

*záložku*<br/>
pro Záložka označující umístění, ze kterého chcete načíst data.

*lSkip*<br/>
pro Počet řádků z záložky na cílový řádek. Pokud je *lSkip* nula, první načtený řádek je řádek s záložkou. Pokud je *lSkip* 1, první načtený řádek je řádek za řádkem s záložkou. Pokud je *lSkip* -1, první načtený řádek je řádek před řádkem s záložkou.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje volitelné `IRowsetLocate`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetLocate` pro VARIANT_TRUE a nastavit `DBPROP_CANFETCHBACKWARDS` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu, který obsahuje sadu řádků.

Informace o používání záložek v příjemce najdete v tématu [použití záložek](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a>CRowset:: MoveToRatio

Načte řádky začínající ze zlomkové pozice v sadě řádků.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parametry

*nNumerator*<br/>
pro Čitatel použitý k určení zlomkové polohy, ze které se mají načíst data

*nDenominator*<br/>
pro Jmenovatel použitý k určení zlomkové polohy, ze které se mají načíst data

*bForward*<br/>
pro Označuje, zda se má přesunout vpřed nebo zpět. Výchozí hodnota je předána.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

`MoveToRatio` načte řádky přibližně podle následujícího vzorce:

`(nNumerator *  RowsetSize ) / nDenominator`

kde `RowsetSize` je velikost sady řádků měřenou v řádcích. Přesnost tohoto vzorce závisí na konkrétním zprostředkovateli. Podrobnosti najdete v tématu [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Tato metoda vyžaduje volitelné `IRowsetScroll`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetScroll` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

## <a name="releaserows"></a>CRowset:: ReleaseRows

Volá [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) , aby se uvolnil aktuální popisovač řádku.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

## <a name="setdata"></a>CRowset:: SetData

Nastaví hodnoty dat v jednom nebo více sloupcích řádku.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
pro Počet přístupových objektů, které se mají použít pro přístup k datům.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Pro formulář `SetData`, který nepřijímá žádné argumenty, se k aktualizaci použijí všechny přistupující objekty. Obvykle zavoláte `SetData` k nastavení hodnot dat ve sloupcích v řádku a pak voláním [aktualizace](../../data/oledb/crowset-update.md) přenesete tyto změny.

Tato metoda vyžaduje volitelné `IRowsetChange`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetChange` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

Operace nastavení může selhat, pokud nelze do jednoho nebo více sloupců zapisovat. Opravte to tak, že upravíte mapu kurzoru.

## <a name="undo"></a>CRowset:: Undo

Vrátí všechny změny provedené na řádku od posledního načtení nebo [aktualizace](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
mimo Ukazatel na místo, kde `Undo` vrátí počet řádků, které se v případě potřeby pokusily o vrácení zpět.

*phRow*<br/>
mimo Ukazatel na umístění, kde `Undo` vrátí pole popisovačů do všech řádků, které se pokusily o vrácení v případě potřeby.

*pStatus*<br/>
mimo Ukazatel na umístění, kde `Undo` vrátí hodnotu stavu řádku. Pokud má *pStatus* hodnotu null, není vrácen žádný stav.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Tato metoda vyžaduje volitelné `IRowsetUpdate`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetUpdate` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

## <a name="update"></a>CRowset:: Update

Přenese všechny nedokončené změny provedené na aktuálním řádku od posledního načtení nebo `Update` volání.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
mimo Ukazatel na místo, kde `Update` vrátí počet řádků, které se pokusily aktualizovat (v případě potřeby).

*phRow*<br/>
mimo Ukazatel na umístění, kde `Update` vrátí popisovač řádku, který se pokusil aktualizovat. Pokud má *phRow* hodnotu null, není vrácen žádný popisovač.

*pStatus*<br/>
mimo Ukazatel na umístění, kde `Update` vrátí hodnotu stavu řádku. Pokud má *pStatus* hodnotu null, není vrácen žádný stav.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

### <a name="remarks"></a>Poznámky

Přenese všechny probíhající změny provedené na aktuálním řádku od posledního načtení nebo aktualizace řádku (pomocí `Update` nebo [UpdateAll](../../data/oledb/crowset-updateall.md)). Obvykle zavoláte metodu [SetData](../../data/oledb/crowset-setdata.md) pro nastavení hodnot dat ve sloupcích na řádku a potom zavoláte `Update` pro přenos těchto změn.

Tato metoda vyžaduje volitelné `IRowsetUpdate`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetUpdate` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

## <a name="updateall"></a>CRowset:: UpdateAll

Přenese všechny nedokončené změny provedené na všech řádcích od posledního načtení nebo `Update` volání.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
mimo Ukazatel na místo, kde `UpdateAll` vrátí počet řádků, které se pokusily aktualizovat (v případě potřeby).

*pphRow*<br/>
mimo Ukazatel na paměť, ve které `UpdateAll` vrací popisovač řádku, který se pokusil aktualizovat. Pokud má *pphRow* hodnotu null, není vrácen žádný popisovač.

*ppStatus*<br/>
mimo Ukazatel na umístění, kde `Update` vrátí hodnotu stavu řádku. Pokud má *ppStatus* hodnotu null, není vrácen žádný stav.

### <a name="remarks"></a>Poznámky

Přenese všechny nedokončené změny provedené na všech řádcích, protože byly tyto řádky naposledy načteny nebo aktualizovány pomocí [aktualizace](../../data/oledb/crowset-update.md) nebo `UpdateAll`. `UpdateAll` aktualizuje každý řádek, který byl upraven, bez ohledu na to, zda pro ně stále máte popisovač (viz *pphRow*) nebo ne.

Například pokud jste použili `Insert` pro vložení pěti řádků do sady řádků, můžete buď zavolat `Update` pětkrát nebo volat `UpdateAll` jednou, a všechny tak aktualizovat.

Tato metoda vyžaduje volitelné `IRowsetUpdate`rozhraní, které nemusí být podporované pro všechny poskytovatele; Pokud se jedná o tento případ, metoda vrátí E_NOINTERFACE. Musíte také nastavit `DBPROP_IRowsetUpdate` na VARIANT_TRUE před voláním `Open` v tabulce nebo příkazu obsahujícím sadu řádků.

### <a name="return-value"></a>Návratová hodnota

Standardní hodnota HRESULT.

## <a name="see-also"></a>Viz také

[Ukázka DBViewer](../../overview/visual-cpp-samples.md)<br/>
[Ukázka s více čteními](../../overview/visual-cpp-samples.md)<br/>
[Ukázka více čtení atributů](../../overview/visual-cpp-samples.md)<br/>
[Šablony OLE DB příjemců](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referenční dokumentace k šablonám příjemců OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)