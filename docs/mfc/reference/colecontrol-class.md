---
title: Třída COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 54138955b0aa61a5e307c64825f3c74fa6f592b1
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753934"
---
# <a name="colecontrol-class"></a>Třída COleControl

Výkonná základní třída pro vývoj ovládacích prvků OLE.

## <a name="syntax"></a>Syntaxe

```
class COleControl : public CWnd
```

## <a name="members"></a>Členové

### <a name="public-constructors"></a>Veřejné konstruktory

|Název|Popis|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Vytvoří `COleControl` objekt.|

### <a name="public-methods"></a>Veřejné metody

|Název|Popis|
|----------|-----------------|
|[COleControl::Ambientappearance](#ambientappearance)|Načte aktuální vzhled ovládacího prvku.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Vrátí hodnotu okolní vlastnosti BackColor.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Vrátí název ovládacího prvku určeného kontejnerem.|
|[COleControl::AmbientFont](#ambientfont)|Vrátí hodnotu vlastnosti ambient Font.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Vrátí hodnotu vlastnosti Ambient ForeColor.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Vrátí ID národního prostředí kontejneru.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Vrátí typ jednotek používaných kontejnerem.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Určuje, zda by měly být zobrazeny úchyty pro uchopení.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Určuje, zda má být zobrazeno šrafování.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Vrátí typ zarovnání textu určenékontejnerem.|
|[COleControl::AmbientUiDead](#ambientuidead)|Určuje, zda by měl ovládací prvek reagovat na akce uživatelského rozhraní.|
|[COleControl::AmbientUserMode](#ambientusermode)|Určuje režim kontejneru.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Upozorní kontejner, že byla změněna vázaná vlastnost.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Požaduje oprávnění k úpravě hodnoty vlastnosti.|
|[COleControl::ClientToParent](#clienttoparent)|Převede bod vzhledem k počátku ovládacího prvku do bodu vzhledem k jeho původu kontejneru.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Upraví obdélník stříšky, pokud je překryt ovládacím prvkem.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Volání této funkce po změně sady mnemotechnické pomůcky zpracované ovládacím prvkem.|
|[COleControl::Dchyba při přehrávání](#displayerror)|Zobrazí události chyby skladu uživateli ovládacího prvku.|
|[COleControl::DoClick](#doclick)|Implementace skladové `DoClick` metody.|
|[COleControl::DoPropExchange](#dopropexchange)|Serializuje vlastnosti objektu. `COleControl`|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Překreslí ovládací prvek OLE, který byl podtřídy z ovládacího prvku systému Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Umožňuje jednoduchou podporu rámu pro ovládací prvek.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializuje šířku a výšku ovládacího prvku.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializuje vlastnosti zásob ovládacího prvku.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializuje číslo verze ovládacího prvku.|
|[COleControl::FireClick](#fireclick)|Vypustí `Click` akci.|
|[COleControl::FireDblClick](#firedblclick)|Vypustí `DblClick` akci.|
|[COleControl::FireError](#fireerror)|Vypustí `Error` akci.|
|[COleControl::FireEvent](#fireevent)|Vyvolá vlastní událost.|
|[COleControl::FireKeyDown](#firekeydown)|Vypustí `KeyDown` akci.|
|[COleControl::FireKeyPress](#firekeypress)|Vypustí `KeyPress` akci.|
|[COleControl::FireKeyUp](#firekeyup)|Vypustí `KeyUp` akci.|
|[COleControl::FireMouseDown](#firemousedown)|Vypustí `MouseDown` akci.|
|[COleControl::FireMouseMove](#firemousemove)|Vypustí `MouseMove` akci.|
|[COleControl::FireMouseUp](#firemouseup)|Vypustí `MouseUp` akci.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Vyvolá událost, když se změní stav připravenosti ovládacího prvku.|
|[COleControl::Zásady aktivace](#getactivationpolicy)|Změní výchozí chování aktivace ovládacího prvku, který podporuje `IPointerInactive` rozhraní.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Vrátí hodnotu zadané vlastnosti ambient.|
|[COleControl::GetAppearance](#getappearance)|Vrátí hodnotu vlastnosti Vzhled akcií.|
|[COleControl::GetBackColor](#getbackcolor)|Vrátí hodnotu stock BackColor vlastnost.|
|[COleControl::GetBorderStyle](#getborderstyle)|Vrátí hodnotu vlastnosti BorderStyle.|
|[COleControl::GetCapture](#getcapture)|Určuje, zda objekt s aktivovaným ovládacím prvkem bez oken má zachycení myši.|
|[COleControl::GetClassID](#getclassid)|Načte ID třídy OLE ovládacího prvku.|
|[COleControl::GetClientOffset](#getclientoffset)|Načte rozdíl mezi levým horním rohem obdélníkové oblasti ovládacího prvku a levým horním rohem klientské oblasti.|
|[COleControl::GetClientRect](#getclientrect)|Načte velikost klientské oblasti ovládacího prvku.|
|[COleControl::GetClientSite](#getclientsite)|Dotazuje objekt pro ukazatel na aktuální klientskou lokalitu v rámci svého kontejneru.|
|[COleControl::GetControlFlags](#getcontrolflags)|Načte nastavení příznaku ovládacího prvku.|
|[COleControl::GetControlSize](#getcontrolsize)|Vrátí pozici a velikost ovládacího prvku OLE.|
|[COleControl::GetDC](#getdc)|Poskytuje prostředky pro ovládací prvek bez oken získat kontext zařízení z jeho kontejneru.|
|[COleControl::GetEnabled](#getenabled)|Vrátí hodnotu vlastnosti Stock Enabled.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Načte ukazatel na objekt rozšířeného ovládacího prvku, který patří do kontejneru.|
|[COleControl::GetFocus](#getfocus)|Určuje, zda má ovládací prvek fokus.|
|[COleControl::GetFont](#getfont)|Vrátí hodnotu vlastnosti Stock Font.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Vrátí metriky objektu. `CFontHolder`|
|[COleControl::GetForeColor](#getforecolor)|Vrátí hodnotu vlastnosti ForeColor.|
|[COleControl::GetHwnd](#gethwnd)|Vrátí hodnotu stock hWnd vlastnost.|
|[COleControl::GetMessageString](#getmessagestring)|Poskytuje text stavového řádku pro položku nabídky.|
|[COleControl::GetNotSupported](#getnotsupported)|Zabraňuje přístupu uživatele k hodnotě vlastnosti ovládacího prvku.|
|[COleControl::GetReadyState](#getreadystate)|Vrátí stav připravenosti ovládacího prvku.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Vrátí obdélník ovládacího prvku vzhledem k jeho kontejneru.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Vrátí metriky stock Font vlastnost.|
|[COleControl::GetText](#gettext)|Vrátí hodnotu vlastnosti Text nebo Caption.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Přepsat, aby ovládací prvek bez oken byl cílem operací přetažení.|
|[COleControl::InicializovatIDy](#initializeiids)|Informuje základní třídu IID, které bude ovládací prvek používat.|
|[COleControl::InternalGetFont](#internalgetfont)|Vrátí `CFontHolder` objekt pro vlastnost Stock Font.|
|[COleControl::InternalGetText](#internalgettext)|Načte stock Caption nebo Text vlastnost.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Nastaví stav připravenosti ovládacího prvku a vyvolá událost ready-state change.|
|[COleControl::Zneplatněnícontrol](#invalidatecontrol)|Zruší platnost oblasti zobrazeného ovládacího prvku a způsobí jeho překreslit.|
|[COleControl::Zneplatnitrgn](#invalidatergn)|Zruší platnost klientské oblasti okna kontejneru v rámci dané oblasti. Lze překreslit ovládací prvky bez oken v oblasti.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Umožňuje specializované načítání ovládacího prvku OLE.|
|[COleControl::IsModified](#ismodified)|Určuje, zda se změnil stav ovládacího prvku.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Označuje, zda kontejner podporuje optimalizovaný výkres pro aktuální operaci výkresu.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Volána k určení, zda ovládací prvek podtřídy ovládacího prvku systému Windows.|
|[COleControl::Načíst](#load)|Obnoví všechna předchozí asynchronní data a iniciuje nové zatížení asynchronní vlastnosti ovládacího prvku.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Určuje, zda může být ovládací prvek deaktivován kontejnerem.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Nazývá při změně vlastnosti okolí.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Volána při změně vlastnosti Vzhled skladu.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Volána při změně vlastnosti Stock BackColor.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Nazývá při změně vlastnosti borderstyle zásob.|
|[COleControl::OnClick](#onclick)|Povolán k požáru populace Klepněte na událost.|
|[COleControl::OnClose](#onclose)|Upozorní ovládací prvek, `IOleControl::Close` který byl volán.|
|[COleControl::Ondoverb](#ondoverb)|Volána po spuštění ovládacího slovesa.|
|[COleControl::Ondraw](#ondraw)|Nazývá se, když je požadováno ovládací prvek překreslit sám.|
|[COleControl::Soubor OnDrawMetafile](#ondrawmetafile)|Volat kontejneru při ovládacíprvek je požadováno překreslit sám pomocí kontextu metasouboru zařízení.|
|[COleControl::OnEdit](#onedit)|Volat kontejneru do ui Aktivovat ovládací prvek OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Volána při změně vlastnosti Stock Enabled.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Volána kontejneru výčet slovesovládacích prvku.|
|[COleControl::OnEventAdvise](#oneventadvise)|Nazývá se, když jsou obslužné rutiny událostí připojeny nebo odpojeny od ovládacího prvku.|
|[COleControl::OnFontChanged](#onfontchanged)|Volána při změně vlastnosti Stock Font.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Volána při změně vlastnosti ForeColor.|
|[COleControl::Události onfreeze](#onfreezeevents)|Nazývá se, když jsou události ovládacího prvku zmrazeny nebo nezmrazeny.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Upozorní ovládací prvek, `IOleObject::GetColorSet` který byl volán.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Poskytuje mnemotechnické informace do kontejneru.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Volána k získání řetězce představující hodnotu vlastnosti.|
|[COleControl::OnGetInplaceMenu](#ongetinplacemenu)|Požaduje popisovač nabídky ovládacího prvku, který bude sloučen s nabídkou kontejneru.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Přepsáním načtete velikost zobrazení ovládacího prvku, která je nejblíže navrhované velikosti a rozsahu.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Vrátí řetězce představující možné hodnoty pro vlastnost.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Vrátí hodnotu odpovídající předdefinovanému řetězci.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Přepsáním načtete velikost zobrazovacích oblastí ovládacího prvku (lze použít k povolení dvouprůchodového výkresu).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Přepsáním převedete velikost ovládacího prvku na obdélník začínající na určité pozici.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Přepsáním načtete stav zobrazení ovládacího prvku.|
|[COleControl::OnhideToolBars](#onhidetoolbars)|Volat kontejneru při ovládacího prvku je deaktivován.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Přepsat mít kontejner pro neaktivní ovládací prvek pod ukazatele myši odeslání WM_MOUSEMOVE zprávy ovládacího prvku.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Přepsat mít kontejner pro neaktivní ovládací prvek pod ukazatele myši odeslání WM_SETCURSOR zprávy ovládacího prvku.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Volána po akci KeyDown stock byla aktivována.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Volána po akci KeyPress událost byla aktivována.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Volána po akci KeyUp stock byla aktivována.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Označuje stránku vlastností, která se má použít pro úpravy vlastnosti.|
|[COleControl::OnMnemonic](#onmnemonic)|Volána, když byla stisknuta mnemotechnická klávesa ovládacího prvku.|
|[COleControl::OnProperties](#onproperties)|Nazývá se, když byl vyvolán příkaz "Vlastnosti" ovládacího prvku.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Přepsání dotazu, zda zobrazení ovládacího prvku překrývá daný bod.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Přepište dotaz, zda zobrazení ovládacího prvku překrývá libovolný bod v daném obdélníku.|
|[COleControl::OnRenderData](#onrenderdata)|Volat rámci načíst data v zadaném formátu.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Volat rámci načíst data ze souboru v zadaném formátu.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Volat rámci načíst data z globální paměti v zadaném formátu.|
|[COleControl::OnResetState](#onresetstate)|Obnoví vlastnosti ovládacího prvku na výchozí hodnoty.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Upozorní ovládací prvek, `IOleControl::SetClientSite` který byl volán.|
|[COleControl::OnSetData](#onsetdata)|Nahradí data ovládacího prvku jinou hodnotou.|
|[COleControl::Délka](#onsetextent)|Volána po změně rozsahu ovládacího prvku.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Volána po změně dimenzí ovládacího prvku.|
|[COleControl::OnShowPanely nástrojů](#onshowtoolbars)|Volána, když byl aktivován ovládací prvek.|
|[COleControl::OnTextChanged](#ontextchanged)|Volána při změně vlastnosti text nebo titulek.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Zpracovává zprávy oken (jiné než zprávy myši a klávesnice) pro ovládací prvky bez oken.|
|[COleControl::ParentToClient](#parenttoclient)|Převede bod vzhledem k počátku kontejneru do bodu vzhledem k počátku ovládacího prvku.|
|[COleControl::Pmodmodlální dialog](#postmodaldialog)|Upozorní kontejner, že modální dialogové okno bylo uzavřeno.|
|[COleControl::Premodlodálnídialog](#premodaldialog)|Upozorní kontejner, že modální dialogové okno se chystá zobrazit.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Zničí a znovu vytvoří okno ovládacího prvku.|
|[COleControl::Aktualizovat](#refresh)|Vynutí překreslení vzhledu ovládacího prvku.|
|[COleControl::ReleaseCapture](#releasecapture)|Uvolní zachycení myši.|
|[COleControl::ReleaseDC](#releasedc)|Uvolní kontext zobrazovacího zařízení kontejneru ovládacího prvku bez oken.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Obnoví nadřazenou položku ovládacího okna.|
|[COleControl::ResetStockProps](#resetstockprops)|Inicializuje `COleControl` vlastnosti zásob na výchozí hodnoty.|
|[COleControl::ResetVersion](#resetversion)|Inicializuje číslo verze na danou hodnotu.|
|[COleControl::ScrollWindow](#scrollwindow)|Umožňuje ovládacímu prvku bez oken posouvat oblast v rámci aktivního obrazu na místě na displeji.|
|[COleControl::SelectFontObject](#selectfontobject)|Vybere vlastní vlastnost Font do kontextu zařízení.|
|[COleControl::SelectStockFont](#selectstockfont)|Vybere vlastnost Stock Font do kontextu zařízení.|
|[COleControl::SerializovatRozsah](#serializeextent)|Serializuje nebo inicializuje prostor zobrazení ovládacího prvku.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializuje nebo inicializuje `COleControl` vlastnosti zásob.|
|[COleControl::SerializeVersion](#serializeversion)|Serializuje nebo inicializuje informace o verzi ovládacího prvku.|
|[COleControl::SetAppearance](#setappearance)|Nastaví hodnotu vlastnosti Vzhled na skladě.|
|[COleControl::SetbackColor](#setbackcolor)|Nastaví hodnotu stock BackColor vlastnost.|
|[COleControl::SetBorderStyle](#setborderstyle)|Nastaví hodnotu vlastnosti BorderStyle.|
|[COleControl::SetCapture](#setcapture)|Způsobí, že okno kontejneru ovládacího prvku převzít zachycení myši jménem ovládacího prvku.|
|[COleControl::SetControlSize](#setcontrolsize)|Nastaví umístění a velikost ovládacího prvku OLE.|
|[COleControl::SetEnabled](#setenabled)|Nastaví hodnotu vlastnosti Stock Enabled.|
|[COleControl::SetFocus](#setfocus)|Způsobí, že okno kontejneru ovládacího prvku převzít vstupní fokus na ovládací prvek.|
|[COleControl::SetFont](#setfont)|Nastaví hodnotu vlastnosti Stock Font.|
|[COleControl::SetForeColor](#setforecolor)|Nastaví hodnotu stock UreColor vlastnost.|
|[COleControl::SetInitialSize](#setinitialsize)|Nastaví velikost ovládacího prvku OLE při prvním zobrazení v kontejneru.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Změní změněný stav ovládacího prvku.|
|[COleControl::SetNotPovoleno](#setnotpermitted)|Označuje, že požadavek na úpravu se nezdařil.|
|[COleControl::SetNotSupported](#setnotsupported)|Zabrání úpravám hodnoty vlastnosti ovládacího prvku uživatelem.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Nastaví obdélník ovládacího prvku vzhledem k jeho kontejneru.|
|[COleControl::SetText](#settext)|Nastaví hodnotu vlastnosti Text nebo Caption.|
|[COleControl::ThrowError](#throwerror)|Signalizuje, že došlo k chybě v ovládacím prvku OLE.|
|[COleControl::TransformCoords](#transformcoords)|Transformuje hodnoty souřadnic mezi kontejnerem a ovládacím prvkem.|
|[COleControl::Přeložitbarvu](#translatecolor)|Převede hodnotu OLE_COLOR na hodnotu COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Určuje, zda okolní vlastnosti budou k dispozici při příštím načtení ovládacího prvku.|
|[COleControl::WindowProc](#windowproc)|Poskytuje postup systému `COleControl` Windows pro objekt.|

### <a name="protected-methods"></a>Chráněné metody

|Název|Popis|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Volat rámci při ovládacího prvku vzhled musí být aktualizován.|
|[COleControl::DrawMetafile](#drawmetafile)|Volat rámci při použití kontextu zařízení metasouboru.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Umožňuje vyvolání metody automatizace.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Volat rámci inicializovat seznam formátů dat podporovaných ovládacím prvkem.|

## <a name="remarks"></a>Poznámky

Odvozeno `CWnd`z , tato třída dědí všechny funkce objektu okna systému Windows plus další funkce specifické pro OLE, jako je například spuštění událostí a schopnost podporovat metody a vlastnosti.

Ole ovládací prvky lze vložit do aplikací kontejneru OLE a komunikovat s kontejnerem pomocí obousměrného systému události spouštění a vystavení metody a vlastnosti kontejneru. Všimněte si, že standardní kontejnery OLE podporují pouze základní funkce ovládacího prvku OLE. Nejsou schopni podporovat rozšířené funkce ovládacího prvku OLE. K událostem dojde, když jsou události odeslány do kontejneru v důsledku určitých akcí, které probíhají v ovládacím prvku. Kontejner zase komunikuje s ovládacím prvkem pomocí vystavené sady metod a vlastností analogických s členskými funkcemi a datovými členy třídy C++. Tento přístup umožňuje vývojáři řídit vzhled ovládacího prvku a upozornit kontejner, když dojde k určité akce.

## <a name="windowless-controls"></a>Ovládací prvky bez oken

Ole ovládací prvky lze použít na místě aktivní bez okna. Ovládací prvky bez oken mají významné výhody:

- Ovládací prvky bez oken mohou být průhledné a nepravoúhlé

- Ovládací prvky bez oken zmenšují velikost instance a čas vytvoření objektu

Ovládací prvky nepotřebují okno. Služby, které okno nabízí, lze snadno poskytnout prostřednictvím jednoho sdíleného okna (obvykle kontejneru) a trochu dispečerského kódu. Mít okno je většinou zbytečnou komplikací na objektu.

Při použití aktivace bez oken kontejneru (který má okno) je zodpovědný za poskytování služeb, které by jinak byly poskytnuty vlastní okno ovládacího prvku. Například pokud ovládací prvek potřebuje dotaz na fokus klávesnice, dotaz zachycení myši nebo získat kontext zařízení, tyto operace jsou spravovány kontejneru. Funkce `COleControl` člena bez oken vyvolávají tyto operace v kontejneru.

Pokud je povolena aktivace bez oken, kontejner deleguje vstupní zprávy do rozhraní ovládacího `IOleInPlaceObjectWindowless` prvku (rozšíření [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) pro podporu bez oken). `COleControl`Implementace tohoto rozhraní odešle tyto zprávy prostřednictvím mapy zpráv ovládacího prvku po odpovídajícím nastavení souřadnic myši. Tyto zprávy můžete zpracovat jako běžné zprávy okna přidáním odpovídajících položek do mapy zpráv.

V ovládacím prvku bez oken `COleControl` byste měli vždy `CWnd` používat členské funkce namísto odpovídajících členských funkcí nebo souvisejících funkcí rozhraní API systému Windows.

Ole řídicí objekty můžete také vytvořit okno pouze v případě, že se stanou aktivní, ale množství práce potřebné pro neaktivní aktivní přechod přejde nahoru a rychlost přechodu přejde dolů. Existují případy, kdy se jedná o problém: jako příklad zvažte mřížku textových polí. Při kurzoru nahoru a dolů přes sloupec, každý ovládací prvek musí být na místě aktivován a poté deaktivován. Rychlost neaktivního/aktivního přechodu bude mít přímý vliv na rychlost posouvání.

Další informace o vývoji řídicího rámce OLE naleznete v článcích [Ovládací prvky activexu knihovny MFC](../../mfc/mfc-activex-controls.md) a [přehled: Vytvoření programu řízení activexů knihovny MFC](../../mfc/reference/mfc-activex-control-wizard.md). Informace o optimalizaci ovládacích prvků OLE, včetně ovládacích prvků bez oken a bez blikání, naleznete v [tématu Ovládací prvky ActiveX knihovny MFC: Optimalizace](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hierarchie dědičnosti

[CObjekt](../../mfc/reference/cobject-class.md)

[CCmdCíl](../../mfc/reference/ccmdtarget-class.md)

[Cwnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Požadavky

**Záhlaví:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl::AmbientBackColor

Vrátí hodnotu okolní vlastnosti BackColor.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Návratová hodnota

Aktuální hodnota okolní vlastnosti backcolor kontejneru, pokud existuje. Pokud vlastnost není podporována, vrátí tato funkce systémem definovanou barvu pozadí systému Windows.

### <a name="remarks"></a>Poznámky

Ambient BackColor Vlastnost je k dispozici pro všechny ovládací prvky a je definován kontejneru. Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl::AmbientDisplayName

Název, který kontejner přiřadil ovládacímu prvku, lze použít v chybových zprávách zobrazených uživateli.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Návratová hodnota

Název ovládacího prvku OLE. Výchozí hodnota je řetězec nulové délky.

### <a name="remarks"></a>Poznámky

Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl::AmbientFont

Vrátí hodnotu vlastnosti ambient Font.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na rozhraní odeslání okolí písma kontejneru. Výchozí hodnota je NULL. Pokud návrat není rovna NULL, jste zodpovědní za uvolnění písma voláním jeho [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) členské funkce.

### <a name="remarks"></a>Poznámky

Ambient Font Vlastnost je definována kontejneru a je k dispozici pro všechny ovládací prvky. Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl::AmbientForeColor

Vrátí hodnotu vlastnosti Ambient ForeColor.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Návratová hodnota

Aktuální hodnota okolí kontejneru ForeColor vlastnost, pokud existuje. Pokud tato funkce není podporována, vrátí systémem definovanou barvu textu systému Windows.

### <a name="remarks"></a>Poznámky

Vlastnost Ambient ForeColor je k dispozici pro všechny ovládací prvky a je definována kontejnerem. Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl::AmbientLocaleID

Vrátí ID národního prostředí kontejneru.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Návratová hodnota

Hodnota vlastnosti LocaleID kontejneru, pokud existuje. Pokud tato vlastnost není podporována, tato funkce vrátí 0.

### <a name="remarks"></a>Poznámky

Ovládací prvek můžete použít LocaleID přizpůsobit své uživatelské rozhraní pro konkrétní národní prostředí. Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl::Ambientappearance

Načte aktuální nastavení vzhledu objektu ovládacího prvku.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Návratová hodnota

Vzhled ovládacího prvku:

- **0** Plochý vzhled

- **1** 3D vzhled

### <a name="remarks"></a>Poznámky

Volání této funkce načíst aktuální hodnotu vlastnosti DISPID_AMBIENT_APPEARANCE pro ovládací prvek.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits

Vrátí typ jednotek používaných kontejnerem.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Návratová hodnota

Řetězec obsahující okolní ScaleUnits kontejneru. Pokud tato vlastnost není podporována, vrátí tato funkce řetězec nulové délky.

### <a name="remarks"></a>Poznámky

Vlastnost okolního kontejneru ScaleUnits lze použít k zobrazení pozic nebo kót, označených vybranou jednotkou, například twips nebo centimetry. Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles

Určuje, zda kontejner umožňuje ovládacímu prvku zobrazit úchyty pro sebe, když je aktivní.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud by měly být zobrazeny úchyty pro uchopení; jinak 0. Pokud tato vlastnost není podporována, tato funkce vrátí nenulovou hodnotu.

### <a name="remarks"></a>Poznámky

Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl::AmbientShowHatching

Určuje, zda kontejner umožňuje ovládacímu prvku zobrazit sám se šrafovaným vzorkem, když je aktivní ui.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud by měl být zobrazen šrafovaný vzor; jinak 0. Pokud tato vlastnost není podporována, tato funkce vrátí nenulovou hodnotu.

### <a name="remarks"></a>Poznámky

Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl::AmbientTextAlign

Určuje zarovnání textu okolí upřednostňované kontejnerem ovládacího prvku.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Návratová hodnota

Stav okolní vlastnosti kontejneru TextAlign. Pokud tato vlastnost není podporována, tato funkce vrátí 0.

Následuje seznam platných vrácených hodnot:

|Návratová hodnota|Význam|
|------------------|-------------|
|0|Obecné zarovnání (čísla vpravo, text vlevo).|
|1|Zarovnat doleva|
|2|Střed|
|3|Odůvodnění vpravo|

### <a name="remarks"></a>Poznámky

Tato vlastnost je k dispozici pro všechny vložené ovládací prvky a je definována kontejnerem. Všimněte si, že kontejner není nutné pro podporu této vlastnosti.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl::AmbientUiDead

Určuje, zda kontejner chce, aby ovládací prvek reagoval na akce uživatelského rozhraní.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud by měl ovládací prvek reagovat na akce uživatelského rozhraní; jinak 0. Pokud tato vlastnost není podporována, tato funkce vrátí 0.

### <a name="remarks"></a>Poznámky

Kontejner může například nastavit hodnotu TRUE v režimu návrhu.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl::AmbientUserMode

Určuje, zda je kontejner v režimu návrhu nebo uživatelského režimu.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je kontejner v uživatelském režimu; jinak 0 (v režimu návrhu). Pokud tato vlastnost není podporována, vrátí tato funkce hodnotu PRAVDA.

### <a name="remarks"></a>Poznámky

Kontejner může například nastavit na hodnotu FALSE v režimu návrhu.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged

Signalizuje, že hodnota vázané vlastnosti se změnila.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání vázané vlastnosti ovládacího prvku.

### <a name="remarks"></a>Poznámky

To musí být volána pokaždé, když se změní hodnota vlastnosti, a to i v případech, kdy změna nebyla provedena prostřednictvím metody property Set. Buďte zvláště vědomi vázané vlastnosti, které jsou mapovány na členské proměnné. Pokaždé, když se taková `BoundPropertyChanged` proměnná člena změní, musí být volána.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit

Požaduje oprávnění z `IPropertyNotifySink` rozhraní ke změně hodnoty vázané vlastnosti poskytované ovládacího prvku.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání vázané vlastnosti ovládacího prvku.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je změna povolena; jinak 0. Výchozí hodnota je nenulová.

### <a name="remarks"></a>Poznámky

Pokud je oprávnění odepřeno, ovládací prvek nesmí nechat hodnotu vlastnosti změnit. To lze provést ignorováním nebo selháním akce, která se pokusila změnit hodnotu vlastnosti.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl::ClientToParent

Převede souřadnice *pPoint* do nadřazených souřadnic.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Ukazatel na hranice ovládacího prvku OLE v kontejneru. Ne klientská oblast, ale oblast celého ovládacího prvku včetně ohraničení a posuvníků.

*pBod*<br/>
Ukazatel na bod oblasti klienta OLE, který má být přeložen do souřadnic nadřazeného (kontejneru).

### <a name="remarks"></a>Poznámky

Na vstupní *pPoint* je relativní k původu klientské oblasti ovládacího prvku OLE (levý horní roh klientské oblasti ovládacího prvku). Na výstupu *pPoint* je relativní k původu nadřazené (levý horní roh kontejneru).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl::ClipCaretRect

Upraví obdélník stříšky, pokud je zcela nebo částečně zakryt překrývajícími se neprůhlednými objekty.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Na vstupu ukazatel na [rect](/windows/win32/api/windef/ns-windef-rect) strukturu, která obsahuje oblast stříšky, které mají být upraveny. Na výstupu upravená oblast stříšky nebo NULL, pokud je obdélník stříšky zcela zakrytý.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Stříška je blikající čára, blok nebo bitmapa, která obvykle označuje, kam bude vložen text nebo grafika.

Objekt bez oken nemůže bezpečně zobrazit stříšku bez předchozí kontroly, zda je stříška částečně nebo zcela skryta překrývajícími se objekty. Aby to bylo možné, může `ClipCaretRect` objekt použít k nastavení stříšky (snížené) a zajistit tak, aby se vešla do oblasti oříznutí.

Objekty vytvářející stříšku by `ClipCaretRect` měly odeslat obdélník stříšky a použít upravený obdélník pro stříšku. Pokud je stříška zcela skrytá, tato metoda vrátí FALSE a stříška by neměla být v tomto případě zobrazena vůbec.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl::COleControl

Vytvoří `COleControl` objekt.

```
COleControl();
```

### <a name="remarks"></a>Poznámky

Tato funkce obvykle není volána přímo. Místo toho je ovládací prvek OLE obvykle vytvořen jeho factory třídy.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl::ControlInfoChanged

Volání této funkce při změně sady mnemotechnické pomůcky podporované ovládacím prvkem.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>Poznámky

Po obdržení tohoto oznámení kontejneru ovládacího prvku získá novou sadu mnemotechnické pomůcky voláním [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Všimněte si, že kontejner není nutné reagovat na toto oznámení.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl::Dchyba při přehrávání

Volat rámci po stock Error událost byla zpracována (pokud obslužná rutina události potlačil zobrazení chyby).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parametry

*kód*<br/>
Hodnota stavového kódu, která má být vykázána. Úplný seznam možných kódů naleznete v článku [Ovládací prvky ActiveX: Rozšířená témata](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Popis hlášené chyby.

*lpszZdroj*<br/>
Název modulu, který chybu generuje (obvykle název řídicího modulu OLE).

*soubor lpszHelpFile*<br/>
Název souboru nápovědy obsahující popis chyby.

*nHelpID*<br/>
ID kontextu nápovědy hlášené chyby.

### <a name="remarks"></a>Poznámky

Výchozí chování zobrazí okno se zprávou obsahující popis chyby obsažené v *lpszDescription*.

Přepište tuto funkci a přizpůsobte způsob zobrazení chyb.

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl::DoClick

Simuluje akci kliknutí myší na ovládací mase.

```cpp
void DoClick();
```

### <a name="remarks"></a>Poznámky

Overridable `COleControl::OnClick` člen funkce bude volána a populace Click událost bude aktivována, pokud je podporován ovládacím prvkem.

Tato funkce je `COleControl` podporována základní třídou jako burzovní metodou nazvanou DoClick. Další informace naleznete v článku [Ovládací prvky ActiveX: Metody](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl::DoPropExchange

Volat rámci při načítání nebo ukládání ovládacího prvku z reprezentace trvaléúložiště, jako je například datový proud nebo sada vlastností.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na `CPropExchange` objekt. Rozhraní Framework poskytuje tento objekt k vytvoření kontextu výměny vlastností, včetně jeho směr.

### <a name="remarks"></a>Poznámky

Tato funkce obvykle provádí volání **PX_** rodiny funkcí k načtení nebo uložení konkrétních uživatelem definovaných vlastností ovládacího prvku OLE.

Pokud byl k vytvoření řídicího projektu OLE použit Průvodce řízením, bude potlačená `COleControl` verze této funkce serializovat `COleControl::DoPropExchange`vlastnosti zásob podporované voláním funkce základní třídy . Při přidávání uživatelem definovaných vlastností do ovládacího prvku OLE bude nutné tuto funkci upravit a serializovat nové vlastnosti. Další informace o serializaci naleznete v článku [Ovládací prvky ActiveX: Serializace](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint

Překreslí ovládací prvek OLE, který byl podtřídy z ovládacího prvku systému Windows.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Ukazatel na kontext zařízení kontejneru ovládacího prvku.

*rcBounds*<br/>
Oblast, ve které má být ovládací prvek nakreslena.

### <a name="remarks"></a>Poznámky

Volání této funkce správně zpracovat malování neaktivní ovládací prvek OLE. Tato funkce by měla být použita pouze v případě, že `OnDraw` ovládací prvek OLE podtřídy ovládací prvek systému Windows a by měla být volána ve funkci ovládacího prvku.

Další informace o této funkci a podřadných třídách ovládacího prvku systému Windows naleznete v článku [Ovládací prvky ActiveX: Podřazení ovládacího prvku systému Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl::DrawContent

Volat rámci při ovládacího prvku vzhled musí být aktualizován.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Ukazatel na kontext zařízení.

*Rc*<br/>
Obdélníková plocha, která má být nakreslena.

### <a name="remarks"></a>Poznámky

Tato funkce přímo volá `OnDraw` overridable funkce.

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl::DrawMetafile

Volat rámci při použití kontextu zařízení metasouboru.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Ukazatel na kontext zařízení metasouboru.

*Rc*<br/>
Obdélníková plocha, která má být nakreslena.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame

Umožňuje jednoduchou charakteristiku rámce pro ovládací prvek OLE.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>Poznámky

Tato charakteristika umožňuje ovládací prvek pro podporu vizuální uzavření jiných ovládacích prvků, ale není pravda, OLE uzavření. Příkladem může být skupinové pole s několika ovládacími prvky uvnitř. Tyto ovládací prvky nejsou ole obsaženy, ale jsou ve stejné skupině pole.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl::ExchangeExtent

Serializuje nebo inicializuje stav rozsahu ovládacího prvku (jeho rozměry v jednotkách HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na objekt [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Rozhraní Framework poskytuje tento objekt k vytvoření kontextu výměny vlastností, včetně jeho směr.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byla funkce úspěšná; 0 jinak.

### <a name="remarks"></a>Poznámky

Tato funkce je obvykle volána `COleControl::DoPropExchange`výchozí implementací aplikace .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl::ExchangeStockProps

Serializuje nebo inicializuje stav vlastností zásob ovládacího prvku.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na objekt [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Rozhraní Framework poskytuje tento objekt k vytvoření kontextu výměny vlastností, včetně jeho směr.

### <a name="remarks"></a>Poznámky

Tato funkce je obvykle volána `COleControl::DoPropExchange`výchozí implementací aplikace .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl::ExchangeVersion

Serializuje nebo inicializuje stav informací o verzi ovládacího prvku.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na `CPropExchange` objekt. Rozhraní Framework poskytuje tento objekt k vytvoření kontextu výměny vlastností, včetně jeho směr.

*dwVersionDefault*<br/>
Aktuální číslo verze ovládacího prvku.

*bPřevést*<br/>
Označuje, zda mají být trvalá data při uložení převedena do nejnovějšího formátu nebo udržována ve stejném formátu, který byl načten.

### <a name="return-value"></a>Návratová hodnota

Nenulová funkce byla úspěšná. 0 jinak.

### <a name="remarks"></a>Poznámky

Obvykle se jedná o první funkci volanou přepsáním ovládacího `COleControl::DoPropExchange`prvku . Při načítání tato funkce přečte číslo verze trvalých dat a odpovídajícím způsobem nastaví atribut verze objektu [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Při ukládání tato funkce zapíše číslo verze trvalých dat.

Další informace o trvalosti a správu verzí naleznete v článku [Ovládací prvky ActiveX: Serializace](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl::FireClick

Volat rámci při klepnutí myší přes aktivní ovládací prvek.

```cpp
void FireClick();
```

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Aby mohlo dojít k automatickému vypálení události Click, musí být na mapě události ovládacího prvku definována událost Click.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl::FireDblClick

Volat rámci při poklepání myší přes aktivní ovládací prvek.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Aby mohlo dojít k automatickému spuštění události DblClick, musí mít mapa událostí ovládacího prvku definována událost DblClick.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl::FireError

Spustí událost Stock Error.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*kód*<br/>
Hodnota stavového kódu, která má být vykázána. Úplný seznam možných kódů naleznete v článku [Ovládací prvky ActiveX: Rozšířená témata](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Popis hlášené chyby.

*nHelpID*<br/>
ID nápovědy hlášené chyby.

### <a name="remarks"></a>Poznámky

Tato událost poskytuje způsob signalizace na příslušných místech v kódu, že došlo k chybě v rámci ovládacího prvku. Na rozdíl od jiných událostí akcií, jako je například Click nebo MouseMove, Error je nikdy aktivován a rozhraní.

Chcete-li ohlásit chybu, ke které dochází během vlastnosti get funkce, funkce sady vlastností nebo metody automatizace, volejte [COleControl::ThrowError](#throwerror).

Implementace události Stock Error ovládacího prvku OLE používá hodnotu SCODE. Pokud ovládací prvek používá tuto událost a je určen pro použití v jazyce Visual Basic 4.0, obdržíte chyby, protože hodnota SCODE není podporována v jazyce Visual Basic.

Chcete-li tento problém vyřešit, ručně změňte parametr SCODE v ovládacím prvku . ODL soubor na **dlouhou**. Kromě toho všechny vlastní události, metody nebo vlastnosti, která používá parametr SCODE také způsobí stejný problém.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl::FireEvent

Vyvolá uživatelem definovanou událost z ovládacího prvku s libovolným počtem volitelných argumentů.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání události, která má být vypálena.

*pbParams*<br/>
Popisovač pro typy parametrů události.

### <a name="remarks"></a>Poznámky

Obvykle by tato funkce neměla být volána přímo. Místo toho budete volat funkce spouštění událostí v části mapy událostí deklarace třídy ovládacího prvku.

Argument *pbParams* je seznam **VTS_** oddělený ch od místa . Jedna nebo více těchto hodnot oddělených mezerami (nikoli čárkami) určuje seznam parametrů funkce. Možné hodnoty jsou následující:

|Symbol|Typ parametru|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Další konstanty variant byly definovány pro všechny typy variant, s výjimkou VTS_FONT a VTS_PICTURE, které poskytují ukazatel na konstantu dat varianty. Tyto konstanty jsou pojmenovány pomocí **VTS_P** `constantname` konvence. Například VTS_PCOLOR je ukazatel na VTS_COLOR konstantu.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl::FireKeyDown

Volat rámci při stisknutí klávesy, zatímco ovládací prvek je aktivní.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Ukazatel na hodnotu kódu virtuálního klíče stisknuté klávesy. Seznam standardních virtuálních kódů klíčů naleznete v tématu Winuser.h

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK Během akce byla stisknuta klávesa SHIFT.

- CTRL_MASK Během akce byla stisknuta klávesa CTRL.

- ALT_MASK Během akce byla stisknuta klávesa ALT.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Aby mohlo dojít k automatickému spuštění události KeyDown, musí mít mapa událostí ovládacího prvku definována událost KeyDown.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl::FireKeyPress

Volat rámci při stisknutí klíče a uvolnění, zatímco vlastní ovládací prvek je aktivní rozhraní v rámci kontejneru.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Ukazatel na hodnotu znaku stisknuté klávesy.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Příjemce události může změnit *pnChar*, například převést všechna malá písmena na velká písmena. Chcete-li zkontrolovat změněný znak, `OnKeyPressEvent`přepište .

Aby mohlo dojít k automatickému vypalování události KeyPress, musí mít mapa událostí ovládacího prvku definována událost KeyPress.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl::FireKeyUp

Volat rámci při uvolnění klíče, zatímco vlastní ovládací prvek je aktivní rozhraní v rámci kontejneru.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Ukazatel na hodnotu kódu virtuálního klíče vydaného klíče. Seznam standardních virtuálních kódů klíčů naleznete v tématu Winuser.h

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK Během akce byla stisknuta klávesa SHIFT.

- CTRL_MASK Během akce byla stisknuta klávesa CTRL.

- ALT_MASK Během akce byla stisknuta klávesa ALT.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Aby mohlo dojít k automatickému spuštění události KeyUp, musí mít mapa událostí ovládacího prvku definována událost KeyUp.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl::FireMouseDown

Volat rámci při stisknutí tlačítka myši přes aktivní vlastní ovládací prvek.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nTlačítko*<br/>
Číselná hodnota stisknutého tlačítka myši. Může obsahovat jednu z následujících hodnot:

- LEFT_BUTTON Levé tlačítko myši bylo stisknuto.

- MIDDLE_BUTTON Prostřední tlačítko myši bylo stisknuto.

- RIGHT_BUTTON Pravé tlačítko myši bylo stisknuto.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK Během akce byla stisknuta klávesa SHIFT.

- CTRL_MASK Během akce byla stisknuta klávesa CTRL.

- ALT_MASK Během akce byla stisknuta klávesa ALT.

*X*<br/>
Souřadnice x kurzoru při stisknutí tlačítka myši. Souřadnice je relativní vzhledem k levému hornímu rohu ovládacího okna.

*Y*<br/>
Souřadnice y kurzoru při stisknutí tlačítka myši. Souřadnice je relativní vzhledem k levému hornímu rohu ovládacího okna.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Aby mohlo dojít k automatickému spouštění události MouseDown, musí být na mapě události ovládacího prvku definována událost MouseDown.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl::FireMouseMove

Volat rámci při přesunutí kurzoru přes aktivní vlastní ovládací prvek.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nTlačítko*<br/>
Číselná hodnota stisknutých tlačítek myši. Obsahuje kombinaci následujících hodnot:

- LEFT_BUTTON Levé tlačítko myši bylo během akce stisknuto.

- MIDDLE_BUTTON Během akce bylo stisknuto prostřední tlačítko myši.

- RIGHT_BUTTON Pravé tlačítko myši bylo během akce stisknuto.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK Během akce byla stisknuta klávesa SHIFT.

- CTRL_MASK Během akce byla stisknuta klávesa CTRL.

- ALT_MASK Během akce byla stisknuta klávesa ALT.

*X*<br/>
Souřadnice x kurzoru. Souřadnice je relativní vzhledem k levému hornímu rohu ovládacího okna.

*Y*<br/>
Souřadnice y kurzoru. Souřadnice je relativní vzhledem k levému hornímu rohu ovládacího okna.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Aby mohlo dojít k automatickému spouštění události MouseMove, musí mít mapa událostí ovládacího prvku stock stock MouseMove definovanou.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl::FireMouseUp

Volat rámci při uvolnění tlačítka myši přes aktivní vlastní ovládací prvek.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nTlačítko*<br/>
Číselná hodnota uvolněného tlačítka myši. Může mít jednu z následujících hodnot:

- LEFT_BUTTON Levé tlačítko myši bylo uvolněno.

- MIDDLE_BUTTON Bylo uvolněno prostřední tlačítko myši.

- RIGHT_BUTTON Bylo uvolněno pravé tlačítko myši.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK Během akce byla stisknuta klávesa SHIFT.

- CTRL_MASK Během akce byla stisknuta klávesa CTRL.

- ALT_MASK Během akce byla stisknuta klávesa ALT.

*X*<br/>
Souřadnice x kurzoru při uvolnění tlačítka myši. Souřadnice je relativní vzhledem k levému hornímu rohu ovládacího okna.

*Y*<br/>
Souřadnice y kurzoru při uvolnění tlačítka myši. Souřadnice je relativní vzhledem k levému hornímu rohu ovládacího okna.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definována jako vlastní událost, určíte, kdy je událost aktivována.

Aby mohlo dojít k automatickému spouštění události MouseUp, musí mít mapa událostí ovládacího prvku stock mouseup definovanou událost.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl::FireReadyStateChange

Vyvolá událost s aktuální hodnotou stavu řízení připravenosti.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>Poznámky

Stav připraven může být jedna z následujících hodnot:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Výchozí stav inicializace|
|READYSTATE_LOADING|Ovládací prvek právě načítá své vlastnosti.|
|READYSTATE_LOADED|Ovládací prvek byl inicializován.|
|READYSTATE_INTERACTIVE|Ovládací prvek má dostatek dat, aby bylo interaktivní, ale ne všechna asynchronní data jsou ještě načtena|
|READYSTATE_COMPLETE|Ovládací prvek má všechna data|

Pomocí [GetReadyState](#getreadystate) určit aktuální připravenost ovládacího prvku.

[InternalSetReadyState](#internalsetreadystate) změní stav připravenosti na zadanou hodnotu a poté zavolá `FireReadyStateChange`.

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl::Zásady aktivace

Změní výchozí chování aktivace ovládacího prvku, který podporuje `IPointerInactive` rozhraní.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Návratová hodnota

Kombinace příznaků z výčtu POINTERINACTIVE. Možné příznaky jsou:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Objekt by měl být aktivován na místě, když ho myš zadá během operace pohybu myši.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Objekt by měl být deaktivován, když myš opustí objekt během operace přesunutí myši.|
|POINTERINACTIVE_ACTIVATEONDRAG|Objekt by měl být aktivován na místě, když je myš přetažena přes něj během operace přetažení.|

### <a name="remarks"></a>Poznámky

Pokud `IPointerInactive` je povoleno rozhraní, kontejner deleguje WM_SETCURSOR a WM_MOUSEMOVE zprávy. `COleControl`Implementace tohoto rozhraní odešle tyto zprávy prostřednictvím mapy zpráv ovládacího prvku po odpovídajícím nastavení souřadnic myši.

Vždy, když kontejner obdrží zprávu WM_SETCURSOR nebo WM_MOUSEMOVE s ukazatelem `IPointerInactive`myši nad `GetActivationPolicy` neaktivní objekt podporující , by měl volat rozhraní a vrátit příznaky z výčtu POINTERINACTIVE.

Tyto zprávy můžete zpracovat stejně jako běžné zprávy okna přidáním odpovídajících položek do mapy zpráv. V obslužné `m_hWnd` rutiny, vyhněte se použití členské proměnné (nebo všechny členské funkce, které ji používá) bez předchozí kontroly, že jeho hodnota je non-NULL.

Jakýkoli objekt, který má udělat více než nastavit kurzor myši a/nebo vypálit událost přesunutí myši, například poskytnout zvláštní vizuální zpětnou vazbu, by měl vrátit příznak POINTERINACTIVE_ACTIVATEONENTRY a nakreslit zpětnou vazbu pouze v případě, že je aktivní. Pokud objekt vrátí tento příznak, kontejner by měl aktivovat na místě okamžitě a `GetActivationPolicy`potom předat dál stejnou zprávu, která spustila volání .

Pokud jsou vráceny příznaky POINTERINACTIVE_ACTIVATEONENTRY i POINTERINACTIVE_DEACTIVATEONLEAVE, objekt bude aktivován pouze v případě, že je nad objektem pouze myš. Pokud je vrácen pouze příznak POINTERINACTIVE_ACTIVATEONENTRY, bude objekt aktivován pouze jednou, když myš poprvé vstoupí do objektu.

Můžete také chtít neaktivní ovládací prvek být cílem operace přetažení OLE. To vyžaduje aktivaci ovládacího prvku v okamžiku, kdy uživatel přetáhne objekt přes něj, takže okno ovládacího prvku lze zaregistrovat jako cíl přetažení. Chcete-li způsobit aktivaci během přetahování, vraťte příznak POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Informace sdělené `GetActivationPolicy` kontejnerem by neměly být ukládány do mezipaměti. Místo toho by tato metoda měla být volána pokaždé, když myš zadá neaktivní objekt.

Pokud neaktivní objekt nepožaduje, aby byl aktivován na místě, když jej zadáte myš, jeho kontejner by měl odeslat následné WM_SETCURSOR zprávy k tomuto objektu voláním [OnInactiveSetCursor](#oninactivesetcursor) tak dlouho, dokud ukazatel myši zůstane nad objektem.

Povolení `IPointerInactive` rozhraní obvykle znamená, že chcete, aby ovládací prvek byl schopen zpracování zpráv myši za všech okolností. Chcete-li získat toto chování v `IPointerInactive` kontejneru, který nepodporuje rozhraní, budete muset mít ovládací prvek vždy aktivován, když je viditelný, což znamená, že ovládací prvek by měl mít příznak OLEMISC_ACTIVATEWHENVISIBLE mezi jeho různé příznaky. Chcete-li však zabránit tomu, aby se `IPointerInactive`tento příznak projevil v kontejneru, který podporuje , můžete také zadat příznak OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl::GetAmbientProperty

Získá hodnotu ambient vlastnost kontejneru.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parametry

*dwDispid*<br/>
ID odeslání požadované vlastnosti okolí.

*vtProp*<br/>
Značka typu varianty, která určuje typ hodnoty, která má být vrácena v *pvProp*.

*pvProp*<br/>
Ukazatel na adresu proměnné, která obdrží hodnotu vlastnosti nebo vrácenou hodnotu. Skutečný typ tohoto ukazatele se musí shodovat s typem určeným *vtProp*.

|vtProp|Typ pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je podporována vlastnost okolí; jinak 0.

### <a name="remarks"></a>Poznámky

`GetAmbientProperty` Pokud sloužík k načtení okolních vlastností DisplayName a ScaleUnits, `CString*`nastavte *vtProp* na VT_BSTR a *pvProp* na . Pokud načítáte vlastnost ambient Font, nastavte *vtProp* na VT_FONT a *pvProp* na LPFONTDISP*.

Všimněte si, že funkce již byly poskytnuty pro společné vlastnosti okolí, jako je [například AmbientBackColor](#ambientbackcolor) a [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl::GetAppearance

Implementuje Get funkce vašeho ovládacího prvku populace Vzhled vlastnost.

```
short GetAppearance ();
```

### <a name="return-value"></a>Návratová hodnota

Vrácená hodnota určuje aktuální nastavení vzhledu jako **krátkou** (VT_I2) hodnotu, pokud je úspěšná. Tato hodnota je nulová, pokud je vzhled ovládacího prvku plochý, a 1, pokud je vzhled ovládacího prvku 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl::GetBackColor

Implementuje Get funkce vašeho ovládacího prvku zásob BackColor vlastnost.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Návratová hodnota

Vrácená hodnota určuje aktuální barvu pozadí jako OLE_COLOR hodnotu, pokud je úspěšná. Tuto hodnotu lze přeložit na hodnotu COLORREF s voláním `TranslateColor`.

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl::GetBorderStyle

Implementuje Get funkce vašeho ovládacího prvku borderstyle vlastnost.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Návratová hodnota

.1 pokud má kontrola normální hranici; 0, pokud ovládací prvek nemá žádné ohraničení.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl::GetCapture

Určuje, `COleControl` zda má objekt zachycení myši.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Návratová hodnota

Pokud je aktivován ovládací prvek a bez oken, vrátí **tuto hodnotu,** pokud ovládací prvek aktuálně má zachycení myši (podle kontejneru ovládacího prvku) nebo NULL, pokud nemá zachycení.

V opačném `CWnd` případě vrátí objekt, který `CWnd::GetCapture`má zachycení myši (stejné jako ).

### <a name="remarks"></a>Poznámky

Aktivovaný ovládací prvek bez oken obdrží zachycení myši při volání [SetCapture.](#setcapture)

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl::GetClassID

Volat rámci načíst ID třídy OLE ovládacího prvku.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parametry

*pclsid (pclsid)*<br/>
Ukazatel na umístění ID třídy.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud volání nebylo úspěšné; jinak 0.

### <a name="remarks"></a>Poznámky

Obvykle provádí [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl::GetClientOffset

Načte rozdíl mezi levým horním rohem obdélníkové oblasti ovládacího prvku a levým horním rohem klientské oblasti.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parametry

*pdxOffset*<br/>
Ukazatel na vodorovné odsazení klientské oblasti ovládacího prvku OLE.

*pdyOffset*<br/>
Ukazatel na svislé odsazení klientské oblasti ovládacího prvku OLE.

### <a name="remarks"></a>Poznámky

Ovládací prvek OLE má obdélníkovou oblast v rámci kontejneru. Klientská oblast ovládacího prvku je oblast řízení s výjimkou ohraničení a posuvníků. Posun načtený `GetClientOffset` je rozdíl mezi levým horním rohem obdélníkové oblasti ovládacího prvku a levým horním rohem klientské oblasti. Pokud ovládací prvek má jiné prvky než standardní ohraničení a posuvníky, přepište tuto členskou funkci a určete posun.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl::GetClientRect

Načte velikost klientské oblasti ovládacího prvku.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na `RECT` strukturu obsahující rozměry klientské oblasti ovládacího prvku bez oken; to znamená velikost ovládacího prvku mínus ohraničení oken, rámce, posuvníky a tak dále. Parametr *lpRect* označuje velikost obdélníku klienta ovládacího prvku, nikoli jeho umístění.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl::GetClientSite

Dotazuje objekt pro ukazatel na aktuální klientskou lokalitu v rámci svého kontejneru.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na aktuální klientskou lokalitu ovládacího prvku v jeho kontejneru.

### <a name="remarks"></a>Poznámky

Vrácený ukazatel odkazuje na `IOleClientSite`instanci aplikace . Rozhraní, `IOleClientSite` implementované kontejnery, je zobrazení objektu jeho kontextu: kde je ukotven v dokumentu, kde získá jeho úložiště, uživatelské rozhraní a další prostředky.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl::GetControlFlags

Načte nastavení příznaku ovládacího prvku.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Návratová hodnota

Kombinace ORed příznaků ve výčtu ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Poznámky

Ve výchozím `GetControlFlags` `fastBeginPaint | clipPaintDC`nastavení vrátí .

|||
|-|-|
|`fastBeginPaint`|Pokud je nastavena, používá funkci begin-paint přizpůsobenou pro ovládací prvky OLE namísto rozhraní [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API (nastavené ve výchozím nastavení).|
|`clipPaintDC`|Pokud není nastavena, zakáže volání `IntersectClipRect` provedené `COleControl` a získá malou rychlost výhodu. Pokud používáte aktivaci bez oken, příznak nemá žádný vliv.|
|`pointerInactive`|Pokud set, poskytuje interakci myši, zatímco `COleControl`ovládací prvek je `IPointerInactive` neaktivní povolením 's implementace rozhraní, která je ve výchozím nastavení zakázána.|
|`noFlickerActivate`|Pokud je nastaveno, eliminuje další operace kreslení a doprovodné vizuální blikání. Použijte, když ovládací prvek kreslí sám identicky v neaktivní a aktivní stavy. Pokud používáte aktivaci bez oken, příznak nemá žádný vliv.|
|`windowlessActivate`|Pokud nastaveno, označuje ovládací prvek používá aktivaci bez oken.|
|`canOptimizeDraw`|Pokud je nastaveno, znamená, že ovládací prvek provede optimalizovaný výkres, pokud jej kontejner podporuje.|

Další informace `GetControlFlags` o dalších optimalizacích ovládacích prvků OLE naleznete v [tématu ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl::GetControlSize

Načte velikost okna ovládacího prvku OLE.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parametry

*Pcx*<br/>
Určuje šířku ovládacího prvku v obrazových bodech.

*pcy*<br/>
Určuje výšku ovládacího prvku v obrazových bodech.

### <a name="remarks"></a>Poznámky

Všimněte si, že všechny souřadnice pro ovládací okna jsou relativní vzhledem k levému hornímu rohu ovládacího prvku.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl::GetDC

Poskytuje objekt bez oken získat obrazovku (nebo kompatibilní) kontext zařízení z jeho kontejneru.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parametry

*lprcRect*<br/>
Ukazatel na obdélník ovládací prvek bez oken chce překreslit, v souřadnicích klienta ovládacího prvku. Null znamená rozsah celého objektu.

*dwFlags*<br/>
Atributy výkresu kontextu zařízení. Volby jsou:

- OLEDC_NODRAW Označuje, že objekt nebude používat kontext zařízení k provedení výkresu, ale pouze k získání informací o zobrazovacím zařízení. Kontejner by měl jednoduše projít řadičem domény okna bez dalšího zpracování.

- OLEDC_PAINTBKGND Požaduje, aby kontejner malovat pozadí před vrácením dc. Objekt by měl použít tento příznak, pokud požaduje řadič domény pro překreslení oblasti s průhledným pozadím.

- OLEDC_OFFSCREEN Informuje kontejner, že objekt chce vykreslit do bitmapy mimo obrazovku, která by pak měla být zkopírována na obrazovku. Objekt by měl použít tento příznak, když operace kreslení, kterou se chystá provést, generuje velké množství blikání. Kontejner je zdarma k vyhotovení této žádosti, nebo ne. Pokud však tento příznak není nastaven, kontejner musí vrátit řadič domény na obrazovce. To umožňuje objektům provádět operace přímé obrazovky, jako je zobrazení výběru (prostřednictvím operace **XOR).**

### <a name="return-value"></a>Návratová hodnota

Ukazatel na kontext zobrazovacího `CWnd` zařízení pro oblast klienta kontejneru, pokud je úspěšná; v opačném případě je vrácená hodnota NULL. Kontext zobrazovacího zařízení lze použít v následujících funkcích GDI k kreslení v klientské oblasti okna kontejneru.

### <a name="remarks"></a>Poznámky

Členská funkce [ReleaseDC](#releasedc) musí být volána, aby se uvolnil kontext po malování. Při `GetDC`volání objekty předat obdélník, které chtějí čerpat do vlastní souřadnice klienta. `GetDC`překládá je na souřadnice oblasti klienta kontejneru. Objekt by neměl požadovat požadovaný obdélník kreslení větší než jeho vlastní obdélník klientské oblasti, jehož velikost lze načíst pomocí [GetClientRect](#getclientrect). Tím zabráníte objektům v neúmyslném kreslení tam, kde by neměly.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl::GetEnabled

Implementuje Get funkce vašeho ovládacího prvku populace Enabled vlastnost.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je ovládací prvek povolen; jinak 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl::GetExtendedControl

Získá ukazatel na objekt udržovaný kontejnerem, který představuje ovládací prvek s rozšířenou sadou vlastností.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na objekt rozšířeného ovládacího prvku kontejneru. Pokud není k dispozici žádný objekt, hodnota je NULL.

S tímto objektem `IDispatch` může být manipulováno prostřednictvím jeho rozhraní. Můžete také `QueryInterface` získat další dostupná rozhraní poskytovaná objektem. Objekt však není nutné podporovat konkrétní sadu rozhraní. Všimněte si, že spoléhání se na specifické funkce objektu rozšířeného ovládacího prvku kontejneru omezuje přenositelnost ovládacího prvku na jiné libovolné kontejnery.

### <a name="remarks"></a>Poznámky

Funkce, která volá tuto funkci je zodpovědný za uvolnění ukazatele po dokončení s objektem. Všimněte si, že kontejner není nutné pro podporu tohoto objektu.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl::GetFocus

Určuje, `COleControl` zda má objekt fokus.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Návratová hodnota

Pokud je aktivován ovládací prvek a bez oken, vrátí **tuto** hodnotu, pokud ovládací prvek aktuálně má fokus klávesnice (podle kontejneru ovládacího prvku) nebo NULL, pokud nemá fokus.

V opačném `CWnd` případě vrátí objekt, který `CWnd::GetFocus`má fokus (stejné jako ).

### <a name="remarks"></a>Poznámky

Aktivovaný ovládací prvek bez oken obdrží fokus při [volání SetFocus.](#setfocus)

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl::GetFont

Implementuje Get funkce stock Font vlastnost.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na rozhraní pro odesílání písma vlastnosti Font ovládacího prvku.

### <a name="remarks"></a>Poznámky

Všimněte si, že volající musí uvolnit objekt po dokončení. V rámci provádění ovládacího `InternalGetFont` prvku použijte pro přístup k objektu font základní ho ovládacího prvku. Další informace o používání písem v ovládacím prvku naleznete v článku [Ovládací prvky ActiveX: Použití písem v ovládacím prvku ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics

Měří textové metriky `CFontHolder` pro libovolný objekt vlastněný ovládacím prvkem.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Ukazatel na strukturu [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

*fontHolder*<br/>
Odkaz na [cfontholder](../../mfc/reference/cfontholder-class.md) objekt.

### <a name="remarks"></a>Poznámky

Takové písmo lze vybrat pomocí funkce [COleControl::SelectFontObject.](#selectfontobject) `GetFontTextMetrics`inicializuje `TEXTMETRIC` strukturu, na kterou poukazuje *lptm* `fontHolder`s platnými informacemi metrik o písmu 's, pokud je úspěšné, nebo vyplní strukturu nulami, pokud není úspěšný. Tuto funkci byste měli použít místo [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) při malování ovládacího prvku, protože ovládací prvky, stejně jako všechny vložené objekty OLE, může být nutné k vykreslení sami do metasouboru.

Struktura `TEXTMETRIC` výchozího písma se aktualizuje při volání funkce [SelectFontObject.](#selectfontobject) Měli byste `GetFontTextMetrics` volat pouze po výběru vlastnosti Font stock, abyste zajistili, že informace, které poskytuje, jsou platné.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl::GetForeColor

Implementuje Get funkce stock ForeColor vlastnost.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Návratová hodnota

Vrácená hodnota určuje aktuální barvu popředí jako OLE_COLOR hodnotu, pokud je úspěšná. Tuto hodnotu lze přeložit na hodnotu [COLORREF](/windows/win32/gdi/colorref) s voláním `TranslateColor`.

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl::GetHwnd

Implementuje Get funkce stock hWnd vlastnost.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Návratová hodnota

Popisovač okna ovládacího prvku OLE, pokud existuje; jinak NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl::GetMessageString

Volat rámci získat krátký řetězec, který popisuje účel položky nabídky identifikované *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parametry

*Nid*<br/>
ID položky nabídky.

*rZpráva*<br/>
Odkaz na [CString](../../atl-mfc-shared/reference/cstringt-class.md) objekt, jehož prostřednictvím bude vrácen řetězec.

### <a name="remarks"></a>Poznámky

To lze získat zprávu pro zobrazení ve stavovém řádku, zatímco položka nabídky je zvýrazněna. Výchozí implementace se pokusí načíst řetězec prostředku identifikovaného *nID*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl::GetNotSupported

Zabraňuje přístupu uživatele k hodnotě vlastnosti ovládacího prvku.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>Poznámky

Volání této funkce namísto Get funkce jakékoli vlastnosti, kde není podporováno načítání vlastnosti uživatelem ovládacího prvku. Jedním z příkladů by vlastnost, která je pouze pro zápis.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl::GetReadyState

Vrátí stav připravenosti ovládacího prvku.

```
long GetReadyState();
```

### <a name="return-value"></a>Návratová hodnota

Stav připravenosti ovládacího prvku, jedna z následujících hodnot:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Výchozí stav inicializace|
|READYSTATE_LOADING|Ovládací prvek právě načítá své vlastnosti.|
|READYSTATE_LOADED|Ovládací prvek byl inicializován.|
|READYSTATE_INTERACTIVE|Ovládací prvek má dostatek dat, aby bylo interaktivní, ale ne všechna asynchronní data jsou ještě načtena|
|READYSTATE_COMPLETE|Ovládací prvek má všechna data|

### <a name="remarks"></a>Poznámky

Nejjednodušší ovládací prvky nikdy není třeba rozlišovat mezi LOADED a INTERACTIVE. Ovládací prvky, které podporují vlastnosti cesty dat, však nemusí být připraveny k interaktivní, dokud alespoň některá data jsou přijata asynchronně. Ovládací prvek by se měl pokusit co nejdříve interaktivní.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl::GetRectInContainer

Získá souřadnice obdélníku ovládacího prvku vzhledem ke kontejneru, vyjádřené v jednotkách zařízení.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na obdélníkovou strukturu, do které budou zkopírovány souřadnice ovládacího prvku.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je ovládací prvek aktivní na místě; jinak 0.

### <a name="remarks"></a>Poznámky

Obdélník je platný pouze v případě, že je ovládací prvek aktivní na místě.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics

Měří textové metriky pro vlastnost Font na skladě ovládacího prvku, kterou lze vybrat pomocí funkce [SelectStockFont.](#selectstockfont)

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Ukazatel na strukturu [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

### <a name="remarks"></a>Poznámky

Funkce `GetStockTextMetrics` inicializuje `TEXTMETRIC` strukturu, na kterou poukazuje *lptm* s platnými informacemi metriky, pokud je úspěšná, nebo vyplní strukturu nulami, pokud není úspěšná. Tuto funkci použijte místo [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) při malování ovládacího prvku, protože ovládací prvky, stejně jako všechny vložené objekty OLE, může být nutné vykreslit sami do metasouboru.

Struktura `TEXTMETRIC` výchozího písma se aktualizuje `SelectStockFont` při volání funkce. Tuto funkci byste měli volat pouze po výběru základního písma, abyste zajistili, že informace, které poskytuje, jsou platné.

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl::GetText

Implementuje Get funkce stock Text nebo Caption vlastnost.

```
BSTR GetText();
```

### <a name="return-value"></a>Návratová hodnota

Aktuální hodnota textového řetězce ovládacího prvku nebo řetězce nulové délky, pokud není k dispozici žádný řetězec.

> [!NOTE]
> Další informace o datovém typu BSTR naleznete v [tématu Datové typy](../../mfc/reference/data-types-mfc.md) v části Makra a globální.

### <a name="remarks"></a>Poznámky

Všimněte si, že volající `SysFreeString` této funkce musí volat na řetězec vrácena k uvolnění prostředku. V rámci provádění ovládacího `InternalGetText` prvku použijte pro přístup k základní text ovládacího prvku nebo Caption vlastnost.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget

Přepište, `GetWindowlessDropTarget` pokud chcete, aby byl ovládací prvek bez oken cílem operace přetažení OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na `IDropTarget` rozhraní objektu. Vzhledem k tomu, že nemá okno, `IDropTarget` objekt bez oken nemůže zaregistrovat rozhraní. Chcete-li se však zúčastnit přetažení, objekt bez oken `GetWindowlessDropTarget`může stále implementovat rozhraní a vrátit jej do aplikace .

### <a name="remarks"></a>Poznámky

Za normálních okolností by to vyžadovalo, aby okno ovládacího prvku být registrovány jako cíl přetažení. Ale protože ovládací prvek nemá vlastní okno, kontejner bude používat vlastní okno jako cíl přetažení. Ovládací prvek jednoduše potřebuje poskytnout `IDropTarget` implementaci rozhraní, na které kontejner můžete delegovat volání ve vhodnou dobu. Příklad:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl::InicializovatIDy

Informuje základní třídu IID, které bude ovládací prvek používat.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parametry

*piidPrimární*<br/>
Ukazatel na ID rozhraní primárního rozhraní odeslání ovládacího prvku.

*události piid*<br/>
Ukazatel na ID rozhraní rozhraní ovládacího prvku události rozhraní.

### <a name="remarks"></a>Poznámky

Volání této funkce v konstruktoru ovládacího prvku informovat základní třídy ID rozhraní bude váš ovládací prvek používat.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl::InternalGetFont

Přistupuje k vlastnosti Stock Font vašeho ovládacího prvku.

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Návratová hodnota

Odkaz na [cfontholder](../../mfc/reference/cfontholder-class.md) objekt, který obsahuje stock Font objektu.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl::InternalGetText

Přistupuje k vlastnosti Text nebo Caption ovládacího prvku.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Návratová hodnota

Odkaz na textový řetězec ovládacího prvku.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl::InternalSetReadyState

Nastaví stav připravenosti ovládacího prvku.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parametry

*lNewReadyState*<br/>
Stav připravenosti nastavit pro ovládací prvek, jedna z následujících hodnot:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Výchozí stav inicializace|
|READYSTATE_LOADING|Ovládací prvek právě načítá své vlastnosti.|
|READYSTATE_LOADED|Ovládací prvek byl inicializován.|
|READYSTATE_INTERACTIVE|Ovládací prvek má dostatek dat, aby bylo interaktivní, ale ne všechna asynchronní data jsou ještě načtena|
|READYSTATE_COMPLETE|Ovládací prvek má všechna data|

### <a name="remarks"></a>Poznámky

Nejjednodušší ovládací prvky nikdy není třeba rozlišovat mezi LOADED a INTERACTIVE. Ovládací prvky, které podporují vlastnosti cesty dat, však nemusí být připraveny k interaktivní, dokud alespoň některá data jsou přijata asynchronně. Ovládací prvek by se měl pokusit co nejdříve interaktivní.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl::Zneplatněnícontrol

Vynutí překreslení ovládacího prvku.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na oblast ovládacího prvku, který má být zrušena.

*bErase*<br/>
Určuje, zda má být pozadí v oblasti aktualizace při zpracování oblasti aktualizace vymazáno.

### <a name="remarks"></a>Poznámky

Pokud *lpRect* má hodnotu NULL, celý ovládací prvek bude překreslen. Pokud *lpRect* není NULL, označuje část obdélníku ovládacího prvku, který má být zrušena. V případech, kdy ovládací prvek nemá žádné okno nebo aktuálně není aktivní, obdélník je ignorována a volání na klientské sítě [IAdviseSink::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) členská funkce. Tuto funkci použijte `CWnd::InvalidateRect` `InvalidateRect`místo nebo .

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl::Zneplatnitrgn

Zruší platnost klientské oblasti okna kontejneru v rámci dané oblasti.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*pRgn*<br/>
Ukazatel na [cRgn](../../mfc/reference/crgn-class.md) objekt, který identifikuje oblast zobrazení objektu OLE zneplatnit, v souřadnicích klienta obsahující okno. Pokud je tento parametr NULL, rozsah je celý objekt.

*bErase*<br/>
Určuje, zda má být pozadí v neplatné oblasti vymazáno. Pokud je hodnota PRAVDA, pozadí se vymaže. Pokud false, pozadí zůstane beze změny.

### <a name="remarks"></a>Poznámky

To lze překreslit ovládací prvky bez oken v rámci kontejneru. Neplatná oblast, spolu se všemi ostatními oblastmi v oblasti aktualizace, je označena pro malování při odeslání další [WM_PAINT](/windows/win32/gdi/wm-paint) zprávy.

Pokud *bErase* je PRAVDA pro libovolnou část oblasti aktualizace, pozadí v celé oblasti, a to nejen v dané části, je vymazán.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl::IsConvertingVBX

Umožňuje specializované načítání ovládacího prvku OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je ovládací prvek převáděn; jinak 0.

### <a name="remarks"></a>Poznámky

Při převodu formuláře, který používá ovládací prvky VBX na ten, který používá ovládací prvky OLE, může být vyžadován speciální kód načítání pro ovládací prvky OLE. Například pokud načítáte instanci ovládacího prvku OLE, [PX_Font](persistence-of-ole-controls.md#px_font) může `DoPropExchange`mít volání PX_Font ve vašem :

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Ovládací prvky VBX však neměly objekt Font; každá vlastnost písma byla uložena jednotlivě. V takovém případě byste `IsConvertingVBX` použít k rozlišení mezi těmito dvěma případy:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Dalším případem by bylo, pokud váš ovládací prvek VBX uloženy proprietární binární data (v jeho VBM_SAVEPROPERTY obslužné rutiny zprávy) a ovládací prvek OLE uloží jeho binární data v jiném formátu. Pokud chcete, aby byl ovládací prvek OLE zpětně kompatibilní s ovládacím prvkem VBX, můžete číst staré i nové formáty pomocí `IsConvertingVBX` funkce tak, že rozlišujete, zda byl načten ovládací prvek VBX nebo ovládací prvek OLE.

Ve funkci ovládacího `DoPropExchange` prvku můžete zkontrolovat tuto podmínku a pokud true, spustit kód zatížení specifické pro tento převod (například v předchozích příkladech). Pokud ovládací prvek není převáděn, můžete spustit kód normálního zatížení. Tato možnost je použitelná pouze pro ovládací prvky, které jsou převáděny z protějšků VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed

Umožňuje vyvolání metody automatizace.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byl ovládací prvek inicializován; jinak 0.

### <a name="remarks"></a>Poznámky

Provádění rámce `IDispatch::Invoke` volání `IsInvokeAllowed` k určení, zda dané funkce `dispid`(identifikované ) mohou být vyvolány. Výchozí chování pro ovládací prvek OLE je povolit metody automatizace, které mají být vyvolány pouze v případě, že ovládací prvek byl inicializován; je `IsInvokeAllowed` však virtuální funkce a může být přepsána v případě potřeby (například při použití ovládacího prvku jako automatizační server).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl::IsModified

Určuje, zda byl změněn stav ovládacího prvku.

```
BOOL IsModified();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byl stav ovládacího prvku od posledního uložení změněn; jinak 0.

### <a name="remarks"></a>Poznámky

Stav ovládacího prvku je změněn při změně hodnoty vlastnosti.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw

Určuje, zda kontejner podporuje optimalizovaný výkres pro aktuální operaci výkresu.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Návratová hodnota

PRAVDA, pokud kontejner podporuje optimalizovaný výkres pro aktuální operaci kreslení; jinak FALSE.

### <a name="remarks"></a>Poznámky

Pokud je optimalizovaný výkres podporován, nemusí ovládací prvek při dokončení kreslení do kontextu zařízení vybírat staré objekty (pera, stopy, písma atd.).

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl

Volat rámci k určení, pokud ovládací prvek podtřídy ovládacíprvek systému Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je ovládací prvek podtřídou; jinak 0.

### <a name="remarks"></a>Poznámky

Tuto funkci je nutné přepsat a vrátit hodnotu TRUE, pokud ovládací prvek OLE podřcovává ovládací prvek systému Windows.

## <a name="colecontrolload"></a><a name="load"></a>COleControl::Načíst

Obnoví všechna předchozí data načtená asynchronně a iniciuje nové načítání asynchronní vlastnosti ovládacího prvku.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parametry

*strNewPath*<br/>
Ukazatel na řetězec obsahující cestu, která odkazuje na absolutní umístění vlastnosti asynchronního ovládacího prvku.

*Prop*<br/>
Objekt [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) implementující vlastnost asynchronního ovládacího prvku.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl::LockInPlaceActive

Zabrání kontejneru deaktivace ovládacího prvku.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parametry

*Blok*<br/>
PRAVDA, pokud má být aktivní stav ovládacího prvku na místě uzamčen; FALSE, pokud má být odemčena.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byl zámek úspěšný; jinak 0.

### <a name="remarks"></a>Poznámky

Všimněte si, že každé uzamčení ovládacího prvku musí být spárováno s odemknutím ovládacího prvku po dokončení. Ovládací prvek byste měli uzamknout pouze na krátkou dobu, například při spouštění události.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange

Volat rámci při okolní vlastnost kontejneru změnila hodnotu.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání vlastnosti okolí, která se změnila, nebo DISPID_UNKNOWN, pokud došlo ke změně více vlastností.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl::OnAppearanceChanged

Volat rámci při změně hodnoty vlastnosti vzhledu akcií.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud chcete oznámení po této změně vlastnosti. Výchozí volání `InvalidateControl`implementace .

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged

Volat rámci při změně hodnoty vlastnosti backcolor skladu.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud chcete oznámení po této změně vlastnosti. Výchozí volání `InvalidateControl`implementace .

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged

Volat rámci při změně hodnoty vlastnosti borderstyle skladu.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí volání `InvalidateControl`implementace .

Přepsat tuto funkci, pokud chcete oznámení po této změně vlastnosti.

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl::OnClick

Volat rámci po klepnutí na tlačítko myši nebo DoClick stock metoda byla vyvolána.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parametry

*tlačítko iButton*<br/>
Index tlačítka myši. Může mít jednu z následujících hodnot:

- LEFT_BUTTON Bylo kliknuto na levé tlačítko myši.

- MIDDLE_BUTTON Bylo kliknuto na prostřední tlačítko myši.

- RIGHT_BUTTON Bylo kliknuto pravým tlačítkem myši.

### <a name="remarks"></a>Poznámky

Výchozí volání `COleControl::FireClick`implementace .

Přepište tuto členovou funkci a upravte nebo rozšiřte výchozí zpracování.

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl::OnClose

Volat rámci při kontejneru volá funkce `IOleControl::Close` ovládacího prvku.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parametry

*dwSaveOption*<br/>
Příznak, který označuje, zda má být objekt uložen před načtením. Platné hodnoty jsou:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Poznámky

Ve výchozím `OnClose` nastavení uloží objekt ovládacího prvku, pokud byl změněn a *dwSaveOption* je buď OLECLOSE_SAVEIFDIRTY nebo OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl::Ondoverb

Volat rámci při volání kontejneru `IOleObject::DoVerb` členské funkce.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*iSponož*<br/>
Index ovládacího slovesa, které má být vyvoláno.

*lpMsg*<br/>
Ukazatel na zprávu systému Windows, která způsobila vyvolání slovesa.

*hWndParent*<br/>
Popisovač nadřazeného okna ovládacího prvku. Pokud provádění slovesa vytvoří okno (nebo okna), *hWndParent* by měl být použit jako nadřazený.

*lpRect*<br/>
Ukazatel na rect strukturu, do které budou zkopírovány souřadnice ovládacího prvku vzhledem ke kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud bylo volání úspěšné; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace používá ON_OLEVERB a ON_STDOLEVERB položky mapy zpráv k určení správné funkce vyvolat.

Přepsáním této funkce změníte výchozí zpracování slovesa.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl::Ondraw

Volat rámci nakreslit ovládací prvek OLE v zadaném ohraničovacím obdélníku pomocí kontextu zadaného zařízení.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Kontext zařízení, ve kterém dochází k výkresu.

*rcBounds*<br/>
Obdélníková oblast ovládacího prvku, včetně ohraničení.

*rcNeplatné*<br/>
Obdélníková oblast ovládacího prvku, který je neplatný.

### <a name="remarks"></a>Poznámky

`OnDraw`obvykle volána pro zobrazení na obrazovce, předávání kontextu obrazovky zařízení jako *pDC*. Parametr *rcBounds* identifikuje obdélník v kontextu cílového zařízení (vzhledem k jeho aktuálnímu režimu mapování). Parametr *rcInvalid* je skutečný obdélník, který je neplatný. V některých případech to bude menší oblast než *rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl::Soubor OnDrawMetafile

Volat rámci nakreslit ovládací prvek OLE v zadaném ohraničovacím obdélníku pomocí zadaného kontextu zařízení metasouboru.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Kontext zařízení, ve kterém dochází k výkresu.

*rcBounds*<br/>
Obdélníková oblast ovládacího prvku, včetně ohraničení.

### <a name="remarks"></a>Poznámky

Výchozí implementace volá funkci [OnDraw.](#ondraw)

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl::OnEdit

Způsobí, že ovládací prvek má být aktivován.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Ukazatel na zprávu systému Windows, která vyvolala sloveso.

*hWndParent*<br/>
Popisovač nadřazeného okna ovládacího prvku.

*lpRect*<br/>
Ukazatel na obdélník používaný ovládacím prvkem v kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je volání úspěšné; jinak 0.

### <a name="remarks"></a>Poznámky

To má stejný účinek jako vyvolání OLEIVERB_UIACTIVATE slovesa ovládacího prvku.

Tato funkce se obvykle používá jako funkce obslužné rutiny pro ON_OLEVERB položku mapy zpráv. Tím se zpřístupní sloveso "Upravit" v nabídce "Objekt" ovládacího prvku. Příklad:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl::OnEnabledChanged

Volat rámci při změně hodnoty vlastnosti Enabled skladového souboru.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud chcete oznámení po této změně vlastnosti. Výchozí implementace volá [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl::OnEnumVerbs

Volat rámci při volání kontejneru `IOleObject::EnumVerbs` členské funkce.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parametry

*ppenumOleVerb*<br/>
Ukazatel na `IEnumOLEVERB` objekt, který vyjmenovává slovesa ovládacího prvku.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud jsou k dispozici slovesa; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace vyjmenovává ON_OLEVERB položky v mapě zpráv.

Přepsáním této funkce změníte výchozí způsob výčtu sloves.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl::OnEventAdvise

Volat rámci při obslužné rutiny události je připojen nebo odpojen od ovládacího prvku OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parametry

*bPoradit*<br/>
True označuje, že obslužná rutina události byla připojena k ovládacímu prvku. NEPRAVDA označuje, že obslužná rutina události byla odpojena od ovládacího prvku.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl::OnFontChanged

Volat rámci při změně hodnoty vlastnosti stock Font.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí volání `COleControl::InvalidateControl`implementace . Pokud ovládací prvek podřadné třídy ovládacího prvku systému Windows, výchozí implementace také odešle zprávu WM_SETFONT do okna ovládacího prvku.

Přepsat tuto funkci, pokud chcete oznámení po této změně vlastnosti.

### <a name="example"></a>Příklad

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl::OnForeColorChanged

Volat rámci při změně hodnoty vlastnosti ForeColor zásob.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí volání `InvalidateControl`implementace .

Přepsat tuto funkci, pokud chcete oznámení po této změně vlastnosti.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl::Události onfreeze

Volat rámci po volání `IOleControl::FreezeEvents`kontejneru .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parametry

*bZmrazení*<br/>
TRUE, pokud zpracování událostí ovládacího prvku je zmrazen; jinak FALSE.

### <a name="remarks"></a>Poznámky

Výchozí implementace neprovede žádné provádění.

Přepsat tuto funkci, pokud chcete další chování při zpracování událostí je zmrazené nebo nezmrazené.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl::OnGetColorSet

Volat rámci při volání kontejneru `IViewObject::GetColorSet` členské funkce.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parametry

*Ptd*<br/>
Odkazuje na cílové zařízení, pro které by měl být obrázek vykreslen. Pokud je tato hodnota null, obrázek by měl být vykreslen pro výchozí cílové zařízení, obvykle zobrazovací zařízení.

*hicTargetDev*<br/>
Určuje kontext informací na cílovém zařízení označeném *ptd*. Tento parametr může být kontext zařízení, ale není nutně jeden. Pokud *ptd* je NULL, *hicTargetDev* by měl být také NULL.

*ppColorSet*<br/>
Ukazatel na umístění, do kterého by měla být zkopírována sada barev, které by měly být použity. Pokud funkce nevrátí sadu barev, null je vrácena.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je vrácena platná sada barev; jinak 0.

### <a name="remarks"></a>Poznámky

Kontejner volá tuto funkci získat všechny barvy potřebné k nakreslení ovládacího prvku OLE. Kontejner může použít sady barev získané ve spojení s barvami, které potřebuje k nastavení celkové palety barev. Výchozí implementace vrátí hodnotu NEPRAVDA.

Přepsat tuto funkci provést jakékoli zvláštní zpracování tohoto požadavku.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo

Volat rámci při kontejneru ovládacího prvku požadované informace o ovládacíprvek.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parametry

*pControlInfo*<br/>
Ukazatel na [controlinfo](/windows/win32/api/ocidl/ns-ocidl-controlinfo) strukturu, která má být vyplněna.

### <a name="remarks"></a>Poznámky

Tyto informace se skládají především z popisu mnemotechnické klíče ovládacího prvku. Výchozí implementace vyplní *pControlInfo* výchozími informacemi.

Přepsat tuto funkci, pokud vaše ovládací prvek potřebuje ke zpracování mnemotechnické klávesy.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString

Volat rámci získat řetězec, který představuje aktuální hodnotu vlastnosti identifikované *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání vlastnosti ovládacího prvku.

*strValue*<br/>
Odkaz na [CString](../../atl-mfc-shared/reference/cstringt-class.md) objekt, jehož prostřednictvím bude vrácen řetězec.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byl řetězec vrácen v *strValue;* jinak 0.

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud ovládací prvek má vlastnost, jejíž hodnotu nelze přímo převést na řetězec a chcete, aby hodnota vlastnosti se zobrazí v prohlížeči vlastností dodaného kontejnerem.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl::OnGetInplaceMenu

Volat rámci při aktivaci ovládacího prvku pro získání nabídky, které mají být sloučeny do existující nabídky kontejneru.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Návratová hodnota

Popisovač nabídky ovládacího prvku nebo NULL, pokud ovládací prvek nemá žádné. Výchozí implementace vrátí hodnotu NULL.

### <a name="remarks"></a>Poznámky

Další informace o slučování prostředků OLE naleznete v článku [Nabídky a prostředky (OLE).](../../mfc/menus-and-resources-ole.md)

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent

Volat rámci v reakci na `IViewObjectEx::GetNaturalExtent` požadavek kontejneru.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Určuje, jak má být objekt reprezentován. Reprezentace zahrnují obsah, ikonu, miniaturu nebo tištěný dokument. Platné hodnoty jsou převzaty z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*Lindex*<br/>
Část objektu, který je v zájmu. V současné době je platný pouze -1.

*Ptd*<br/>
Odkazuje na [dvtargetdevice](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) struktury definování cílové zařízení, pro které by měla být vrácena velikost objektu.

*hicTargetDev*<br/>
Určuje kontext informací pro cílové zařízení označené parametrem *ptd,* ze kterého může objekt extrahovat metriky zařízení a otestovat možnosti zařízení. Pokud *ptd* je NULL, objekt by měl ignorovat hodnotu v *parametru hicTargetDev.*

*pExtentInfo*<br/>
Odkazuje na `DVEXTENTINFO` strukturu, která určuje data velikosti. Struktura `DVEXTENTINFO` je:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Člen `dwExtentMode` struktury může mít jednu ze dvou hodnot:

- DVEXTENT_CONTENT Dotaz, jak velký ovládací prvek by měl být přesně přizpůsobit obsah (snap-to-size)

- DVEXTENT_INTEGRAL Při změně velikosti přejděte navrhovanou velikost k řízení

*psizel*<br/>
Odkazuje na velikost dat vrácených ovládacím prvkem. Vrácená data velikosti jsou nastavena na -1 pro všechny dimenze, které nebyly upraveny.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud úspěšně vrátí nebo upraví velikost; jinak 0.

### <a name="remarks"></a>Poznámky

Přepsáním této funkce vrátíte velikost zobrazení objektu co nejblíže `DVEXTENTINFO` navrhované velikosti a rozsahu režimu ve struktuře. Výchozí implementace vrátí hodnotu FALSE a neprovede žádné úpravy velikosti.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings

Volat rámci získat sadu předdefinovaných řetězců představující možné hodnoty pro vlastnost.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání vlastnosti ovládacího prvku.

*pole pStringArray*<br/>
Pole řetězce, které má být vyplněno vrácenými hodnotami.

*pole pCookieArray*<br/>
Pole DWORD, které má být vyplněno vrácenými hodnotami.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byly přidány prvky do *pStringArray* a *pCookieArray*.

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud ovládací prvek má vlastnost se sadou možných hodnot, které mohou být reprezentovány řetězce. Pro každý prvek přidaný do *pStringArray*byste měli do *pCookieArray* přidat odpovídající prvek "cookie". Tyto hodnoty "cookie" mohou být později `COleControl::OnGetPredefinedValue` předány rámci funkce.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue

Volat rámci získat hodnotu odpovídající jeden z předdefinovaných řetězců dříve vrácena přepsání `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání vlastnosti ovládacího prvku.

*dwCookie*<br/>
Hodnota souboru cookie, která `COleControl::OnGetPredefinedStrings`byla dříve vrácena přepsáním aplikace .

*lpvarOut*<br/>
Ukazatel na `VARIANT` strukturu, jehož prostřednictvím bude vrácena hodnota vlastnosti.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byla vrácena hodnota v *lpvarOut*; jinak 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl::OnGetViewExtent

Volat rámci v reakci na kontejneru [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) požadavek.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parametry

*dwDrawAspect*<br/>
DWORD popisující, který formulář nebo aspekt objektu má být zobrazen. Platné hodnoty jsou převzaty z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*Lindex*<br/>
Část objektu, který je v zájmu. V současné době je platný pouze -1.

*Ptd*<br/>
Odkazuje na [dvtargetdevice](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) struktury definování cílové zařízení, pro které by měla být vrácena velikost objektu.

*lpsizel*<br/>
Odkazuje na umístění, kde je vrácena velikost objektu.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud jsou informace o rozsahu úspěšně vráceny; jinak 0.

### <a name="remarks"></a>Poznámky

Tuto funkci přepište, pokud ovládací prvek používá dvouprůchodový výkres a jeho neprůhledné a průhledné součásti mají různé rozměry.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl::OnGetViewRect

Volat rámci v reakci na `IViewObjectEx::GetRect` požadavek kontejneru.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
DWORD popisující, který formulář nebo aspekt objektu má být zobrazen. Platné hodnoty jsou převzaty z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2:

- DVASPECT_CONTENT Ohraničující obdélník celého objektu. Levý horní roh v počátku a velikosti objektu `GetViewExtent`rovnající se rozsahu vráceného *.*

- DVASPECT_OPAQUE Objekty s obdélníkovou neprůhlednou oblastí vrátí tento obdélník. Jiní selžou.

- DVASPECT_TRANSPARENT Obdélník pokrývající všechny průhledné nebo nepravidelné části.

*pRect*<br/>
Odkazuje na [rectl](/windows/win32/api/windef/ns-windef-rectl) strukturu určující obdélník, ve kterém má být objekt nakreslena. Tento parametr řídí umístění a roztažení objektu.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je obdélník velikosti objektu úspěšně vrácena; jinak 0.

### <a name="remarks"></a>Poznámky

Velikost objektu je převedena `OnGetViewRect` na obdélník začínající na určité pozici (výchozí hodnota je levý horní roh displeje). Tuto funkci přepište, pokud ovládací prvek používá dvouprůchodový výkres a jeho neprůhledné a průhledné součásti mají různé rozměry.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl::OnGetViewStatus

Volat rámci v reakci na `IViewObjectEx::GetViewStatus` požadavek kontejneru.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Návratová hodnota

Jedna z hodnot výčtu VIEWSTATUS, pokud je úspěšný; jinak 0. Možné hodnoty jsou libovolnou kombinací následujících hodnot:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Objekt je zcela neprůhledný. Pokud tento bit není nastaven, objekt obsahuje průhledné části. Tento bit se vztahuje pouze na aspekty související s obsahem a nikoli na DVASPECT_ICON nebo DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Objekt má plné pozadí (skládající se z plné barvy, nikoli v vzorku stopy). Tento bit je smysluplný pouze v případě, VIEWSTATUS_OPAQUE je nastavena a vztahuje se pouze na aspekty související s obsahem a nikoli na DVASPECT_ICON nebo DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Objekt podporuje DVASPECT_OPAQUE. Všechny metody IViewObjectEx, které berou aspekt kreslení jako parametr lze volat s tímto aspektem.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Objekt podporuje DVASPECT_TRANSPARENT. Všechny `IViewObjectEx` metody, které berou aspekt výkresu jako parametr lze volat s tímto aspektem.|

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud ovládací prvek používá dvouprůchodový výkres. Výchozí implementace vrátí VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl::OnhideToolBars

Volat rámci při ovládacího prvku je deaktivován.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Poznámky

Implementace by měla skrýt všechny `OnShowToolbars`panely nástrojů zobrazené v .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove

Volat kontejneru pro neaktivní objekt pod ukazatelem myši při příjmu zprávy WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Obdélník ohraničující objekt v souřadnicích klienta obsahujícího okna. Sděluje objektu jeho přesnou polohu a velikost na obrazovce při přijetí WM_MOUSEMOVE zprávy.

*X*<br/>
X souřadnice umístění myši v souřadnicích klienta obsahující okno.

*Y*<br/>
Y souřadnice umístění myši v souřadnicích klienta obsahující okno.

*dwKeyState*<br/>
Identifikuje aktuální stav kláves modifikátoru klávesnice na klávesnici. Platné hodnoty mohou být kombinací některého z příznaků MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON a MK_RBUTTON.

### <a name="remarks"></a>Poznámky

Všimněte si, že souřadnice klienta okna (pixely) se používají k průchodu pozice kurzoru myši. To je možné také předáním ohraničující obdélník objektu ve stejném souřadnicovém systému.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor

Volat kontejneru pro neaktivní objekt pod ukazatelem myši při příjmu zprávy WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Obdélník ohraničující objekt v souřadnicích klienta obsahujícího okna. Sděluje objektu jeho přesnou polohu a velikost na obrazovce při přijetí WM_SETCURSOR zprávy.

*X*<br/>
X souřadnice umístění myši v souřadnicích klienta obsahující okno.

*Y*<br/>
Y souřadnice umístění myši v souřadnicích klienta obsahující okno.

*dwMouseMsg*<br/>
Identifikátor zprávy myši, pro které došlo k WM_SETCURSOR.

*bSetAlways*<br/>
Určuje, zda musí objekt nastavit kurzor. Pokud true, musí objekt nastavit kurzor; Pokud false, kurzor není povinen nastavit kurzor a by měl vrátit S_FALSE v takovém případě.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Všimněte si, že souřadnice klienta okna (pixely) se používají k průchodu pozice kurzoru myši. To je možné také předáním ohraničující obdélník objektu ve stejném souřadnicovém systému.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl::OnKeyDownEvent

Volat rámci po skladové keydown událost byla zpracována.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*Nchar*<br/>
Hodnota kódu virtuálního klíče stisknuté klávesy. Seznam standardních virtuálních kódů klíčů naleznete v tématu Winuser.h

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK Během akce byla stisknuta klávesa SHIFT.

- CTRL_MASK Během akce byla stisknuta klávesa CTRL.

- ALT_MASK Během akce byla stisknuta klávesa ALT.

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud ovládací prvek potřebuje přístup k informacím klíče po události byla aktivována.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl::OnKeyPressEvent

Volat rámci po akci KeyPress událost byla aktivována.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parametry

*Nchar*<br/>
Obsahuje hodnotu kódu virtuálního klíče stisknuté klávesy. Seznam standardních virtuálních kódů klíčů naleznete v tématu Winuser.h

### <a name="remarks"></a>Poznámky

Všimněte si, že hodnota *nChar* může být změněna kontejnerem.

Přepsat tuto funkci, pokud chcete oznámení po výskytu této události.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl::OnKeyUpEvent

Volat rámci po skladové keydown událost byla zpracována.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*Nchar*<br/>
Hodnota kódu virtuálního klíče stisknuté klávesy. Seznam standardních virtuálních kódů klíčů naleznete v tématu Winuser.h

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK Během akce byla stisknuta klávesa SHIFT.

- CTRL_MASK Během akce byla stisknuta klávesa CTRL.

- ALT_MASK Během akce byla stisknuta klávesa ALT.

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci, pokud ovládací prvek potřebuje přístup k informacím klíče po události byla aktivována.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage

Volat rámci získat ID třídy stránky vlastností, která implementuje úpravy zadané vlastnosti.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
ID odeslání vlastnosti ovládacího prvku.

*lpclsid (lpclsid)*<br/>
Ukazatel na `CLSID` strukturu, přes kterou bude vráceno ID třídy.

*pbPageNepovinné*<br/>
Vrátí indikátor, zda je použití zadané stránky vlastností volitelné.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud bylo v *lpclsidu*vráceno ID třídy ; jinak 0.

### <a name="remarks"></a>Poznámky

Přepsat tuto funkci poskytnout způsob, jak vyvolat stránky vlastností ovládacího prvku z prohlížeče vlastností kontejneru.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl::OnMnemonic

Volat rámci, když kontejner zjistil, že byl stisknut mnemotechnické klávesy ovládacího prvku OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parametry

*pMsg*<br/>
Ukazatel na zprávu systému Windows vygenerovanou mnemotechnické klávesy.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl::OnProperties

Volat rámci při vlastnosti ovládacího prvku sloveso byl vyvolán kontejneru.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Ukazatel na zprávu systému Windows, která vyvolala sloveso.

*hWndParent*<br/>
Popisovač nadřazeného okna ovládacího prvku.

*lpRect*<br/>
Ukazatel na obdélník používaný ovládacím prvkem v kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je volání úspěšné; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace zobrazí dialogové okno modální vlastnosti.

Tuto funkci můžete také použít k zobrazení stránek vlastností ovládacího prvku. Proveďte volání `OnProperties` funkce, předávání popisovač nadřazeného ovládacího prvku v *hWndParent* parametr. V tomto případě jsou ignorovány hodnoty parametrů *lpMsg* a *lpRect.*

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint

Volat rámci v reakci na `IViewObjectEx::QueryHitPoint` požadavek kontejneru.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Určuje způsob reprezentace objektu. Platné hodnoty jsou převzaty z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*pRectBounds*<br/>
Ukazatel na `RECT` strukturu určující ohraničující obdélník klientské oblasti ovládacího prvku OLE.

*ptlLoc*<br/>
Ukazatel na `POINT` strukturu určující bod, který má být zkontrolován pro přístup. Bod je určen v souřadnicích oblasti klienta OLE.

*lCloseHint*<br/>
Vzdálenost, která definuje "zavřít" k bodu zkontrolovanému pro zásah.

*pHitVýsledek*<br/>
Ukazatel na výsledek dotazu na přístup. Jedna z následujících hodnot:

- HITRESULT_OUTSIDE *ptlLoc* je mimo objekt OLE a není blízko.

- HITRESULT_TRANSPARENT *ptlLoc* je v rámci hranice objektu OLE, ale není blízko k obrazu. Například bod uprostřed průhledného kruhu může být HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* je uvnitř nebo vně objektu OLE, ale dostatečně blízko k objektu, který lze považovat uvnitř. Malé, tenké nebo podrobné objekty mohou použít tuto hodnotu. I v případě, že bod je mimo ohraničující obdélník objektu může být stále blízko (to je nutné pro zasažení malých objektů).

- HITRESULT_HIT *ptlLoc* je v obraze objektu.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšně vrácen výsledek přístupu; jinak 0. Přístupový prvek je překrytí s oblastí zobrazení ovládacího prvku OLE.

### <a name="remarks"></a>Poznámky

Dotazuje se, zda obdélník zobrazení objektu překrývá daný bod (zasáhne bod). `QueryHitPoint`lze přepsat, aby bylo možné testovat přístupy k neobdélníkovým objektům.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl::OnQueryHitRect

Volat rámci v reakci na `IViewObjectEx::QueryHitRect` požadavek kontejneru.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Určuje, jak má být objekt reprezentován. Platné hodnoty jsou převzaty z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*pRectBounds*<br/>
Ukazatel na `RECT` strukturu určující ohraničující obdélník klientské oblasti ovládacího prvku OLE.

*prcLoc*<br/>
Ukazatel na `RECT` strukturu určující obdélník, který má být zkontrolován pro přístup k přístupu (překrytí obdélníkem objektu) vzhledem k levému hornímu rohu objektu.

*lCloseHint*<br/>
Nepoužívá se.

*pHitVýsledek*<br/>
Ukazatel na výsledek dotazu na přístup. Jedna z následujících hodnot:

- HITRESULT_OUTSIDE žádný bod v obdélníku je zasažen objektem OLE.

- HITRESULT_HIT alespoň jeden bod v obdélníku by být přístupů na objekt.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšně vrácen výsledek přístupu; jinak 0.

### <a name="remarks"></a>Poznámky

Dotazuje se, zda obdélník zobrazení objektu překrývá libovolný bod v daném obdélníku (zasáhne obdélník). `QueryHitRect`lze přepsat, aby bylo možné testovat přístupy k neobdélníkovým objektům.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl::OnRenderData

Volat rámci načíst data v zadaném formátu.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Odkazuje na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu určující formát, ve kterém jsou požadovány informace.

*lpStgStřední*<br/>
Odkazuje na [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) strukturu, ve kterém mají být vrácena data.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Zadaný formát je dříve umístěn v objektu ovládacího prvku pomocí členských funkcí [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) nebo [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) pro zpožděné vykreslování. Výchozí implementace této funkce `OnRenderFileData` `OnRenderGlobalData`volá nebo , v uvedeném pořadí, pokud je dodané paměťové médium soubor emitační nebo paměť. Pokud je požadovaný formát CF_METAFILEPICT nebo formát trvalé sady vlastností, výchozí implementace vykreslí příslušná data a vrátí nenulovou hodnotu. V opačném případě vrátí 0 a neprovede žádné.

Pokud *lpStgMedium->tymed* je TYMED_NULL, STGMEDIUM by měla být přidělena a vyplněna podle *boduLpFormatEtc->tymed*. Pokud není TYMED_NULL, STGMEDIUM by měla být vyplněna na místě s daty.

Přepište tuto funkci a poskytněte data v požadovaném formátu a médiu. V závislosti na datech můžete místo toho přepsat jednu z dalších verzí této funkce. Pokud jsou data malá a pevná, přepište . `OnRenderGlobalData` Pokud jsou data v souboru nebo mají proměnnou velikost, přepište to `OnRenderFileData`.

Další informace naleznete `FORMATETC` v `STGMEDIUM` části a struktury sady Windows SDK.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl::OnRenderFileData

Volat rámci načíst data v zadaném formátu, když médium úložiště je soubor.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Odkazuje na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu určující formát, ve kterém jsou požadovány informace.

*pSoubor*<br/>
Odkazuje na [cfile](../../mfc/reference/cfile-class.md) objekt, ve kterém mají být vykresleny data.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Zadaný formát je dříve umístěn v objektu ovládacího prvku pomocí členské funkce [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pro zpožděné vykreslování. Výchozí implementace této funkce jednoduše vrátí hodnotu NEPRAVDA.

Přepište tuto funkci a poskytněte data v požadovaném formátu a médiu. V závislosti na datech můžete místo toho přepsat jednu z dalších verzí této funkce. Pokud chcete zpracovat více paměťových `OnRenderData`médií, přepište . Pokud jsou data v souboru nebo mají proměnnou velikost, přepište to `OnRenderFileData`.

Další informace naleznete `FORMATETC` ve struktuře sady Windows SDK.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData

Volat rámci načíst data v zadaném formátu, pokud zadané paměťové médium je globální paměti.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Odkazuje na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu určující formát, ve kterém jsou požadovány informace.

*phGlobální*<br/>
Odkazuje na popisovač globální paměti, ve kterém mají být vrácena data. Pokud nebyla přidělena žádná paměť, může být tento parametr null.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Zadaný formát je dříve umístěn v objektu ovládacího prvku pomocí členské funkce [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pro zpožděné vykreslování. Výchozí implementace této funkce jednoduše vrátí hodnotu NEPRAVDA.

Pokud *phGlobal* je NULL, pak nový HGLOBAL by měly být přiděleny a vráceny v *phGlobal*. V opačném případě hglobal určené *phGlobal* by měla být vyplněna data. Množství dat umístěných v HGLOBAL nesmí překročit aktuální velikost bloku paměti. Také blok nelze přerozděleny na větší velikost.

Přepište tuto funkci a poskytněte data v požadovaném formátu a médiu. V závislosti na datech můžete místo toho přepsat jednu z dalších verzí této funkce. Pokud chcete zpracovat více paměťových `OnRenderData`médií, přepište . Pokud jsou data v souboru nebo mají proměnnou velikost, přepište to `OnRenderFileData`.

Další informace naleznete `FORMATETC` ve struktuře sady Windows SDK.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl::OnResetState

Volat rámci při vlastnosti ovládacího prvku by měla být nastavena na jejich výchozí hodnoty.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá [DoPropExchange](#dopropexchange) `CPropExchange` , předávání objektu, který způsobí, že vlastnosti mají být nastaveny na jejich výchozí hodnoty.

Zapisovač ovládacího prvku může vložit inicializační kód pro ovládací prvek OLE v tomto overridable. Tato funkce je volána, když je volána [iPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) nebo [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) se nezdaří nebo [IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) nebo [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) je volána, bez prvního volání buď `IPersistStream::Load` nebo `IPersistStorage::Load`.

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl::OnSetClientSite

Volat rámci při kontejneru volá funkce `IOleControl::SetClientSite` ovládacího prvku.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Poznámky

Ve výchozím `OnSetClientSite` nastavení kontroluje, zda jsou načteny vlastnosti datové cesty a pokud ano, volání `DoDataPathPropExchange`.

Přepsat tuto funkci provést jakékoli zvláštní zpracování tohoto oznámení. Zejména přepsání této funkce by měla volat základní třídy.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl::OnSetData

Volat rámci nahradit data ovládacího prvku zadanými daty.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu určující formát dat.

*lpStgStřední*<br/>
Ukazatel na [stgmedium](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) strukturu, ve kterém jsou data umístěna.

*bUvolnění*<br/>
TRUE, pokud ovládací prvek by měl uvolnit paměťové médium; FALSE, pokud ovládací prvek by neměl uvolnit paměťové médium.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Pokud jsou data ve formátu trvalé sady vlastností, výchozí implementace odpovídajícím způsobem upraví stav ovládacího prvku. V opačném případě výchozí implementace neprovede žádné. Pokud *bRelease* je TRUE, `ReleaseStgMedium` pak je volání; jinak ne.

Přepište tuto funkci a nahraďte data ovládacího prvku zadanými daty.

Další informace naleznete `FORMATETC` v `STGMEDIUM` části a struktury sady Windows SDK.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl::Délka

Volat rámci při je třeba změnit rozsah ovládacího prvku, v důsledku volání [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parametry

*lpSizeL*<br/>
Ukazatel na `SIZEL` strukturu, která používá dlouhá celá čísla k reprezentaci šířky a výšky ovládacího prvku, vyjádřené v jednotkách HIMETRIC.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byla přijata změna velikosti; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace zpracovává změna velikosti rozsahu ovládacího prvku. Pokud je ovládací prvek aktivní na místě, `OnPosRectChanged` je provedeno volání kontejneru.

Přepsáním této funkce změníte výchozí změnu velikosti ovládacího prvku.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl::OnSetObjectRects

Volat rámci implementovat volání [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parametry

*lpRectPos*<br/>
Ukazatel na `RECT` strukturu označující novou pozici a velikost ovládacího prvku vzhledem ke kontejneru.

*lpRectClip*<br/>
Ukazatel na `RECT` strukturu označující obdélníkovou oblast, na kterou má být ovládací prvek oříznut.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud bylo přemístění přijato; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace automaticky zpracovává přemístění a změna velikosti okna ovládacího prvku a vrátí hodnotu TRUE.

Přepsáním této funkce změníte výchozí chování této funkce.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl::OnShowPanely nástrojů

Volat rámci při aktivaci ovládacího prvku.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace neprovede žádné provádění.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl::OnTextChanged

Volat rámci při změně hodnoty vlastnosti titulek nebo text stock.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí volání `InvalidateControl`implementace .

Přepsat tuto funkci, pokud chcete oznámení po této změně vlastnosti.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage

Volat rámci v reakci na `IOleInPlaceObjectWindowless::OnWindowMessage` požadavek kontejneru.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parametry

*msg*<br/>
Identifikátor zprávy předaný systémem Windows.

*wParam*<br/>
Jak prošel Windows. Určuje další informace specifické pro zprávu. Obsah tohoto parametru závisí na hodnotě parametru *msg.*

*Lparam*<br/>
Jak prošel Windows. Určuje další informace specifické pro zprávu. Obsah tohoto parametru závisí na hodnotě parametru *msg.*

*plVýsledek*<br/>
Kód výsledků systému Windows. Určuje výsledek zpracování zprávy a závisí na odeslané zprávě.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Zpracovává zprávy oken pro ovládací prvky bez oken. `COleControl`'s `OnWindowlessMessage` by měl y být použity pro zprávy v okně jiné než zprávy myši a klávesnice zprávy. `COleControl`poskytuje [SetCapture](#setcapture) a [SetFocus](#setfocus) konkrétně získat zachycení myši a fokus klávesnice pro objekty OLE bez oken.

Protože objekty bez oken nemají okno, potřebují mechanismus, aby jim kontejner odeslání zpráv. Objekt OLE bez oken získává zprávy ze `OnWindowMessage` svého `IOleInPlaceObjectWindowless` kontejneru prostřednictvím metody na rozhraní (rozšíření [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) pro podporu bez oken). `OnWindowMessage`nepřevezme `HWND` parametr.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl::ParentToClient

Převádí souřadnice *pPoint* do souřadnic klienta.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Ukazatel na hranice ovládacího prvku OLE v kontejneru. Ne klientská oblast, ale oblast celého ovládacího prvku včetně ohraničení a posuvníků.

*pBod*<br/>
Ukazatel na nadřazený bod (kontejner), který má být přeložen do souřadnic klientské oblasti ovládacího prvku.

*bHitTest*<br/>
Určuje, zda má být testování přístupů provedeno v bodě.

### <a name="return-value"></a>Návratová hodnota

Pokud *bHitTest* je FALSE, vrátí HTNOWHERE. Pokud *bHitTest* je PRAVDA, vrátí umístění, ve kterém nadřazený (kontejner) bod přistál v klientské oblasti ovládacího prvku OLE a je jedním z následujících myší hit-test hodnoty:

- HTBORDER Na hranici okna, které nemá ohraničení velikosti.

- HTBOTTOM V dolním vodorovném okraji okna.

- HTBOTTOMLEFT V levém dolním rohu ohraničení okna.

- HTBOTTOMRIGHT V pravém dolním rohu ohraničení okna.

- HTCAPTION V oblasti záhlaví.

- HTCLIENT V klientské oblasti.

- HTERROR Na pozadí obrazovky nebo na dělicí čáře mezi okny (stejně jako HTNOWHERE s tím rozdílem, že funkce `DefWndProc` systému windows vytváří systémové pípnutí označující chybu).

- HTGROWBOX V krabičce o velikosti.

- HTHSCROLL Ve vodorovném posuvníku.

- HTLEFT V levém okraji okna.

- HTMAXBUTTON V tlačítku Maximalizovat.

- HTMENU V oblasti menu.

- HTMINBUTTON V minimalizovat tlačítko.

- HTNOWHERE Na pozadí obrazovky nebo na dělící čáry mezi okny.

- HTREDUCE V minimalizovat tlačítko.

- HTRIGHT V pravém okraji okna.

- HTSIZE V poli velikosti (stejné jako HTGROWBOX).

- HTSYSMENU V ovládací nabídce nebo v tlačítko Zavřít v podřízeném okně.

- HTTOP V horním vodorovném okraji okna.

- HTTOPLEFT V levém horním rohu okraje okna.

- HTTOPRIGHT V pravém horním rohu okraje okna.

- HTTRANSPARENT V okně aktuálně zakrytém jiným oknem.

- HTVSCROLL Ve svislém posuvníku.

- HTZOOM V tlačítku Maximalizovat.

### <a name="remarks"></a>Poznámky

Na vstupní *pPoint* je relativní k původu nadřazené (levý horní roh kontejneru). Na výstupu *pPoint* je relativní k původu klientské oblasti ovládacího prvku OLE (levý horní roh klientské oblasti ovládacího prvku).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl::Pmodmodlální dialog

Upozorní kontejner, že modální dialogové okno bylo uzavřeno.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Zpracovat nadřazené okno modálního dialogového okna.

### <a name="remarks"></a>Poznámky

Tuto funkci zavolejte po zobrazení libovolného modálního dialogového okna. Tuto funkci je nutné volat, aby kontejner mohl povolit všechna okna nejvyšší úrovně zakázaná programem `PreModalDialog`. Tato funkce by měla být `PreModalDialog`spárována s voláním aplikace .

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl::Premodlodálnídialog

Upozorní kontejner, že modální dialogové okno se chystá zobrazit.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Zpracovat nadřazené okno modálního dialogového okna.

### <a name="remarks"></a>Poznámky

Volání této funkce před zobrazením libovolného modálního dialogového okna. Tuto funkci je nutné volat, aby kontejner mohl zakázat všechna okna nejvyšší úrovně. Po zobrazení modálního dialogového okna je `PostModalDialog`nutné zavolat .

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow

Zničí a znovu vytvoří okno ovládacího prvku.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>Poznámky

To může být nezbytné, pokud potřebujete změnit bity stylu okna.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl::Aktualizovat

Vynutí překreslení ovládacího prvku OLE.

```cpp
void Refresh();
```

### <a name="remarks"></a>Poznámky

Tato funkce je `COleControl` podporována základní třídou jako skladovou metodou nazvanou Aktualizovat. To umožňuje uživatelům ovládacího prvku OLE překreslit ovládací prvek v určitém čase. Další informace o této metodě naleznete v článku [Ovládací prvky ActiveX: Metody](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl::ReleaseCapture

Uvolní zachycení myši.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Pokud ovládací prvek aktuálně má zachycení myši, zachycení je uvolněna. V opačném případě tato funkce nemá žádný vliv.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl::ReleaseDC

Uvolní kontext zobrazovacího zařízení kontejneru ovládacího prvku bez oken, čímž uvolní kontext zařízení pro použití jinými aplikacemi.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Identifikuje kontext kontejneru zařízení, které mají být uvolněny.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Aplikace musí `ReleaseDC` volat pro každé volání [GetDC](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow

Nastaví nadřazenou položku ovládacího prvku.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parametry

*hWndOuter*<br/>
Popisovač ovládacího okna.

*hWndParent*<br/>
Popisovač novénadřazené okno.

### <a name="remarks"></a>Poznámky

Volání této funkce obnovit nadřazené ovládacího okna.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl::ResetStockProps

Inicializuje stav vlastností `COleControl` zásob na jejich výchozí hodnoty.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>Poznámky

Vlastnosti jsou: Vzhled, BackColor, BorderStyle, Caption, Povoleno, Písmo, ForeColor, hWnd a Text. Popis vlastností zásob naleznete v [tématu ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Binární inicializační výkon ovládacího prvku `ResetStockProps` `ResetVersion` můžete zlepšit `COleControl::OnResetState`pomocí a přepsáním . Viz následující příklad. Další informace o optimalizaci inicializace naleznete v [tématu ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Příklad

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl::ResetVersion

Inicializuje číslo verze na zadanou hodnotu.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parametry

*dwVersionDefault*<br/>
Číslo verze, které má být přiřazeno ovládacímu prvku.

### <a name="remarks"></a>Poznámky

Binární inicializační výkon ovládacího prvku `ResetVersion` `ResetStockProps` můžete zlepšit `COleControl::OnResetState`pomocí a přepsáním . Viz příklad na [ResetStockProps](#resetstockprops). Další informace o optimalizaci inicializace naleznete v [tématu ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl::ScrollWindow

Umožňuje objektu OLE bez oken posouvat oblast v rámci aktivního obrazu na místě na obrazovce.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*xČástka*<br/>
Určuje velikost vodorovného posouvání v jednotkách zařízení. Tento parametr musí být záporná hodnota pro posun doleva.

*yČástka*<br/>
Určuje velikost svislého posouvání v jednotkách zařízení. Tento parametr musí být záporná hodnota pro posun směrem nahoru.

*lpRect*<br/>
Odkazuje na [cRect](../../atl-mfc-shared/reference/crect-class.md) objekt nebo RECT strukturu, která určuje část oblasti klienta objektu OLE posunout, v klientských souřadnicích obsahující okno. Pokud *lpRect* je NULL, je posunuta celá klientská oblast objektu OLE.

*lpClipRect*<br/>
Odkazuje na `CRect` objekt `RECT` nebo strukturu, která určuje obdélník, na který se má mít klip. Posouvá se pouze obrazové body uvnitř obdélníku. Bity mimo obdélník nejsou ovlivněny, i když jsou v *obdélníku lpRect.* Pokud *lpClipRect* je NULL, žádné oříznutí se provádí na obdélníku posouvání.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl::SelectFontObject

Vybere písmo do kontextu zařízení.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Ukazatel na objekt kontextu zařízení.

*fontHolder*<br/>
Odkaz na objekt [CFontHolder](../../mfc/reference/cfontholder-class.md) představující písmo, které má být vybráno.

### <a name="return-value"></a>Návratová hodnota

Ukazatel na dříve vybrané písmo. Po dokončení všech operací kreslení, které používají *fontHolder,* by měl znovu vybrat dříve vybrané písmo předáním jako parametr [cdc::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl::SelectStockFont

Vybere vlastnost Stock Font do kontextu zařízení.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Kontext zařízení, do kterého bude vybráno písmo.

### <a name="return-value"></a>Návratová hodnota

Ukazatel na dříve `CFont` vybraný objekt. Měli byste použít [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) vybrat toto písmo zpět do kontextu zařízení po dokončení.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl::SerializovatRozsah

Serializuje nebo inicializuje stav místa zobrazení přiděleného ovládacímu prvku.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*ar*<br/>
Objekt `CArchive` serializovat do nebo z.

### <a name="remarks"></a>Poznámky

Pomocí aplikace `SerializeExtent`, a `SerializeStockProps` `SerializeVersion` přepsáním `COleControl::Serialize`můžete zlepšit výkon binární trvalosti ovládacího prvku . Viz následující příklad. Další informace o optimalizaci inicializace naleznete v [tématu ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Příklad

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl::SerializeStockProps

Serializuje nebo inicializuje stav vlastností `COleControl` zásob: Vzhled, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor a Text.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*ar*<br/>
Objekt `CArchive` serializovat do nebo z.

### <a name="remarks"></a>Poznámky

Popis vlastností zásob naleznete v [tématu ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Pomocí aplikace `SerializeStockProps`, a `SerializeExtent` `SerializeVersion` přepsáním `COleControl::Serialize`můžete zlepšit výkon binární trvalosti ovládacího prvku . Příklad naleznete v kódu na [SerializeExtent](#serializeextent). Další informace o optimalizaci inicializace naleznete v [tématu ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl::SerializeVersion

Serializuje nebo inicializuje stav informací o verzi ovládacího prvku.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*ar*<br/>
Objekt `CArchive` serializovat do nebo z.

*dwVersionDefault*<br/>
Aktuální číslo verze ovládacího prvku.

*bPřevést*<br/>
Označuje, zda mají být trvalá data při uložení převedena do nejnovějšího formátu nebo udržována ve stejném formátu, který měla při načítání.

### <a name="return-value"></a>Návratová hodnota

Číslo verze ovládacího prvku. Pokud se zadaný `SerializeVersion` archiv načítá, vrátí verzi načtenou z tohoto archivu. V opačném případě vrátí aktuálně načtenou verzi.

### <a name="remarks"></a>Poznámky

Pomocí aplikace `SerializeVersion`, a `SerializeExtent` `SerializeStockProps` přepsáním `COleControl::Serialize`můžete zlepšit výkon binární trvalosti ovládacího prvku . Příklad naleznete v kódu na [SerializeExtent](#serializeextent). Další informace o optimalizaci inicializace naleznete v [tématu ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl::SetAppearance

Nastaví hodnotu vlastnosti vzhledu vašeho ovládacího prvku.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parametry

*sVzhled*<br/>
**Krátká** (VT_I2) hodnota, která má být použita pro vzhled ovládacího prvku. Nulová hodnota nastaví vzhled ovládacího prvku na plochý a hodnota 1 nastaví vzhled ovládacího prvku na 3D.

### <a name="remarks"></a>Poznámky

Další informace o vlastnostech zásob naleznete [v tématu ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl::SetbackColor

Nastaví hodnotu vlastnosti BackColor vašeho ovládacího prvku.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parametry

*dwBackColor*<br/>
Hodnota OLE_COLOR, která má být použita pro kreslení ovládacího prvku na pozadí.

### <a name="remarks"></a>Poznámky

Další informace o použití této vlastnosti a dalších souvisejících vlastností naleznete v článku [Ovládací prvky ActiveX: Vlastnosti](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl::SetBorderStyle

Nastaví hodnotu vlastnosti BorderStyle vašeho ovládacího prvku.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parametry

*sBorderStyle*<br/>
Nový styl ohraničení pro ovládací prvek; 0 označuje žádné ohraničení a 1 normální ohraničení.

### <a name="remarks"></a>Poznámky

Ovládací okno bude poté znovu `OnBorderStyleChanged` vytvořeno a voláno.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl::SetCapture

Způsobí, že okno kontejneru ovládacího prvku převzít zachycení myši jménem ovládacího prvku.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na `CWnd` objekt okna, který dříve přijal vstup myši.

### <a name="remarks"></a>Poznámky

Pokud je aktivován ovládací prvek a bez oken, tato funkce způsobí, že okno kontejneru ovládacího prvku převzít zachycení myši, jménem ovládacího prvku. V opačném případě tato funkce způsobí, že samotný ovládací `CWnd::SetCapture`prvek převezme zachycení myši (stejné jako ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl::SetControlSize

Nastaví velikost okna ovládacího prvku OLE a upozorní kontejner, který mění lokalitu ovládacích prvku.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parametry

*Cx*<br/>
Určuje novou šířku ovládacího prvku v obrazových bodech.

*Cy*<br/>
Určuje novou výšku ovládacího prvku v obrazových bodech.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud bylo volání úspěšné; jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce by neměla být použita v konstruktoru ovládacího prvku.

Všimněte si, že všechny souřadnice pro ovládací okna jsou relativní vzhledem k levému hornímu rohu ovládacího prvku.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl::SetEnabled

Nastaví hodnotu vlastnosti Enabled ovládacího prvku.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parametry

*bPovoleno*<br/>
PRAVDA, pokud má být ovládací prvek povolen; jinak FALSE.

### <a name="remarks"></a>Poznámky

Po nastavení této `OnEnabledChange` vlastnosti se nazývá.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl::SetFocus

Způsobí, že okno kontejneru ovládacího prvku převzít vstupní fokus na ovládací prvek.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na `CWnd` objekt okna, který dříve měl vstupní fokus nebo NULL, pokud neexistuje žádné takové okno.

### <a name="remarks"></a>Poznámky

Pokud je aktivován ovládací prvek a bez oken, tato funkce způsobí, že okno kontejneru ovládacího prvku převzít vstupní fokus, na účet ovládacího prvku. Vstupní fokus směruje vstup z klávesnice do okna kontejneru a kontejner odešle všechny `SetFocus`následné zprávy klávesnice na objekt OLE, který volá . Všechna okna, která dříve měla vstupní fokus ztratí.

Pokud ovládací prvek není bez oken, tato funkce způsobí, že samotný `CWnd::SetFocus`ovládací prvek převezme vstupní fokus (stejně jako ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl::SetFont

Nastaví vlastnost stock Font ovládacího prvku.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parametry

*pFontDisp*<br/>
Ukazatel na rozhraní odeslání písma.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl::SetForeColor

Nastaví hodnotu vlastnosti ForeColor vašeho ovládacího prvku.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parametry

*dwForeColor*<br/>
OLE_COLOR hodnota, která má být použita pro kreslení ovládacího prvku v popředí.

### <a name="remarks"></a>Poznámky

Další informace o použití této vlastnosti a dalších souvisejících vlastností naleznete v článku [Ovládací prvky ActiveX: Vlastnosti](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats

Volat rámci inicializovat seznam formátů dat podporovaných ovládacím prvkem.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace určuje dva formáty: CF_METAFILEPICT a trvalé nastavení vlastností.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl::SetInitialSize

Nastaví velikost ovládacího prvku OLE při prvním zobrazení v kontejneru.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parametry

*Cx*<br/>
Počáteční šířka ovládacího prvku OLE v pixelech.

*Cy*<br/>
Počáteční výška ovládacího prvku OLE v pixelech.

### <a name="remarks"></a>Poznámky

Volání této funkce v konstruktoru nastavit počáteční velikost ovládacího prvku. Počáteční velikost se měří v jednotkách zařízení nebo pixelech. Doporučuje se, aby toto volání provést v konstruktoru ovládacího prvku.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl::SetModifiedFlag

Změní změněný stav ovládacího prvku.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parametry

*bZměněno*<br/>
Nová hodnota pro upravený příznak ovládacího prvku. True označuje, že stav ovládacího prvku byl změněn; FALSE označuje, že stav ovládacího prvku byl právě uložen.

### <a name="remarks"></a>Poznámky

Volání této funkce vždy, když dojde ke změně, která by mohla ovlivnit trvalý stav ovládacího prvku. Pokud se například změní hodnota trvalé vlastnosti, zavolejte tuto funkci *pomocí funkce bModified* **TRUE**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl::SetNotPovoleno

Označuje, že požadavek na úpravu se nezdařil.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>Poznámky

Volání této `BoundPropertyRequestEdit` funkce při selhání. Tato funkce vyvolá výjimku `COleDispScodeException` typu označující, že operace sady nebyla povolena.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl::SetNotSupported

Zabrání úpravám hodnoty vlastnosti ovládacího prvku uživatelem.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>Poznámky

Volání této funkce namísto Set funkce jakékoli vlastnosti, kde není podporována změna hodnoty vlastnosti uživatelem ovládacího prvku. Jedním z příkladů by vlastnost, která je jen pro čtení.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl::SetRectInContainer

Nastaví souřadnice obdélníku ovládacího prvku vzhledem ke kontejneru, vyjádřené v jednotkách zařízení.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na obdélník obsahující nové souřadnice ovládacího prvku vzhledem ke kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud bylo volání úspěšné; jinak 0.

### <a name="remarks"></a>Poznámky

Pokud je ovládací prvek otevřený, jeho velikost se mění; jinak je volána funkce kontejneru. `OnPosRectChanged`

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl::SetText

Nastaví hodnotu vlastnosti Titulek nebo Text ovládacího prvku.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parametry

*pszText*<br/>
Ukazatel na řetězec znaku.

### <a name="remarks"></a>Poznámky

Všimněte si, že vlastnosti Titulek na skladě a Text jsou mapovány na stejnou hodnotu. To znamená, že všechny změny provedené v obou vlastnostech automaticky změní obě vlastnosti. Obecně platí, že ovládací prvek by měl podporovat burzovní caption nebo text vlastnost, ale ne obojí.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl::ThrowError

Signalizuje výskyt chyby v ovládacím prvku.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*Sc*<br/>
Hodnota stavového kódu, která má být vykázána. Úplný seznam možných kódů naleznete v článku [Ovládací prvky ActiveX: Rozšířená témata](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
ID řetězce prostředku výjimky, které mají být hlášeny.

*nHelpID*<br/>
ID nápovědy k tématu, o které se má oznamovat.

*pszDescription*<br/>
Řetězec obsahující vysvětlení výjimky, které mají být hlášeny.

### <a name="remarks"></a>Poznámky

Tato funkce by měla být volána pouze z v rámci Get nebo Set funkce pro vlastnost OLE nebo implementace metody automatizace OLE. Pokud potřebujete signalizovat chyby, ke kterým dochází jindy, měli byste zapálit akci Stock Error.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl::TransformCoords

Transformuje hodnoty souřadnic mezi jednotkami HIMETRIC a nativními jednotkami kontejneru.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parametry

*lpptlHimetricko*<br/>
Ukazatel na `POINTL` strukturu obsahující souřadnice v jednotkách HIMETRIC.

*Kontejner lpptf*<br/>
Ukazatel na `POINTF` strukturu obsahující souřadnice ve velikosti jednotky kontejneru.

*příznaky*<br/>
Kombinace následujících hodnot:

- XFORMCOORDS_POSITION Pozice A v kontejneru.

- XFORMCOORDS_SIZE Velikost i v kontejneru.

- XFORMCOORDS_HIMETRICTOCONTAINER Jednotky HIMETRIC transformujte na jednotky kontejneru.

- XFORMCOORDS_CONTAINERTOHIMETRIC Jednotky kontejneru přeměňte na jednotky HIMETRIC.

### <a name="remarks"></a>Poznámky

První dva příznaky, XFORMCOORDS_POSITION a XFORMCOORDS_SIZE, označují, zda mají být souřadnice považovány za pozici nebo velikost. Zbývající dva příznaky označují směr transformace.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl::Přeložitbarvu

Převede hodnotu barvy z datového typu OLE_COLOR na datový typ [COLORREF.](/windows/win32/gdi/colorref)

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parametry

*clrColor*<br/>
Datový typ OLE_COLOR. Další informace naleznete v tématu Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) funkce.

*hpal*<br/>
Úchyt pro volitelnou paletu; může být null.

### <a name="return-value"></a>Návratová hodnota

RGB (červená, zelená, modrá) 32bitová hodnota barvy, která definuje plnou barvu nejblíže hodnotě *clrColor,* kterou může zařízení představovat.

### <a name="remarks"></a>Poznámky

Tato funkce je užitečná pro překlad vlastností ForeColor a BackColor na typy COLORREF používané členskými funkcemi [CDC.](../../mfc/reference/cdc-class.md)

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad

Určuje, zda ovládací prvek by měl použít hodnoty okolních vlastností jako výchozí hodnoty, když je následně načten z jeho trvalého stavu.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová označuje, že vlastnosti okolí budou platné; v opačném případě nebudou vlastnosti okolí platné.

### <a name="remarks"></a>Poznámky

V některých kontejnerech ovládací prvek nemusí mít přístup k jeho okolí `COleControl::DoPropExchange`vlastnosti během počáteční volání přepsat . To je případ, pokud kontejner volá [iPersistStreamInit:::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) nebo [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) před voláním [IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (to znamená, pokud nerespektuje OLEMISC_SETCLIENTSITEFIRST stavový bit).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl::WindowProc

Poskytuje postup systému `COleControl` Windows pro objekt.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametry

*Zprávu*<br/>
Určuje zprávu systému Windows, která má být zpracována.

*wParam*<br/>
Obsahuje další informace používané při zpracování zprávy. Hodnota parametru závisí na zprávě.

*Lparam*<br/>
Obsahuje další informace používané při zpracování zprávy. Hodnota parametru závisí na zprávě.

### <a name="return-value"></a>Návratová hodnota

Vrácená hodnota odeslané zprávy.

### <a name="remarks"></a>Poznámky

Volání této funkce k odeslání konkrétní zprávy prostřednictvím mapy zpráv ovládacího prvku.

## <a name="see-also"></a>Viz také

[Vzorek knihovny MFC CIRC3](../../overview/visual-cpp-samples.md)<br/>
[Testhelp vzorku knihovny MFC](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage – třída](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd – třída](../../mfc/reference/cwnd-class.md)<br/>
[Graf hierarchie](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder – třída](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder – třída](../../mfc/reference/cpictureholder-class.md)<br/>
