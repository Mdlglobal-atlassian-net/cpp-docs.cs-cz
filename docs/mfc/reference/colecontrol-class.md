---
title: COleControl – – Třída
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/06/2020
ms.locfileid: "78855725"
---
# <a name="colecontrol-class"></a>COleControl – – Třída

Výkonná základní třída pro vývoj ovládacích prvků OLE.

## <a name="syntax"></a>Syntaxe

```
class COleControl : public CWnd
```

## <a name="members"></a>Členové

### <a name="public-constructors"></a>Veřejné konstruktory

|Název|Popis|
|----------|-----------------|
|[COleControl –:: COleControl –](#colecontrol)|Vytvoří objekt `COleControl`.|

### <a name="public-methods"></a>Veřejné metody

|Název|Popis|
|----------|-----------------|
|[COleControl –:: AmbientAppearance](#ambientappearance)|Načte aktuální vzhled ovládacího prvku.|
|[COleControl –:: AmbientBackColor](#ambientbackcolor)|Vrátí hodnotu vlastnosti ambiented BackColor.|
|[COleControl –:: AmbientDisplayName](#ambientdisplayname)|Vrátí název ovládacího prvku, který je určen kontejnerem.|
|[COleControl –:: AmbientFont](#ambientfont)|Vrátí hodnotu vlastnosti okolního písma.|
|[COleControl –:: AmbientForeColor](#ambientforecolor)|Vrátí hodnotu vlastnosti okolního popředí.|
|[COleControl –:: AmbientLocaleID](#ambientlocaleid)|Vrátí ID národního prostředí kontejneru.|
|[COleControl –:: AmbientScaleUnits](#ambientscaleunits)|Vrátí typ jednotek používaných kontejnerem.|
|[COleControl –:: AmbientShowGrabHandles](#ambientshowgrabhandles)|Určuje, zda mají být zobrazeny popisovače přidaných hodnot.|
|[COleControl –:: AmbientShowHatching](#ambientshowhatching)|Určuje, zda má být zobrazeno šrafování.|
|[COleControl –:: AmbientTextAlign](#ambienttextalign)|Vrátí typ zarovnání textu určeného kontejnerem.|
|[COleControl –:: AmbientUIDead](#ambientuidead)|Určuje, zda má ovládací prvek reagovat na akce uživatelského rozhraní.|
|[COleControl –:: AmbientUserMode](#ambientusermode)|Určuje režim kontejneru.|
|[COleControl –:: BoundPropertyChanged](#boundpropertychanged)|Upozorní kontejner, že došlo ke změně vlastnosti Bound.|
|[COleControl –:: BoundPropertyRequestEdit](#boundpropertyrequestedit)|Požaduje oprávnění k úpravě hodnoty vlastnosti.|
|[COleControl –:: ClientToParent](#clienttoparent)|Přeloží bod vzhledem k počátku ovládacího prvku na bod vzhledem ke zdroji jeho kontejneru.|
|[COleControl –:: ClipCaretRect](#clipcaretrect)|Upraví obdélník blikajícího kurzoru, pokud je překrytý ovládacím prvkem.|
|[COleControl –:: ControlInfoChanged](#controlinfochanged)|Tuto funkci volejte poté, co se změní sada instrukcí zpracovávaných ovládacím prvkem.|
|[COleControl –::D isplayError](#displayerror)|Zobrazí chybové události akcií pro uživatele ovládacího prvku.|
|[COleControl –::D oClick](#doclick)|Implementace skladové `DoClick` metody|
|[COleControl –::D oPropExchange](#dopropexchange)|Zaserializace vlastnosti objektu `COleControl`.|
|[COleControl –::D oSuperclassPaint](#dosuperclasspaint)|Překreslí ovládací prvek OLE, který byl podtřídou z ovládacího prvku Windows.|
|[COleControl –:: EnableSimpleFrame](#enablesimpleframe)|Povoluje podporu jednoduchého rámce pro ovládací prvek.|
|[COleControl –:: ExchangeExtent](#exchangeextent)|Zaserializace šířky a výšky ovládacího prvku.|
|[COleControl –:: ExchangeStockProps](#exchangestockprops)|Zaserializace stavové vlastnosti ovládacího prvku.|
|[COleControl –:: ExchangeVersion](#exchangeversion)|Zaserializace číslo verze ovládacího prvku.|
|[COleControl –:: FireClick](#fireclick)|Aktivuje událost skladové `Click`.|
|[COleControl –:: FireDblClick](#firedblclick)|Aktivuje událost skladové `DblClick`.|
|[COleControl –:: FireError –](#fireerror)|Aktivuje událost skladové `Error`.|
|[COleControl –:: FireEvent](#fireevent)|Aktivuje se vlastní událost.|
|[COleControl –:: FireKeyDown](#firekeydown)|Aktivuje událost skladové `KeyDown`.|
|[COleControl –:: FireKeyPress](#firekeypress)|Aktivuje událost skladové `KeyPress`.|
|[COleControl –:: FireKeyUp](#firekeyup)|Aktivuje událost skladové `KeyUp`.|
|[COleControl –:: FireMouseDown](#firemousedown)|Aktivuje událost skladové `MouseDown`.|
|[COleControl –:: FireMouseMove](#firemousemove)|Aktivuje událost skladové `MouseMove`.|
|[COleControl –:: FireMouseUp](#firemouseup)|Aktivuje událost skladové `MouseUp`.|
|[COleControl –:: FireReadyStateChange](#firereadystatechange)|Aktivuje událost, když se změní stav připravenosti ovládacího prvku.|
|[COleControl –:: GetActivationPolicy](#getactivationpolicy)|Mění výchozí chování aktivace ovládacího prvku, který podporuje rozhraní `IPointerInactive`.|
|[COleControl –:: GetAmbientProperty](#getambientproperty)|Vrátí hodnotu zadané ambientní vlastnosti.|
|[COleControl –:: Get– zobrazení](#getappearance)|Vrátí hodnotu vlastnosti vzhledu akcie.|
|[COleControl –:: GetBackColor](#getbackcolor)|Vrátí hodnotu základní vlastnosti BackColor.|
|[COleControl –:: getborderstyle](#getborderstyle)|Vrátí hodnotu vlastnosti BorderStyle pro doplňování.|
|[COleControl –:: getcapture](#getcapture)|Určuje, zda ovládací prvek aktivovaného ovládacího prvku bez okna obsahuje zachycení myši.|
|[COleControl –:: GetClassID](#getclassid)|Načte ID třídy OLE ovládacího prvku.|
|[COleControl –:: GetClientOffset](#getclientoffset)|Načte rozdíl mezi levým horním rohem obdélníkové oblasti ovládacího prvku a levým horním rohem jeho klientské oblasti.|
|[COleControl –:: GetClientRect](#getclientrect)|Načte velikost klientské oblasti ovládacího prvku.|
|[COleControl –:: GetClientSite](#getclientsite)|Zadá dotaz na objekt pro ukazatel na jeho aktuální klientský server v rámci svého kontejneru.|
|[COleControl –:: GetControlFlags](#getcontrolflags)|Načte nastavení příznaku ovládacího prvku.|
|[COleControl –:: GetControlSize](#getcontrolsize)|Vrátí pozici a velikost ovládacího prvku OLE.|
|[COleControl –:: GetDC](#getdc)|Poskytuje způsob řízení bez oken pro získání kontextu zařízení z jeho kontejneru.|
|[COleControl –:: getenable](#getenabled)|Vrátí hodnotu vlastnosti enabled s povolenými zásobami.|
|[COleControl –:: GetExtendedControl](#getextendedcontrol)|Načte ukazatel na rozšířený objekt ovládacího prvku patřící do kontejneru.|
|[COleControl –:: GetFocus](#getfocus)|Určuje, zda má ovládací prvek fokus.|
|[COleControl –:: GetFont](#getfont)|Vrátí hodnotu vlastnosti burzovního písma.|
|[COleControl –:: GetFontTextMetrics](#getfonttextmetrics)|Vrátí metriku objektu `CFontHolder`.|
|[COleControl –:: GetForeColor](#getforecolor)|Vrátí hodnotu základní vlastnosti ForeColor.|
|[COleControl –:: GetHwnd](#gethwnd)|Vrátí hodnotu uložené vlastnosti hWnd.|
|[COleControl –:: GetMessageString](#getmessagestring)|Poskytuje text stavového řádku pro položku nabídky.|
|[COleControl –:: GetNotSupported](#getnotsupported)|Zabrání přístupu uživatele k hodnotě vlastnosti ovládacího prvku.|
|[COleControl –:: GetReadyState](#getreadystate)|Vrátí stav připravenosti ovládacího prvku.|
|[COleControl –:: GetRectInContainer](#getrectincontainer)|Vrátí obdélník ovládacího prvku vzhledem k jeho kontejneru.|
|[COleControl –:: GetStockTextMetrics](#getstocktextmetrics)|Vrátí metriku vlastnosti burzovního písma.|
|[COleControl –:: GetText](#gettext)|Vrátí hodnotu vlastnosti uloženého textu nebo titulku.|
|[COleControl –:: GetWindowlessDropTarget](#getwindowlessdroptarget)|Přepsáním umožníte, aby řízení bez oken bylo cílem operací přetažení.|
|[COleControl –:: InitializeIIDs](#initializeiids)|Informuje základní třídu IID, kterou bude ovládací prvek používat.|
|[COleControl –:: InternalGetFont](#internalgetfont)|Vrátí objekt `CFontHolder` pro vlastnost burzovního písma.|
|[COleControl –:: InternalGetText](#internalgettext)|Načte vlastnost titulku nebo textu.|
|[COleControl –:: funkci InternalSetReadyState](#internalsetreadystate)|Nastaví stav připravenosti ovládacího prvku a aktivuje událost Read-State-Change.|
|[COleControl –:: InvalidateControl](#invalidatecontrol)|Zruší platnost oblasti zobrazeného ovládacího prvku, což způsobí jeho překreslení.|
|[COleControl –:: InvalidateRgn](#invalidatergn)|Zruší platnost klientské oblasti okna kontejneru v rámci dané oblasti. Dá se použít k překreslení ovládacích prvků bez oken v oblasti.|
|[COleControl –:: IsConvertingVBX](#isconvertingvbx)|Umožňuje specializované načítání ovládacího prvku OLE.|
|[COleControl –::-Modified](#ismodified)|Určuje, zda došlo ke změně stavu ovládacího prvku.|
|[COleControl –:: IsOptimizedDraw](#isoptimizeddraw)|Určuje, zda kontejner podporuje optimalizované vykreslování pro aktuální operaci kreslení.|
|[COleControl –:: IsSubclassedControl](#issubclassedcontrol)|Volá se, aby se určilo, jestli ovládací prvek podtřídí ovládací prvek Windows.|
|[COleControl –:: Load](#load)|Obnoví všechna předchozí asynchronní data a inicializuje nové zatížení asynchronní vlastnosti ovládacího prvku.|
|[COleControl –:: LockInPlaceActive](#lockinplaceactive)|Určuje, zda může být ovládací prvek dezaktivován kontejnerem.|
|[COleControl –:: OnAmbientPropertyChange](#onambientpropertychange)|Volá se, když se změní ambientní vlastnost.|
|[COleControl –:: OnAppearanceChanged](#onappearancechanged)|Volá se, když se změní vlastnost vzhled akcie.|
|[COleControl –:: OnBackColorChanged](#onbackcolorchanged)|Volá se, když se změní vlastnost BackColor.|
|[COleControl –:: OnBorderStyleChanged](#onborderstylechanged)|Volá se při změně vlastnosti okraje s uloženým okrajem.|
|[COleControl –:: Click](#onclick)|Volá se, aby se aktivovala událost kliknutí na akcií.|
|[COleControl –::-Close](#onclose)|Oznamuje ovládacímu prvku, že byl volán `IOleControl::Close`.|
|[COleControl –:: OnDoVerb](#ondoverb)|Volá se po provedení příkazu ovládacího prvku.|
|[COleControl –:: Draw](#ondraw)|Volá se, když se požaduje ovládací prvek pro překreslení.|
|[COleControl –:: OnDrawMetafile](#ondrawmetafile)|Volá se kontejnerem, když se vyžaduje ovládací prvek pro překreslení pomocí kontextu zařízení metasouboru.|
|[COleControl –:: s úpravami](#onedit)|Volá se kontejnerem do uživatelského rozhraní, které aktivuje ovládací prvek OLE.|
|[COleControl –:: OnEnabledChanged](#onenabledchanged)|Volá se, když se změní vlastnost s povoleným zásobou.|
|[COleControl –:: OnEnumVerbs](#onenumverbs)|Volá se kontejnerem, aby se vytvořil výčet sloves ovládacího prvku.|
|[COleControl –:: OnEventAdvise](#oneventadvise)|Volá se, když jsou obslužné rutiny události připojené nebo odpojené od ovládacího prvku.|
|[COleControl –:: OnFontChanged](#onfontchanged)|Volá se při změně vlastnosti zásobed Font.|
|[COleControl –:: OnForeColorChanged](#onforecolorchanged)|Volá se při změně vlastnosti% ForeColor.|
|[COleControl –:: OnFreezeEvents](#onfreezeevents)|Volá se, když jsou události ovládacího prvku zmrazené nebo nezmrazené.|
|[COleControl –:: OnGetColorSet](#ongetcolorset)|Oznamuje ovládacímu prvku, že byl volán `IOleObject::GetColorSet`.|
|[COleControl –:: OnGetControlInfo](#ongetcontrolinfo)|Poskytuje symbolické informace kontejneru.|
|[COleControl –:: OnGetDisplayString](#ongetdisplaystring)|Volá se, aby se získal řetězec představující hodnotu vlastnosti.|
|[COleControl –:: OnGetInPlaceMenu](#ongetinplacemenu)|Vyžádá popisovač nabídky ovládacího prvku, který se sloučí s nabídkou kontejneru.|
|[COleControl –:: OnGetNaturalExtent](#ongetnaturalextent)|Přepište, aby se načetla velikost zobrazení ovládacího prvku, která je nejblíže navrhovaným režimům velikosti a rozsahu.|
|[COleControl –:: OnGetPredefinedStrings](#ongetpredefinedstrings)|Vrátí řetězce představující možné hodnoty pro vlastnost.|
|[COleControl –:: OnGetPredefinedValue](#ongetpredefinedvalue)|Vrátí hodnotu odpovídající předdefinovanému řetězci.|
|[COleControl –:: OnGetViewExtent](#ongetviewextent)|Přepište pro načtení velikosti zobrazovaných oblastí ovládacího prvku (lze použít k povolení oboustranného vykreslování).|
|[COleControl –:: OnGetViewRect](#ongetviewrect)|Přepište pro převedení velikosti ovládacího prvku na obdélník, který začíná na konkrétní pozici.|
|[COleControl –:: OnGetViewStatus](#ongetviewstatus)|Přepsáním načtěte stav zobrazení ovládacího prvku.|
|[COleControl –:: OnHideToolBars](#onhidetoolbars)|Volá se kontejnerem, když je ovládací prvek deaktivován z uživatelského rozhraní.|
|[COleControl –:: OnInactiveMouseMove](#oninactivemousemove)|Přepište, aby měl kontejner pro neaktivní ovládací prvek pod ukazatelem myši pro odeslání WM_MOUSEMOVE zpráv do ovládacího prvku.|
|[COleControl –:: OnInactiveSetCursor](#oninactivesetcursor)|Přepište, aby měl kontejner pro neaktivní ovládací prvek pod ukazatelem myši pro odeslání WM_SETCURSOR zpráv do ovládacího prvku.|
|[COleControl –:: OnKeyDownEvent](#onkeydownevent)|Volá se po vyvolání události zásobníku zásob.|
|[COleControl –:: OnKeyPressEvent](#onkeypressevent)|Volá se po tom, co se aktivuje událost KeyPress.|
|[COleControl –:: OnKeyUpEvent](#onkeyupevent)|Volá se po tom, co se vyvolala událost KeyUp KeyUp.|
|[COleControl –:: OnMapPropertyToPage](#onmappropertytopage)|Určuje, která stránka vlastností se má použít pro úpravu vlastnosti.|
|[COleControl –::-Symbolickéy](#onmnemonic)|Volá se, když se stiskne symbolický klíč ovládacího prvku.|
|[COleControl –::-Properties](#onproperties)|Volána, když byla vyvolána operace "Properties" ovládacího prvku.|
|[COleControl –:: OnQueryHitPoint](#onqueryhitpoint)|Přepište pro dotaz, zda se zobrazení ovládacího prvku překrývá s daným bodem.|
|[COleControl –:: OnQueryHitRect](#onqueryhitrect)|Přepište pro dotaz, zda se zobrazení ovládacího prvku překrývá s jakýmkoli bodem v daném obdélníku.|
|[COleControl –:: OnRenderData](#onrenderdata)|Volá se rozhraním, aby se načetla data v zadaném formátu.|
|[COleControl –:: OnRenderFileData](#onrenderfiledata)|Volá se rozhraním, aby se načetla data ze souboru v zadaném formátu.|
|[COleControl –:: OnRenderGlobalData](#onrenderglobaldata)|Volá se rozhraním, aby se načetla data z globální paměti v zadaném formátu.|
|[COleControl –:: OnResetState](#onresetstate)|Obnoví výchozí hodnoty vlastností ovládacího prvku.|
|[COleControl –:: OnSetClientSite](#onsetclientsite)|Oznamuje ovládacímu prvku, že byl volán `IOleControl::SetClientSite`.|
|[COleControl –::-SetData](#onsetdata)|Nahradí data ovládacího prvku jinou hodnotou.|
|[COleControl –:: OnSetExtent](#onsetextent)|Volá se po změně rozsahu ovládacího prvku.|
|[COleControl –:: OnSetObjectRects](#onsetobjectrects)|Volá se po změně dimenzí ovládacího prvku.|
|[COleControl –:: OnShowToolBars](#onshowtoolbars)|Volá se, když se aktivuje ovládací prvek v uživatelském rozhraní.|
|[COleControl –:: OnTextChanged.](#ontextchanged)|Volá se při změně vlastnosti uloženého textu nebo popisku.|
|[COleControl –:: OnWindowlessMessage](#onwindowlessmessage)|Zpracovává zprávy oken (kromě zpráv myši a klávesnic) pro ovládací prvky bez oken.|
|[COleControl –::P arentToClient](#parenttoclient)|Přeloží bod vzhledem k počátku kontejneru na bod vzhledem k počátku ovládacího prvku.|
|[COleControl –::P ostModalDialog](#postmodaldialog)|Upozorní kontejner, že modální dialogové okno bylo zavřeno.|
|[COleControl –::P reModalDialog](#premodaldialog)|Upozorní kontejner, že se chystá zobrazení modálního dialogového okna.|
|[COleControl –:: RecreateControlWindow](#recreatecontrolwindow)|Zničí a znovu vytvoří okno ovládacího prvku.|
|[COleControl –:: Refresh](#refresh)|Vynutí překreslení vzhledu ovládacího prvku.|
|[COleControl –:: ReleaseCapture](#releasecapture)|Uvolňuje zachycení myši.|
|[COleControl –:: ReleaseDC](#releasedc)|Uvolní kontext zobrazovaného zařízení kontejneru ovládacího prvku bez oken.|
|[COleControl –:: ReparentControlWindow](#reparentcontrolwindow)|Obnoví nadřazený ovládací prvek okna.|
|[COleControl –:: ResetStockProps](#resetstockprops)|Inicializuje výchozí hodnoty `COleControl` uložených vlastností.|
|[COleControl –:: ResetVersion](#resetversion)|Inicializuje číslo verze na danou hodnotu.|
|[COleControl –:: ScrollWindow](#scrollwindow)|Umožňuje ovládacímu prvku bez oken posouvání oblasti v rámci aktivního obrázku na místě zobrazení.|
|[COleControl –:: SelectFontObject](#selectfontobject)|Vybere vlastní vlastnost písma v kontextu zařízení.|
|[COleControl –:: SelectStockFont](#selectstockfont)|Vybere vlastnost písma zásob v kontextu zařízení.|
|[COleControl –:: SerializeExtent](#serializeextent)|Serializace nebo inicializuje prostor zobrazení ovládacího prvku.|
|[COleControl –:: SerializeStockProps](#serializestockprops)|Zaserializace nebo inicializuje vlastnosti `COleControl`ch uložených vlastností.|
|[COleControl –:: SerializeVersion](#serializeversion)|Serializace nebo inicializuje informace o verzi ovládacího prvku.|
|[COleControl –:: SetAppearance](#setappearance)|Nastaví hodnotu vlastnosti vzhled akcie.|
|[COleControl –:: SetBackColor](#setbackcolor)|Nastaví hodnotu vlastnosti rebarva pozadí.|
|[COleControl –:: SetBorderStyle](#setborderstyle)|Nastaví hodnotu vlastnosti BorderStyle pro doplňování.|
|[COleControl –:: SetCapture](#setcapture)|Způsobí, že okno kontejneru ovládacího prvku provede zachycení myši jménem ovládacího prvku.|
|[COleControl –:: SetControlSize](#setcontrolsize)|Nastaví pozici a velikost ovládacího prvku OLE.|
|[COleControl –:: SetEnabled](#setenabled)|Nastaví hodnotu vlastnosti enabled s povolenými zásobami.|
|[COleControl –:: SetFocus](#setfocus)|Způsobí, že okno kontejneru ovládacího prvku převezme fokus vstupu v zastoupení ovládacího prvku.|
|[COleControl –:: SetFont](#setfont)|Nastaví hodnotu vlastnosti burzovního písma.|
|[COleControl –:: SetForeColor](#setforecolor)|Nastaví hodnotu vlastnosti Barva popředí.|
|[COleControl –:: SetInitialSize](#setinitialsize)|Nastaví velikost ovládacího prvku OLE při prvním zobrazení v kontejneru.|
|[COleControl –:: SetModifiedFlag](#setmodifiedflag)|Změní upravený stav ovládacího prvku.|
|[COleControl –:: SetNotPermitted](#setnotpermitted)|Indikuje, že žádost o úpravu se nezdařila.|
|[COleControl –:: SetNotSupported](#setnotsupported)|Brání uživateli v úpravách hodnoty vlastnosti ovládacího prvku.|
|[COleControl –:: SetRectInContainer](#setrectincontainer)|Nastaví obdélník ovládacího prvku relativně k jeho kontejneru.|
|[COleControl –:: SetText](#settext)|Nastaví hodnotu vlastnosti burzovní text nebo titulek.|
|[COleControl –:: ThrowError](#throwerror)|Signalizuje, že došlo k chybě v ovládacím prvku OLE.|
|[COleControl –:: TransformCoords](#transformcoords)|Transformuje hodnoty souřadnic mezi kontejnerem a ovládacím prvkem.|
|[COleControl –:: TranslateColor](#translatecolor)|Převede hodnotu OLE_COLOR na hodnotu COLORREF.|
|[COleControl –:: WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Určuje, zda budou při příštím načtení ovládacího prvku k dispozici vlastnosti okolí.|
|[COleControl –:: WindowProc](#windowproc)|Poskytuje proceduru Windows pro objekt `COleControl`.|

### <a name="protected-methods"></a>Chráněné metody

|Název|Popis|
|----------|-----------------|
|[COleControl –::D rawContent](#drawcontent)|Volá se rozhraním, když je potřeba aktualizovat vzhled ovládacího prvku.|
|[COleControl –::D rawMetafile](#drawmetafile)|Volá se rozhraním, když se používá kontext zařízení Metafile.|
|[COleControl –:: IsInvokeAllowed](#isinvokeallowed)|Povoluje vyvolání metody automatizace.|
|[COleControl –:: SetInitialDataFormats](#setinitialdataformats)|Volá se rozhraním, aby se inicializoval seznam formátů dat, které ovládací prvek podporuje.|

## <a name="remarks"></a>Poznámky

Tato třída je odvozena od `CWnd`dědí všechny funkce objektu okna systému Windows a další funkce specifické pro OLE, jako je například vypálení událostí a schopnost podporovat metody a vlastnosti.

Ovládací prvky OLE lze vložit do aplikace typu kontejner OLE a komunikovat s kontejnerem pomocí obousměrného systému pro vyvolávání událostí a vystavení metod a vlastností kontejneru. Všimněte si, že standardní kontejnery OLE podporují pouze základní funkce ovládacího prvku OLE. Nemůžou podporovat rozšířené funkce ovládacího prvku OLE. K vyvolání události dojde, když jsou události odesílány do kontejneru v důsledku provedení určitých akcí v rámci ovládacího prvku. Kontejner pak komunikuje s ovládacím prvkem pomocí exponované sady metod a vlastností, které jsou podobné členským funkcím a datovým členům C++ třídy. Tento přístup umožňuje vývojáři řídit vzhled ovládacího prvku a upozorňovat kontejner, když dojde k určitým akcím.

## <a name="windowless-controls"></a>Ovládací prvky bez oken

Ovládací prvky OLE lze použít místně aktivní bez okna. Ovládací prvky bez oken mají významné výhody:

- Ovládací prvky bez oken můžou být transparentní a nepravoúhlé.

- Ovládací prvky bez oken zmenšují velikost instance a čas vytvoření objektu.

Ovládací prvky nepotřebují okno. Služby, které nabízí okno, lze snadno poskytnout prostřednictvím jediného sdíleného okna (obvykle kontejneru) a bitu pro odeslání kódu. V případě, že okno je většinou zbytečné komplikace na objektu.

Pokud se používá aktivace bez oken, je kontejner (který má okno) zodpovědný za poskytování služeb, které by jinak poskytoval vlastní okno ovládacího prvku. Například pokud váš ovládací prvek potřebuje zadat dotaz na fokus klávesnice, zadat dotaz na zachycení myši nebo získat kontext zařízení, tyto operace jsou spravovány kontejnerem. Členské funkce `COleControl` bez oken vyvolávají tyto operace na kontejneru.

Pokud je povolená aktivace bez oken, kontejner deleguje vstupní zprávy na rozhraní `IOleInPlaceObjectWindowless` ovládacího prvku (rozšíření [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) pro podporu bez oken). `COleControl`implementace tohoto rozhraní bude odesílat tyto zprávy přes mapu zpráv vašeho ovládacího prvku, a to tak, že se odpovídajícím způsobem upraví souřadnice myši. Tyto zprávy můžete zpracovat jako běžné zprávy o oknech přidáním odpovídajících položek do mapy zpráv.

V ovládacím prvku bez oken byste měli vždy použít `COleControl` členské funkce namísto odpovídajících `CWnd` členských funkcí nebo jejich souvisejících funkcí rozhraní Windows API.

Objekty ovládacího prvku OLE mohou také vytvořit okno pouze v případě, že se stanou aktivní, ale množství práce potřebné pro přechod neaktivní – aktivní přejde nahoru a rychlost přechodu skončí. Existují případy, kdy se jedná o problém: jako příklad můžete uvažovat o mřížce textových polí. Při přesunutí nahoru a dolů přes sloupec musí být každý ovládací prvek na místě aktivované a pak deaktivován. Rychlost neaktivního/aktivního přechodu ovlivní přímo rychlost posouvání.

Další informace o vývoji rozhraní ovládacího prvku OLE naleznete v článcích [ovládací prvky ActiveX knihovny MFC](../../mfc/mfc-activex-controls.md) a [Přehled: vytvoření programu ovládacího prvku ActiveX knihovny MFC](../../mfc/reference/mfc-activex-control-wizard.md). Informace o optimalizaci ovládacích prvků OLE, včetně ovládacích prvků bez oken a blikání, naleznete v tématu [MFC ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hierarchie dědičnosti

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Požadavky

**Záhlaví:** AFXCTL. h

##  <a name="ambientbackcolor"></a>COleControl –:: AmbientBackColor

Vrátí hodnotu vlastnosti ambiented BackColor.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Návratová hodnota

Aktuální hodnota vlastnosti okolní pozadí kontejneru, pokud existuje. Pokud vlastnost není podporována, vrátí tato funkce barvu pozadí definovanou systémem Windows.

### <a name="remarks"></a>Poznámky

Vlastnost Ambient BackColor je k dispozici pro všechny ovládací prvky a je definována kontejnerem. Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientdisplayname"></a>COleControl –:: AmbientDisplayName

Název, který se má kontejneru přiřadit k ovládacímu prvku, se dá použít v chybových zprávách zobrazených uživateli.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Návratová hodnota

Název ovládacího prvku OLE Výchozí hodnota je řetězec s nulovou délkou.

### <a name="remarks"></a>Poznámky

Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientfont"></a>COleControl –:: AmbientFont

Vrátí hodnotu vlastnosti okolního písma.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na rozhraní pro expedici písma v kontejneru. Výchozí hodnota je NULL. Pokud se vrácení nerovná hodnotě NULL, zodpovídáte za uvolnění písma voláním členské funkce [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) .

### <a name="remarks"></a>Poznámky

Vlastnost okolí písma je definována kontejnerem a je k dispozici pro všechny ovládací prvky. Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientforecolor"></a>COleControl –:: AmbientForeColor

Vrátí hodnotu vlastnosti okolního popředí.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Návratová hodnota

Aktuální hodnota vlastnosti okolního popředí kontejneru, pokud existuje. Pokud není podporováno, vrátí tato funkce textovou barvu definovanou systémem Windows.

### <a name="remarks"></a>Poznámky

Vlastnost Ambient ForeColor je k dispozici pro všechny ovládací prvky a je definována kontejnerem. Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientlocaleid"></a>COleControl –:: AmbientLocaleID

Vrátí ID národního prostředí kontejneru.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Návratová hodnota

Hodnota vlastnosti LocaleID kontejneru, pokud existuje. Pokud tato vlastnost není podporována, vrátí tato funkce 0.

### <a name="remarks"></a>Poznámky

Ovládací prvek může použít LocaleID k přizpůsobení uživatelského rozhraní pro konkrétní národní prostředí. Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientappearance"></a>COleControl –:: AmbientAppearance

Načte aktuální nastavení vzhledu pro objekt ovládacího prvku.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Návratová hodnota

Vzhled ovládacího prvku:

- **0** plochý vzhled

- **1** prostorový vzhled

### <a name="remarks"></a>Poznámky

Voláním této funkce načtete aktuální hodnotu vlastnosti DISPID_AMBIENT_APPEARANCE ovládacího prvku.

##  <a name="ambientscaleunits"></a>COleControl –:: AmbientScaleUnits

Vrátí typ jednotek používaných kontejnerem.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Návratová hodnota

Řetězec obsahující ambientní ScaleUnits kontejneru. Pokud tato vlastnost není podporována, vrátí tato funkce řetězec s nulovou délkou.

### <a name="remarks"></a>Poznámky

Vlastnost ScaleUnits kontejneru lze použít k zobrazení pozic nebo dimenzí s popiskem zvolené jednotky, jako je například twip nebo centimetry. Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientshowgrabhandles"></a>COleControl –:: AmbientShowGrabHandles

Určuje, zda kontejner umožňuje ovládacímu prvku zobrazit obslužné rutiny pro sebe samé, pokud je aktivní.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud by se měly zobrazit obslužné rutiny přidaných hodnot; v opačném případě 0. Pokud tato vlastnost není podporována, vrátí tato funkce nenulovou hodnotu.

### <a name="remarks"></a>Poznámky

Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientshowhatching"></a>COleControl –:: AmbientShowHatching

Určuje, zda kontejner umožňuje ovládacímu prvku, aby se při aktivním uživatelském rozhraní zobrazoval s šrafovaném vzorem.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud by měl být zobrazený vzorek šrafování; v opačném případě 0. Pokud tato vlastnost není podporována, vrátí tato funkce nenulovou hodnotu.

### <a name="remarks"></a>Poznámky

Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambienttextalign"></a>COleControl –:: AmbientTextAlign

Určuje zarovnání okolního textu preferované kontejnerem ovládacího prvku.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Návratová hodnota

Stav vlastnosti s okolním zarovnáním kontejneru. Pokud tato vlastnost není podporována, vrátí tato funkce 0.

Následuje seznam platných návratových hodnot:

|Návratová hodnota|Význam|
|------------------|-------------|
|0|Obecné zarovnání (čísla vpravo, text vlevo).|
|1|Zarovnat doleva|
|2|Střed|
|3|Zarovnat vpravo|

### <a name="remarks"></a>Poznámky

Tato vlastnost je k dispozici pro všechny vložené ovládací prvky a je definována kontejnerem. Všimněte si, že kontejner není vyžadován k podpoře této vlastnosti.

##  <a name="ambientuidead"></a>COleControl –:: AmbientUIDead

Určuje, zda kontejner chce ovládací prvek reagovat na akce uživatelského rozhraní.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud by měl ovládací prvek reagovat na akce uživatelského rozhraní; v opačném případě 0. Pokud tato vlastnost není podporována, vrátí tato funkce 0.

### <a name="remarks"></a>Poznámky

Kontejner může například nastavit hodnotu TRUE v režimu návrhu.

##  <a name="ambientusermode"></a>COleControl –:: AmbientUserMode

Určuje, zda je kontejner v režimu návrhu nebo v uživatelském režimu.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je kontejner v uživatelském režimu; v opačném případě 0 (v návrhovém režimu). Pokud tato vlastnost není podporována, vrátí tato funkce hodnotu TRUE.

### <a name="remarks"></a>Poznámky

Kontejner může například nastavit hodnotu FALSE v režimu návrhu.

##  <a name="boundpropertychanged"></a>COleControl –:: BoundPropertyChanged

Signalizuje, že hodnota vázané vlastnosti se změnila.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
ID odeslání vázané vlastnosti ovládacího prvku.

### <a name="remarks"></a>Poznámky

Tato hodnota musí být volána pokaždé, když se změní hodnota vlastnosti, a to i v případech, kdy změna nebyla provedena prostřednictvím metody set vlastnosti. Buďte obzvláště vědomi vlastností vazeb, které jsou namapovány na členské proměnné. Při každé změně takové členské proměnné `BoundPropertyChanged` nutné volat.

##  <a name="boundpropertyrequestedit"></a>COleControl –:: BoundPropertyRequestEdit

Požaduje oprávnění z rozhraní `IPropertyNotifySink` pro změnu hodnoty vázané vlastnosti poskytované ovládacím prvkem.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
ID odeslání vázané vlastnosti ovládacího prvku.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je změna povolena; v opačném případě 0. Výchozí hodnota je nenulová.

### <a name="remarks"></a>Poznámky

Pokud je oprávnění odepřeno, ovládací prvek nesmí umožnit hodnotu změny vlastnosti. To lze provést ignorováním nebo selháním akce, která se pokusila změnit hodnotu vlastnosti.

##  <a name="clienttoparent"></a>COleControl –:: ClientToParent

Přeloží souřadnice *pPoint* do nadřazených souřadnic.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Ukazatel na hranice ovládacího prvku OLE v rámci kontejneru. Ne klientská oblast, ale oblast celého ovládacího prvku, včetně ohraničení a posuvníků.

*pPoint*<br/>
Ukazatel na bod oblasti klienta OLE, který se má přeložit do souřadnic nadřazeného objektu (kontejneru).

### <a name="remarks"></a>Poznámky

Vstupní *pPoint* je relativní vzhledem k počátku klientské oblasti ovládacího prvku OLE (levý horní roh oblasti klienta ovládacího prvku). Výstup *pPoint* je relativní vzhledem k počátku nadřazeného objektu (v levém horním rohu kontejneru).

##  <a name="clipcaretrect"></a>COleControl –:: ClipCaretRect

Upraví obdélník blikajícího kurzoru, pokud je zcela nebo částečně pokrytý překrývajícími se neprůhledné objekty.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
U vstupu ukazatel na strukturu [Rect](/windows/win32/api/windef/ns-windef-rect) obsahující oblast blikajícího kurzoru, která se má upravit. Pro výstup, upravenou oblast stříšky nebo hodnotu NULL, pokud je obdélník blikajícího kurzoru zcela pokrytý.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Blikající kurzor je blikající čára, blok nebo rastrový obrázek, který obvykle indikuje, kde budou vloženy texty nebo grafiky.

Objekt bez oken nemůže bezpečně zobrazit blikající kurzor bez prvotní kontroly, zda je blikající kurzor částečně nebo zcela skrytý překrývajícími se objekty. Aby to bylo možné, může objekt pomocí `ClipCaretRect` získat upravený blikající kurzor (zmenšen) a zajistit tak jeho umístění v oblasti oříznutí.

Objekty, které vytvářejí stříšku, by měly odeslat obdélník blikajícího kurzoru, aby `ClipCaretRect` a používaly pro něj upravený obdélník. Pokud je blikající kurzor zcela skrytý, vrátí tato metoda hodnotu FALSE a kurzor by neměl být v tomto případě zobrazen vůbec.

##  <a name="colecontrol"></a>COleControl –:: COleControl –

Vytvoří objekt `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Poznámky

Tato funkce se obvykle nevolá přímo. Místo toho je ovládací prvek OLE většinou vytvořen jeho objektem pro vytváření tříd.

##  <a name="controlinfochanged"></a>COleControl –:: ControlInfoChanged

Tuto funkci volejte, pokud se změní sada instrukcí, které ovládací prvek podporuje.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Poznámky

Po přijetí tohoto oznámení kontejner ovládacího prvku získá novou sadu instrukcí voláním metody [IOleControl:: GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Všimněte si, že kontejner není vyžadován k reakci na toto oznámení.

##  <a name="displayerror"></a>COleControl –::D isplayError

Volá se rozhraním po zpracování chybové události akcie (Pokud obslužná rutina události potlačila zobrazení chyby).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parametry

*Code*<br/>
Hodnota stavového kódu, který se má ohlásit Úplný seznam možných kódů naleznete v článku [ovládací prvky ActiveX: Pokročilá témata](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Popis chyby, která je hlášena.

*lpszSource*<br/>
Název modulu, který generuje chybu (obvykle název modulu ovládacího prvku OLE).

*lpszHelpFile*<br/>
Název souboru Help obsahujícího popis chyby

*nHelpID*<br/>
ID kontextové zprávy o chybě, která je hlášena.

### <a name="remarks"></a>Poznámky

Výchozí chování zobrazí okno se zprávou obsahující popis chyby, která je obsažena v *lpszDescription*.

Potlačením této funkce upravíte způsob zobrazení chyb.

##  <a name="doclick"></a>COleControl –::D oClick

Simuluje akci kliknutí myší na ovládací prvek.

```
void DoClick();
```

### <a name="remarks"></a>Poznámky

Bude volána přepisovatelný `COleControl::OnClick` členská funkce a událost kliknutí na akcií bude vyvolána, pokud je podporována ovládacím prvkem.

Tato funkce je podporována `COleControl` základní třídou jako uloženou metodou s názvem DoClick. Další informace naleznete v článku [ovládací prvky ActiveX: metody](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>COleControl –::D oPropExchange

Volá se rozhraním při načítání nebo ukládání ovládacího prvku z trvalé reprezentace úložiště, jako je například datový proud nebo sada vlastností.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na objekt `CPropExchange`. Rozhraní poskytuje tento objekt pro vytvoření kontextu výměny vlastností, včetně jeho směru.

### <a name="remarks"></a>Poznámky

Tato funkce obvykle volá **PX_** rodině funkcí k načtení nebo uložení specifických vlastností definovaných uživatelem ovládacího prvku OLE.

Pokud byl Průvodce ovládacím prvkem použit k vytvoření projektu ovládacího prvku OLE, přepsaná verze této funkce provede serializaci uložených vlastností, které jsou podporovány `COleControl` voláním funkce základní třídy `COleControl::DoPropExchange`. Při přidávání uživatelsky definovaných vlastností do ovládacího prvku OLE budete muset tuto funkci upravit, aby se vaše nové vlastnosti serializovány. Další informace o serializaci naleznete v článku [ovládací prvky ActiveX: serializace](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>COleControl –::D oSuperclassPaint

Překreslí ovládací prvek OLE, který byl podtřídou z ovládacího prvku Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Ukazatel na kontext zařízení kontejneru ovládacího prvku.

*rcBounds*<br/>
Oblast, ve které se má ovládací prvek vykreslovat

### <a name="remarks"></a>Poznámky

Voláním této funkce zajistíte správné zpracování vykreslování neaktivního ovládacího prvku OLE. Tato funkce by měla být použita pouze v případě, že podtřídy ovládacího prvku OLE řídí ovládací prvek systému Windows a měl by být volána ve funkci `OnDraw` ovládacího prvku.

Další informace o této funkci a podtřídění ovládacího prvku systému Windows naleznete v článku [ovládací prvky ActiveX: podtřídy ovládacího prvku systému Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>COleControl –::D rawContent

Volá se rozhraním, když je potřeba aktualizovat vzhled ovládacího prvku.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Ukazatel na kontext zařízení.

*RC*<br/>
Obdélníková oblast, která se má vykreslit.

### <a name="remarks"></a>Poznámky

Tato funkce přímo volá přepsatelné `OnDraw` funkce.

##  <a name="drawmetafile"></a>COleControl –::D rawMetafile

Volá se rozhraním, když se používá kontext zařízení Metafile.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Ukazatel na kontext zařízení Metafile.

*RC*<br/>
Obdélníková oblast, která se má vykreslit.

##  <a name="enablesimpleframe"></a>COleControl –:: EnableSimpleFrame

Povoluje vlastnost jednoduchého rámce pro ovládací prvek OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Poznámky

Tato vlastnost umožňuje ovládacímu prvku podporovat vizuální zahrnutí jiných ovládacích prvků, ale ne omezení technologie OLE. Příkladem může být skupinový rámeček s několika ovládacími prvky v rámci. Tyto ovládací prvky nejsou obsažené v OLE, ale jsou ve stejném skupinovém poli.

##  <a name="exchangeextent"></a>COleControl –:: ExchangeExtent

Serializace nebo inicializuje stav rozsahu ovládacího prvku (jeho rozměry v jednotkách HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na objekt [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Rozhraní poskytuje tento objekt pro vytvoření kontextu výměny vlastností, včetně jeho směru.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je funkce úspěšná; 0, jinak.

### <a name="remarks"></a>Poznámky

Tato funkce je obvykle volána výchozí implementací `COleControl::DoPropExchange`.

##  <a name="exchangestockprops"></a>COleControl –:: ExchangeStockProps

Serializace nebo inicializuje stav vlastností akcií ovládacího prvku.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na objekt [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Rozhraní poskytuje tento objekt pro vytvoření kontextu výměny vlastností, včetně jeho směru.

### <a name="remarks"></a>Poznámky

Tato funkce je obvykle volána výchozí implementací `COleControl::DoPropExchange`.

##  <a name="exchangeversion"></a>COleControl –:: ExchangeVersion

Serializace nebo inicializuje stav informací o verzi ovládacího prvku.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Ukazatel na objekt `CPropExchange`. Rozhraní poskytuje tento objekt pro vytvoření kontextu výměny vlastností, včetně jeho směru.

*dwVersionDefault*<br/>
Aktuální číslo verze ovládacího prvku.

*bConvert*<br/>
Určuje, zda mají být trvalá data při uložení převedena do nejnovějšího formátu nebo udržována ve stejném formátu, který byl načten.

### <a name="return-value"></a>Návratová hodnota

Nenulová hodnota funkce byla úspěšná; 0, jinak.

### <a name="remarks"></a>Poznámky

Obvykle se jedná o první funkci volanou přepsáním `COleControl::DoPropExchange`ovládacího prvku. Při načítání Tato funkce přečte číslo verze trvalých dat a odpovídajícím způsobem nastaví atribut verze objektu [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Při ukládání Tato funkce zapisuje číslo verze trvalých dat.

Další informace o persistenci a správy verzí naleznete v článku [ovládací prvky ActiveX: serializace](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>COleControl –:: FireClick

Volá se rozhraním, když se na ukazatel myši klikne přes aktivní ovládací prvek.

```
void FireClick();
```

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Pro automatické vyvolávání události Click musí mít mapa událostí ovládacího prvku nadefinovanou událost kliknutí na akci.

##  <a name="firedblclick"></a>COleControl –:: FireDblClick

Volá se rozhraním, když se na ukazateli myši pokliká přes aktivní ovládací prvek.

```
void FireDblClick();
```

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Aby došlo k automatickému vyvolávání události DblClick, musí mít mapa událostí ovládacího prvku nadefinovanou uloženou událost DblClick.

##  <a name="fireerror"></a>COleControl –:: FireError –

Aktivuje chybovou událost akcie.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*Code*<br/>
Hodnota stavového kódu, který se má ohlásit Úplný seznam možných kódů naleznete v článku [ovládací prvky ActiveX: Pokročilá témata](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Popis chyby, která je hlášena.

*nHelpID*<br/>
ID, které je hlášené k chybě.

### <a name="remarks"></a>Poznámky

Tato událost poskytuje způsob signalizace na vhodných místech v kódu, na kterých došlo k chybě v rámci vašeho ovládacího prvku. Na rozdíl od jiných uložených událostí, jako je například Click nebo MouseMove, není chyba nikdy aktivována rozhraním.

Chcete-li ohlásit chybu, ke které dojde během funkce Get vlastnosti, funkce set vlastnosti nebo metody automatizace, zavolejte na [COleControl –:: ThrowError](#throwerror).

Implementace události skladové chyby ovládacího prvku OLE používá hodnotu Code. Pokud váš ovládací prvek používá tuto událost a je určen k použití v Visual Basic 4,0, zobrazí se chyby, protože hodnota Code není v Visual Basic podporována.

Chcete-li tento problém vyřešit, ručně změňte parametr Code v ovládacím prvku. Soubor ODL na **dlouhou dobu**. Kromě toho jakákoli vlastní událost, metoda nebo vlastnost, která používá parametr Code, také způsobuje stejný problém.

##  <a name="fireevent"></a>COleControl –:: FireEvent

Aktivuje uživatelsky definovanou událost z ovládacího prvku s libovolným počtem volitelných argumentů.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
ID odeslání události, která má být aktivována.

*pbParams*<br/>
Popisovač pro typy parametrů události.

### <a name="remarks"></a>Poznámky

Obvykle by tato funkce neměla být volána přímo. Místo toho zavoláte funkce pro spouštění událostí v části mapa události v deklaraci třídy vašeho ovládacího prvku.

Argument *pbParams* je seznam oddělený mezerami **VTS_** . Jedna nebo více těchto hodnot oddělených mezerami (nejedná se o čárky), určuje seznam parametrů funkce. Možné hodnoty jsou následující:

|Písmeno|Typ parametru|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Pro všechny typy variant byly definovány další konstanty variant s výjimkou VTS_FONT a VTS_PICTURE, které poskytují ukazatel na konstantu dat variant. Tyto konstanty jsou pojmenovány pomocí **VTS_P**`constantname` konvence. Například VTS_PCOLOR je ukazatel na konstantu VTS_COLOR.

##  <a name="firekeydown"></a>COleControl –:: FireKeyDown

Volá se rozhraním, když se stiskne klávesa, když je ovládací prvek aktivní uživatelského rozhraní.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Ukazatel na hodnotu kódu virtuálního klíče stisknuté klávesy. Seznam standardních kódů virtuálních klíčů naleznete v tématu Winuser. h.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK stisknutí klávesy SHIFT během akce.

- CTRL_MASK stisknutí klávesy CTRL během akce.

- ALT_MASK stisknutí klávesy ALT během akce.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Pro automatické vyvolávání události KeyDown musí být mapa událostí ovládacího prvku definována jako událost skladové události.

##  <a name="firekeypress"></a>COleControl –:: FireKeyPress

Volá se rozhraním, když se stiskne a uvolní klíč, zatímco vlastní ovládací prvek je v rámci kontejneru aktivní.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Ukazatel na hodnotu znaku stisknuté klávesy.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Příjemce události může upravit *pnChar*, například převést všechna malá písmena na velká. Pokud chcete ověřit upravený znak, přepište `OnKeyPressEvent`.

Aby došlo k automatickému vyvolávání události KeyPress, musí mít mapa události ovládacího prvku definovanou událost stisknutí.

##  <a name="firekeyup"></a>COleControl –:: FireKeyUp

Volá se rozhraním, když se uvolní klíč, zatímco vlastní ovládací prvek je v rámci kontejneru aktivní.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Ukazatel na hodnotu kódu virtuálního klíče pro vydaný klíč. Seznam standardních kódů virtuálních klíčů naleznete v tématu Winuser. h.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK stisknutí klávesy SHIFT během akce.

- CTRL_MASK stisknutí klávesy CTRL během akce.

- ALT_MASK stisknutí klávesy ALT během akce.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Pro automatické vyvolávání události KeyUp musí být mapa událostí ovládacího prvku definována jako definovaná událost KeyUp.

##  <a name="firemousedown"></a>COleControl –:: FireMouseDown

Volá se rozhraním, když se na aktivním vlastním ovládacím prvku stiskne tlačítko myši.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nNový*<br/>
Číselná hodnota stisknutého tlačítka myši Může obsahovat jednu z následujících hodnot:

- LEFT_BUTTON stisknutí levého tlačítka myši.

- MIDDLE_BUTTON se stisklo prostřední tlačítko myši.

- RIGHT_BUTTON stisknutí pravého tlačítka myši.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK stisknutí klávesy SHIFT během akce.

- CTRL_MASK stisknutí klávesy CTRL během akce.

- ALT_MASK stisknutí klávesy ALT během akce.

*znak*<br/>
Souřadnice x kurzoru při stisknutí tlačítka myši Souřadnice jsou relativní vzhledem k levému hornímu rohu okna ovládacího prvku.

*požadované*<br/>
Souřadnice y kurzoru při stisknutí tlačítka myši Souřadnice jsou relativní vzhledem k levému hornímu rohu okna ovládacího prvku.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Aby došlo k automatickému vyvolávání události MouseDown, musí mít mapa událostí ovládacího prvku nadefinovanou uloženou událost MouseDown.

##  <a name="firemousemove"></a>COleControl –:: FireMouseMove

Volá se rozhraním, když se kurzor přesune přes aktivní vlastní ovládací prvek.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nNový*<br/>
Číselná hodnota stisknutých tlačítek myši Obsahuje kombinaci následujících hodnot:

- LEFT_BUTTON levé tlačítko myši bylo během akce stisknuto.

- MIDDLE_BUTTON prostřední tlačítko myši bylo během akce stisknuto.

- RIGHT_BUTTON stisknutí pravého tlačítka myši v průběhu akce.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK stisknutí klávesy SHIFT během akce.

- CTRL_MASK stisknutí klávesy CTRL během akce.

- ALT_MASK stisknutí klávesy ALT během akce.

*znak*<br/>
Souřadnice x kurzoru Souřadnice jsou relativní vzhledem k levému hornímu rohu okna ovládacího prvku.

*požadované*<br/>
Souřadnice y kurzoru Souřadnice jsou relativní vzhledem k levému hornímu rohu okna ovládacího prvku.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Aby došlo k automatickému vyvolávání události MouseMove, musí mít mapa událostí ovládacího prvku nadefinovanou neuloženou událost MouseMove.

##  <a name="firemouseup"></a>COleControl –:: FireMouseUp

Volá se rozhraním, když se uvolní tlačítko myši nad aktivním vlastním ovládacím prvkem.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nNový*<br/>
Číselná hodnota tlačítka myši uvolněno. Může mít jednu z následujících hodnot:

- LEFT_BUTTON bylo uvolněno levé tlačítko myši.

- MIDDLE_BUTTON bylo uvolněno prostřední tlačítko myši.

- RIGHT_BUTTON bylo uvolněno pravé tlačítko myši.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK stisknutí klávesy SHIFT během akce.

- CTRL_MASK stisknutí klávesy CTRL během akce.

- ALT_MASK stisknutí klávesy ALT během akce.

*znak*<br/>
Souřadnice x kurzoru při uvolnění tlačítka myši Souřadnice jsou relativní vzhledem k levému hornímu rohu okna ovládacího prvku.

*požadované*<br/>
Souřadnice y kurzoru při uvolnění tlačítka myši Souřadnice jsou relativní vzhledem k levému hornímu rohu okna ovládacího prvku.

### <a name="remarks"></a>Poznámky

Pokud je tato událost definovaná jako vlastní událost, určíte, kdy se událost aktivuje.

Aby došlo k automatickému vyvolávání události MouseUp, musí mít mapa událostí ovládacího prvku nadefinovanou uloženou událost MouseUp.

##  <a name="firereadystatechange"></a>COleControl –:: FireReadyStateChange

Aktivuje událost s aktuální hodnotou stavu ovládacího prvku připraveno.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Poznámky

Stav připraveno může být jedna z následujících hodnot:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Výchozí stav inicializace|
|READYSTATE_LOADING|Ovládací prvek aktuálně načítá jeho vlastnosti.|
|READYSTATE_LOADED|Ovládací prvek byl inicializován|
|READYSTATE_INTERACTIVE|Ovládací prvek má dostatek dat pro interaktivní, ale ne všechna asynchronní data jsou ještě načtena.|
|READYSTATE_COMPLETE|Ovládací prvek má všechna jeho data|

Pomocí [GetReadyState](#getreadystate) určete aktuální připravenost ovládacího prvku.

[Funkci InternalSetReadyState](#internalsetreadystate) změní stav připraveno na poskytnutou hodnotu a potom zavolá `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>COleControl –:: GetActivationPolicy

Mění výchozí chování aktivace ovládacího prvku, který podporuje rozhraní `IPointerInactive`.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Návratová hodnota

Kombinace příznaků z výčtu POINTERINACTIVE. Možné příznaky:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Objekt by měl být na místě aktivovaný, když ho ukazatel myši vloží během operace přesunutí myši.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Objekt by měl být dezaktivován, pokud ukazatel myši opustí objekt během operace přesunutí myši.|
|POINTERINACTIVE_ACTIVATEONDRAG|Objekt by měl být umístěn na místě aktivované, když je ukazatel myši během operace přetažení přetažen myší.|

### <a name="remarks"></a>Poznámky

Když je povoleno rozhraní `IPointerInactive`, kontejner bude delegovat WM_SETCURSOR a WM_MOUSEMOVE zprávy. `COleControl`implementace tohoto rozhraní bude odesílat tyto zprávy přes mapu zpráv vašeho ovládacího prvku, a to tak, že se odpovídajícím způsobem upraví souřadnice myši.

Pokaždé, když kontejner obdrží WM_SETCURSOR nebo WM_MOUSEMOVE zprávu s ukazatelem myši nad neaktivním objektem podporujícím `IPointerInactive`, měl by volat `GetActivationPolicy` na rozhraní a vracet příznaky z výčtu POINTERINACTIVE.

Tyto zprávy můžete zpracovat stejně jako běžné zprávy okna tím, že přidáte odpovídající položky do mapy zpráv. V obslužných rutinách nepoužívejte členskou proměnnou `m_hWnd` (nebo jakékoli členské funkce, které ji používají) bez prvotní kontroly, zda její hodnota je jiná než NULL.

Libovolný objekt, který má dělat více než nastavit ukazatel myši nebo vyvolat událost přesunutí myši, jako je například poskytnutí speciální vizuální zpětné vazby, by měl vrátit příznak POINTERINACTIVE_ACTIVATEONENTRY a vykreslit zpětnou vazbu pouze v případě, že je aktivní. Pokud objekt vrátí tento příznak, kontejner by měl okamžitě aktivovat místní a pak přeslat stejnou zprávu, která aktivovala volání `GetActivationPolicy`.

Pokud jsou vraceny příznaky POINTERINACTIVE_ACTIVATEONENTRY i POINTERINACTIVE_DEACTIVATEONLEAVE, bude objekt aktivován pouze v případě, že je ukazatel myši nad objektem. Je-li vrácen pouze příznak POINTERINACTIVE_ACTIVATEONENTRY, bude objekt aktivován pouze jednou při prvním vložení myši do objektu.

Můžete také chtít, aby neaktivní ovládací prvek byl cílem operace přetažení OLE. To vyžaduje aktivaci ovládacího prvku v okamžiku, kdy uživatel přetahuje objekt na něj, aby bylo možné zaregistrovat okno ovládacího prvku jako cíl přetažení. Pokud chcete, aby během tažení došlo k aktivaci, vraťte příznak POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Informace, které sděluje `GetActivationPolicy`, by neměly ukládat do mezipaměti kontejnerem. Místo toho by měla být tato metoda volána pokaždé, když ukazatel myši přejde do neaktivního objektu.

Pokud neaktivní objekt nepožaduje místní aktivaci, když ho myš dokončí, měl by jeho kontejner odeslat následné WM_SETCURSOR zprávy do tohoto objektu voláním [OnInactiveSetCursor](#oninactivesetcursor) , dokud ukazatel myši zůstane nad objektem.

Povolení rozhraní `IPointerInactive` obvykle znamená, že chcete, aby byl ovládací prvek schopný zpracovávat zprávy myši. Chcete-li získat toto chování v kontejneru, který nepodporuje rozhraní `IPointerInactive`, budete muset mít ovládací prvek vždycky aktivovaný, pokud je viditelný, což znamená, že ovládací prvek by měl mít příznak OLEMISC_ACTIVATEWHENVISIBLE mezi jeho různými příznaky. Pokud ale chcete zabránit tomu, aby se tento příznak projevil v kontejneru, který podporuje `IPointerInactive`, můžete také zadat příznak OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>COleControl –:: GetAmbientProperty

Získá hodnotu ambientní vlastnosti kontejneru.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parametry

*dwDispid*<br/>
ID odeslání požadované vnější vlastnosti.

*vtProp*<br/>
Variantní typ značky, který určuje typ hodnoty, která se má vrátit v *pvProp*.

*pvProp*<br/>
Ukazatel na adresu proměnné, která bude přijímat hodnotu vlastnosti nebo návratovou hodnotu. Skutečný typ tohoto ukazatele musí odpovídat typu zadanému parametrem *vtProp*.

|vtProp|Typ pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je vlastnost ambientd podporována; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Pokud použijete `GetAmbientProperty` k načtení vlastností Ambient DisplayName a ScaleUnits, nastavte *vtProp* na VT_BSTR a *pvProp* na `CString*`. Pokud načítáte vlastnost okolí písma, nastavte *vtProp* na VT_FONT a *pvProp* na LPFONTDISP *.

Všimněte si, že funkce již byly k dispozici pro běžné ambientní vlastnosti, jako jsou [AmbientBackColor](#ambientbackcolor) a [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>COleControl –:: Get– zobrazení

Implementuje funkci get vlastnosti vzhledu akcií ovládacího prvku.

```
short GetAppearance ();
```

### <a name="return-value"></a>Návratová hodnota

Návratová hodnota určuje aktuální nastavení vzhledu jako **krátkou** (VT_I2) hodnotu, pokud je úspěšná. Tato hodnota je nula, pokud je vzhled ovládacího prvku plochý a 1, pokud je vzhled ovládacího prvku 3D.

##  <a name="getbackcolor"></a>COleControl –:: GetBackColor

Implementuje funkci get pro základní vlastnost BackColor ovládacího prvku.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Návratová hodnota

Návratová hodnota určuje aktuální barvu pozadí jako hodnotu OLE_COLOR, pokud byla úspěšná. Tuto hodnotu lze přeložit na hodnotu COLORREF voláním `TranslateColor`.

##  <a name="getborderstyle"></a>COleControl –:: getborderstyle

Implementuje funkci get pro burzovní vlastnost BorderStyle ovládacího prvku.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Návratová hodnota

1, pokud má ovládací prvek normální ohraničení; 0, pokud ovládací prvek nemá ohraničení.

##  <a name="getcapture"></a>COleControl –:: getcapture

Určuje, zda objekt `COleControl` má zachycení myši.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Návratová hodnota

Pokud je ovládací prvek aktivován a bez okna, vrátí **tuto** hodnotu, pokud ovládací prvek aktuálně má zachycení myši (jak je určeno kontejnerem ovládacího prvku), nebo hodnotu null, pokud nemá zachycení.

V opačném případě vrátí objekt `CWnd`, který má zachycení myši (totéž jako `CWnd::GetCapture`).

### <a name="remarks"></a>Poznámky

Aktivovaný ovládací prvek bez oken obdrží při volání [SetCapture](#setcapture) , zachycení myši.

##  <a name="getclassid"></a>COleControl –:: GetClassID

Volá se rozhraním, aby se načetlo ID třídy OLE ovládacího prvku.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parametry

*pclsid*<br/>
Ukazatel na umístění ID třídy.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud volání nebylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Obvykle je implementována [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>COleControl –:: GetClientOffset

Načte rozdíl mezi levým horním rohem obdélníkové oblasti ovládacího prvku a levým horním rohem jeho klientské oblasti.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parametry

*pdxOffset*<br/>
Ukazatel na vodorovný posun klientské oblasti ovládacího prvku OLE.

*pdyOffset*<br/>
Ukazatel na svislé posunutí klientské oblasti ovládacího prvku OLE.

### <a name="remarks"></a>Poznámky

Ovládací prvek OLE má v kontejneru obdélníkovou oblast. Klientská oblast ovládacího prvku je ovládací oblast, která vylučuje ohraničení a posuvníky. Posun načtený pomocí `GetClientOffset` je rozdíl mezi levým horním rohem obdélníkové oblasti ovládacího prvku a levým horním rohem jeho klientské oblasti. Pokud má váš ovládací prvek jiné než klientské prvky než standardní ohraničení a posuvníky, přepište tuto členskou funkci, aby určovala posun.

##  <a name="getclientrect"></a>COleControl –:: GetClientRect

Načte velikost klientské oblasti ovládacího prvku.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na `RECT`ovou strukturu obsahující rozměry klientské oblasti ovládacího prvku bez oken; To znamená, že velikost ovládacího prvku mínus ohraničení oken, rámečky, posuvníky atd. Parametr *lpRect* určuje velikost obdélníku klienta ovládacího prvku, nikoli jeho umístění.

##  <a name="getclientsite"></a>COleControl –:: GetClientSite

Zadá dotaz na objekt pro ukazatel na jeho aktuální klientský server v rámci svého kontejneru.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na aktuální klientský web ovládacího prvku ve svém kontejneru.

### <a name="remarks"></a>Poznámky

Vrácený ukazatel ukazuje na instanci `IOleClientSite`. Rozhraní `IOleClientSite` implementované kontejnery, je zobrazením kontextu objektu jeho kontextu: kde je ukotven v dokumentu, kde se nachází jeho úložiště, uživatelské rozhraní a další prostředky.

##  <a name="getcontrolflags"></a>COleControl –:: GetControlFlags

Načte nastavení příznaku ovládacího prvku.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Návratová hodnota

ORed kombinace příznaků ve výčtu ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Poznámky

Ve výchozím nastavení `GetControlFlags` vrátí `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Je-li nastaveno, používá funkci Begin-Paint přizpůsobenou ovládacím prvkům OLE namísto rozhraní [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API (nastaveno ve výchozím nastavení).|
|`clipPaintDC`|Pokud není nastavené, zakáže volání `IntersectClipRect` vytvořeného pomocí `COleControl` a získá malou výhodu. Pokud používáte aktivaci bez oken, příznak nemá žádný vliv.|
|`pointerInactive`|Pokud je nastaveno, poskytuje interakci myši, pokud je ovládací prvek neaktivní, povolením implementace `COleControl`rozhraní `IPointerInactive`, které je ve výchozím nastavení zakázáno.|
|`noFlickerActivate`|Pokud nastavíte, eliminují se nadbytečné operace kreslení a doprovodné vizuální blikání. Použijte v případě, že se ovládací prvek v neaktivních a aktivních stavech přesně nakreslí. Pokud používáte aktivaci bez oken, příznak nemá žádný vliv.|
|`windowlessActivate`|Pokud je nastaveno, znamená to, že ovládací prvek používá aktivaci bez oken.|
|`canOptimizeDraw`|Pokud je nastaveno, označuje, že ovládací prvek provede optimalizované vykreslování, pokud ho kontejner podporuje.|

Další informace o `GetControlFlags` a dalších optimalizacích ovládacích prvků OLE naleznete v tématu [ovládací prvky ActiveX: optimalizace](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>COleControl –:: GetControlSize

Načte velikost okna ovládacího prvku OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parametry

*formátu*<br/>
Určuje šířku ovládacího prvku v pixelech.

*pcy*<br/>
Určuje výšku ovládacího prvku v pixelech.

### <a name="remarks"></a>Poznámky

Všimněte si, že všechny souřadnice pro okna ovládacích prvků jsou relativní vzhledem k levému hornímu rohu ovládacího prvku.

##  <a name="getdc"></a>COleControl –:: GetDC

Poskytuje pro objekt bez oken pro získání kontextu obrazovky (nebo kompatibilního) zařízení z jeho kontejneru.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parametry

*lprcRect*<br/>
Ukazatel na obdélník, který se bude řídit ovládacím prvkem bez oken, se chce znovu kreslit v souřadnicích klienta ovládacího prvku. Hodnota NULL znamená rozsah celého objektu.

*dwFlags*<br/>
Atributy kreslení kontextu zařízení Možnosti:

- OLEDC_NODRAW označuje, že objekt nebude používat kontext zařízení k provádění jakýchkoli kreseb, ale pouze k získání informací o zobrazovacím zařízení. Kontejner by měl jednoduše předat řadič domény okna bez dalšího zpracování.

- OLEDC_PAINTBKGND vyžaduje, aby kontejner vybarví pozadí před vrácením řadiče domény. Objekt by měl používat tento příznak, pokud požaduje řadič domény pro překreslení oblasti s průhledným pozadím.

- OLEDC_OFFSCREEN informuje kontejner o tom, že se objekt chce vykreslit do rastrového obrázku mimo obrazovku, který by se měl zkopírovat na obrazovku. Objekt by měl používat tento příznak, pokud operace vykreslování, která má být provedena, generuje hodně blikání. Kontejner je bezplatný pro přijetí této žádosti nebo ne. Pokud však tento příznak není nastaven, kontejner musí předat záložní řadič domény na obrazovce. To umožňuje, aby objekty prováděly přímé operace obrazovky, jako je například zobrazení výběru (prostřednictvím operace **XOR** ).

### <a name="return-value"></a>Návratová hodnota

Ukazatel na zobrazovací kontext zařízení pro kontejner `CWnd` klientské oblasti, pokud bylo úspěšné. v opačném případě návratová hodnota má hodnotu NULL. Kontext zobrazovaného zařízení se dá použít v dalších funkcích GDI k vykreslování v klientské oblasti okna kontejneru.

### <a name="remarks"></a>Poznámky

Aby bylo možné uvolnit kontext po malování, je nutné volat členskou funkci [ReleaseDC](#releasedc) . Při volání `GetDC`objekty předávají obdélník, ve kterém chtějí kreslit do vlastních souřadnic klienta. `GetDC` je přeloží na souřadnice klientské oblasti kontejneru. Objekt by neměl vyžadovat požadovaný nakreslený obdélník větší než jeho vlastní rámeček oblasti klienta, velikost, kterou lze načíst pomocí [GetClientRect](#getclientrect). To brání v neúmyslném vykreslování objektů, kde se nepředpokládá.

##  <a name="getenabled"></a>COleControl –:: getenable

Implementuje funkci get vlastnosti povoleného objektu na ovládacím prvku.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je ovládací prvek povolen; v opačném případě 0.

##  <a name="getextendedcontrol"></a>COleControl –:: GetExtendedControl

Získá ukazatel na objekt udržovaný kontejnerem, který představuje ovládací prvek s rozšířenou sadou vlastností.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na objekt rozšířeného ovládacího prvku kontejneru. Pokud není k dispozici žádný objekt, hodnota je NULL.

Tento objekt může být manipulován prostřednictvím jeho `IDispatch`ho rozhraní. Můžete také použít `QueryInterface` k získání dalších dostupných rozhraní poskytovaných objektem. Objekt však není vyžadován k podpoře konkrétní sady rozhraní. Všimněte si, že spoléhání na konkrétní funkce objektu rozšířeného ovládacího prvku kontejneru omezí přenositelnost vašeho ovládacího prvku na jiné libovolné kontejnery.

### <a name="remarks"></a>Poznámky

Funkce, která volá tuto funkci, zodpovídá za uvolnění ukazatele po dokončení objektu. Všimněte si, že kontejner není vyžadován pro podporu tohoto objektu.

##  <a name="getfocus"></a>COleControl –:: GetFocus

Určuje, zda objekt `COleControl` má fokus.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Návratová hodnota

Pokud je ovládací prvek aktivován a bez okna, vrátí **tuto** hodnotu, pokud ovládací prvek aktuálně má fokus klávesnice (jak je určen kontejnerem ovládacího prvku), nebo hodnotu null, pokud nemá fokus.

V opačném případě vrátí objekt `CWnd`, který má fokus (totéž jako `CWnd::GetFocus`).

### <a name="remarks"></a>Poznámky

Aktivovaný ovládací prvek bez oken obdrží fokus při volání metody [SetFocus](#setfocus) .

##  <a name="getfont"></a>COleControl –:: GetFont

Implementuje funkci get vlastnosti burzovního písma.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na rozhraní odeslání písma pro vlastnost písma ovládacího prvku.

### <a name="remarks"></a>Poznámky

Všimněte si, že volající musí uvolnit objekt po dokončení. V rámci implementace ovládacího prvku použijte `InternalGetFont` pro přístup k objektu fontu ovládacího prvku. Další informace o používání písem v ovládacím prvku naleznete v článku [ovládací prvky ActiveX: použití písem v ovládacím prvku ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>COleControl –:: GetFontTextMetrics

Měří metriku textu pro libovolný objekt `CFontHolder` vlastněný ovládacím prvkem.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Ukazatel na strukturu [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

*fontHolder*<br/>
Odkaz na objekt [CFontHolder](../../mfc/reference/cfontholder-class.md) .

### <a name="remarks"></a>Poznámky

Toto písmo lze vybrat pomocí funkce [COleControl –:: SelectFontObject](#selectfontobject) . `GetFontTextMetrics` inicializuje strukturu `TEXTMETRIC`, na kterou odkazoval *lptm* , s platnými informacemi o metrikách `fontHolder`v případě úspěchu, nebo pokud neproběhne úspěšně, vyplní strukturu nulami. Tuto funkci byste měli použít místo [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) při vykreslování ovládacího prvku, protože ovládací prvky, jako je libovolný vložený objekt OLE, mohou být nutné k vykreslování do metasouboru.

Struktura `TEXTMETRIC` pro výchozí písmo je aktualizována při volání funkce [SelectFontObject](#selectfontobject) . `GetFontTextMetrics` byste měli volat až po výběru vlastnosti zásobed Font, která zajistí, že informace, které poskytuje, jsou platné.

##  <a name="getforecolor"></a>COleControl –:: GetForeColor

Implementuje funkci get vlastnosti ' burzovní barva ForeColor.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Návratová hodnota

Návratová hodnota určuje aktuální barvu popředí jako hodnotu OLE_COLOR, pokud byla úspěšná. Tuto hodnotu lze přeložit na hodnotu [COLORREF](/windows/win32/gdi/colorref) voláním `TranslateColor`.

##  <a name="gethwnd"></a>COleControl –:: GetHwnd

Implementuje funkci get pro uloženou vlastnost hWnd.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Návratová hodnota

Popisovač okna ovládacího prvku OLE, pokud existuje; jinak NULL.

##  <a name="getmessagestring"></a>COleControl –:: GetMessageString

Volá se rozhraním, aby se získal krátký řetězec, který popisuje účel položky nabídky identifikované pomocí *NID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parametry

*nID*<br/>
ID položky nabídky

*rMessage*<br/>
Odkaz na objekt [CString](../../atl-mfc-shared/reference/cstringt-class.md) , pomocí kterého bude vrácen řetězec.

### <a name="remarks"></a>Poznámky

Tato možnost slouží k získání zprávy pro zobrazení ve stavovém řádku, zatímco je zvýrazněna položka nabídky. Výchozí implementace se pokusí načíst prostředek řetězce identifikovaný pomocí *NID*.

##  <a name="getnotsupported"></a>COleControl –:: GetNotSupported

Zabrání přístupu uživatele k hodnotě vlastnosti ovládacího prvku.

```
void GetNotSupported();
```

### <a name="remarks"></a>Poznámky

Voláním této funkce místo funkce Get jakékoli vlastnosti, kde je načítání vlastnosti uživatelem ovládacího prvku není podporováno. Příkladem může být vlastnost, která je pouze pro zápis.

##  <a name="getreadystate"></a>COleControl –:: GetReadyState

Vrátí stav připravenosti ovládacího prvku.

```
long GetReadyState();
```

### <a name="return-value"></a>Návratová hodnota

Stav připravenosti ovládacího prvku, jedna z následujících hodnot:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Výchozí stav inicializace|
|READYSTATE_LOADING|Ovládací prvek aktuálně načítá jeho vlastnosti.|
|READYSTATE_LOADED|Ovládací prvek byl inicializován|
|READYSTATE_INTERACTIVE|Ovládací prvek má dostatek dat pro interaktivní, ale ne všechna asynchronní data jsou ještě načtena.|
|READYSTATE_COMPLETE|Ovládací prvek má všechna jeho data|

### <a name="remarks"></a>Poznámky

Většina jednoduchých ovládacích prvků nikdy nemusí rozlišovat mezi nahranými a INTERAKTIVNÍmi prvky. Nicméně ovládací prvky, které podporují vlastnosti cesty k datům, nemusí být připravené k interaktivním, dokud se nejméně některá data neobdrží asynchronně. Ovládací prvek by se měl považovat za interaktivní, jakmile to bude možné.

##  <a name="getrectincontainer"></a>COleControl –:: GetRectInContainer

Získá souřadnice obdélníku ovládacího prvku relativně ke kontejneru vyjádřené v jednotkách zařízení.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na strukturu obdélníku, do které budou zkopírovány souřadnice ovládacího prvku.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je ovládací prvek na místě aktivní; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Obdélník je platný pouze v případě, že je ovládací prvek na místě aktivní.

##  <a name="getstocktextmetrics"></a>COleControl –:: GetStockTextMetrics

Měří metriku textu pro vlastnost burzovního písma ovládacího prvku, kterou lze vybrat pomocí funkce [SelectStockFont](#selectstockfont) .

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Ukazatel na strukturu [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

### <a name="remarks"></a>Poznámky

Funkce `GetStockTextMetrics` inicializuje strukturu `TEXTMETRIC`, na kterou odkazoval *lptm* , s platnými informacemi o metrikách, pokud jsou úspěšné, nebo vyplní strukturu nulami, pokud neproběhne úspěšně. Tuto funkci použijte místo [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) při malování ovládacího prvku, protože ovládací prvky, jako je libovolný vložený objekt OLE, mohou být nutné k vykreslování do metasouboru.

Struktura `TEXTMETRIC` pro výchozí písmo je aktualizována při volání funkce `SelectStockFont`. Tuto funkci byste měli zavolat až po výběru burzovního písma, aby se zajistilo, že informace, které poskytuje, jsou platné.

##  <a name="gettext"></a>COleControl –:: GetText

Implementuje funkci get vlastnosti uloženého textu nebo popisku.

```
BSTR GetText();
```

### <a name="return-value"></a>Návratová hodnota

Aktuální hodnota textového řetězce ovládacího prvku nebo řetězce nulové délky, pokud není k dispozici žádný řetězec.

> [!NOTE]
>  Další informace o datovém typu BSTR naleznete v tématu [datové typy](../../mfc/reference/data-types-mfc.md) v části makra a Globals.

### <a name="remarks"></a>Poznámky

Všimněte si, že volající této funkce musí volat `SysFreeString` u řetězce vráceného za účelem uvolnění prostředku. V rámci implementace ovládacího prvku použijte `InternalGetText` pro přístup k vlastnosti ovládacího prvku text nebo Caption.

##  <a name="getwindowlessdroptarget"></a>COleControl –:: GetWindowlessDropTarget

Přepište `GetWindowlessDropTarget`, pokud chcete, aby ovládací prvek bez oken byl cílem operace přetažení OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na `IDropTarget` rozhraní objektu. Vzhledem k tomu, že nemá okno, objekt bez oken nemůže registrovat `IDropTarget` rozhraní. Chcete-li se však zúčastnit přetahování, objekt bez oken může přesto implementovat rozhraní a vrátit jej v `GetWindowlessDropTarget`.

### <a name="remarks"></a>Poznámky

Obvykle by to vyžadovalo, aby bylo okno ovládacího prvku registrováno jako cíl přetažení. Ale vzhledem k tomu, že ovládací prvek nemá žádné vlastní okno, kontejner použije vlastní okno jako cíl přetažení. Ovládací prvek stačí poskytnout implementaci rozhraní `IDropTarget`, ke kterému kontejner může delegovat volání v příslušném čase. Příklad:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>COleControl –:: InitializeIIDs

Informuje základní třídu IID, kterou bude ovládací prvek používat.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parametry

*piidPrimary*<br/>
Ukazatel na ID rozhraní primárního odesílajícího rozhraní ovládacího prvku.

*piidEvents*<br/>
Ukazatel na ID rozhraní ovládacího prvku události ovládacího prvku.

### <a name="remarks"></a>Poznámky

Zavolejte tuto funkci v konstruktoru ovládacího prvku a informujte základní třídu identifikátorů rozhraní, které bude váš ovládací prvek používat.

##  <a name="internalgetfont"></a>COleControl –:: InternalGetFont

Přistupuje k vlastnosti burzovního písma vašeho ovládacího prvku.

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Návratová hodnota

Odkaz na objekt [CFontHolder](../../mfc/reference/cfontholder-class.md) , který obsahuje burzovní objekt Font.

##  <a name="internalgettext"></a>COleControl –:: InternalGetText

Přistupuje k uloženému textu nebo vlastnosti titulků vašeho ovládacího prvku.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Návratová hodnota

Odkaz na textový řetězec ovládacího prvku.

##  <a name="internalsetreadystate"></a>COleControl –:: funkci InternalSetReadyState

Nastaví stav připravenosti ovládacího prvku.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parametry

*lNewReadyState*<br/>
Stav připravenosti, který se má nastavit pro ovládací prvek, jednu z následujících hodnot:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Výchozí stav inicializace|
|READYSTATE_LOADING|Ovládací prvek aktuálně načítá jeho vlastnosti.|
|READYSTATE_LOADED|Ovládací prvek byl inicializován|
|READYSTATE_INTERACTIVE|Ovládací prvek má dostatek dat pro interaktivní, ale ne všechna asynchronní data jsou ještě načtena.|
|READYSTATE_COMPLETE|Ovládací prvek má všechna jeho data|

### <a name="remarks"></a>Poznámky

Většina jednoduchých ovládacích prvků nikdy nemusí rozlišovat mezi nahranými a INTERAKTIVNÍmi prvky. Nicméně ovládací prvky, které podporují vlastnosti cesty k datům, nemusí být připravené k interaktivním, dokud se nejméně některá data neobdrží asynchronně. Ovládací prvek by se měl považovat za interaktivní, jakmile to bude možné.

##  <a name="invalidatecontrol"></a>COleControl –:: InvalidateControl

Vynutí, aby se ovládací prvek znovu nakreslil.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na oblast ovládacího prvku, který má být vyhodnocen jako neplatný.

*bErase*<br/>
Určuje, zda má být pozadí v rámci oblasti aktualizace smazáno při zpracování oblasti aktualizace.

### <a name="remarks"></a>Poznámky

Pokud má *lpRect* hodnotu null, celý ovládací prvek se překreslí. Pokud *lpRect* není null, znamená to, že část obdélníku ovládacího prvku, která má být neověřena. V případech, kdy ovládací prvek nemá žádné okno nebo není aktuálně aktivní, je obdélník ignorován a je provedeno volání členské funkce [IAdviseSink:: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) klientského webu. Tuto funkci použijte místo `CWnd::InvalidateRect` nebo `InvalidateRect`.

##  <a name="invalidatergn"></a>COleControl –:: InvalidateRgn

Zruší platnost klientské oblasti okna kontejneru v rámci dané oblasti.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*pRgn*<br/>
Ukazatel na objekt [CRgn](../../mfc/reference/crgn-class.md) , který identifikuje zobrazovanou oblast objektu OLE k Invalidate, v souřadnicích klienta nadřazeného okna. Pokud má tento parametr hodnotu NULL, je rozsah celý objekt.

*bErase*<br/>
Určuje, zda bude pozadí v rámci neověřené oblasti smazáno. Při hodnotě TRUE se pozadí smaže. Pokud má hodnotu FALSE, pozadí zůstane beze změny.

### <a name="remarks"></a>Poznámky

To lze použít k překreslení ovládacích prvků bez oken v rámci kontejneru. Neověřená oblast spolu se všemi ostatními oblastmi v oblasti aktualizace je označena pro malování při odeslání další [WM_PAINT](/windows/win32/gdi/wm-paint) zprávy.

Pokud má *bErase* hodnotu true pro libovolnou část oblasti aktualizace, je vymazáno pozadí v celé oblasti, nikoli pouze v dané části.

##  <a name="isconvertingvbx"></a>COleControl –:: IsConvertingVBX

Umožňuje specializované načítání ovládacího prvku OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je ovládací prvek převáděn; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Při převodu formuláře, který používá ovládací prvky VBX na jeden, který používá ovládací prvky OLE, může být vyžadováno speciální kód pro načítání ovládacích prvků OLE. Například pokud načítáte instanci ovládacího prvku OLE, může být volání [PX_Font](persistence-of-ole-controls.md#px_font) v `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Nicméně ovládací prvky VBX neobsahují objekt Font; jednotlivé vlastnosti písma byly uloženy jednotlivě. V takovém případě použijete `IsConvertingVBX` k rozlišení mezi těmito dvěma případy:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Další případ by byl v případě, že ovládací prvek VBX uložil proprietární binární data (v obslužné rutině zprávy VBM_SAVEPROPERTY) a ovládací prvek OLE ukládá svá binární data v jiném formátu. Pokud chcete, aby byl ovládací prvek OLE zpětně kompatibilní s ovládacím prvkem VBX, mohli byste načíst staré i nové formáty pomocí funkce `IsConvertingVBX`, a to tak, že rozlišíte, zda byl ovládací prvek VBX nebo ovládací prvek OLE načten.

Ve funkci `DoPropExchange` ovládacího prvku můžete vyhledat tuto podmínku a v případě hodnoty true spustit zátěžový kód specifický pro tento převod (například předchozí příklady). Pokud se ovládací prvek nepřevádí, můžete spustit normální zátěžový kód. Tato možnost se vztahuje pouze na ovládací prvky, které jsou převáděny ze strany VBX.

##  <a name="isinvokeallowed"></a>COleControl –:: IsInvokeAllowed

Povoluje vyvolání metody automatizace.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byl ovládací prvek inicializován; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Implementace rozhraní `IDispatch::Invoke` volá `IsInvokeAllowed` k určení, zda může být vyvolána daná funkce (identifikovaná `dispid`). Výchozím chováním ovládacího prvku OLE je umožnění vyvolání metod automatizace pouze v případě, že byl ovládací prvek inicializován. `IsInvokeAllowed` je však virtuální funkce a v případě potřeby může být přepsána (například při použití ovládacího prvku jako automatizačního serveru).

##  <a name="ismodified"></a>COleControl –::-Modified

Určuje, zda byl změněn stav ovládacího prvku.

```
BOOL IsModified();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byl stav ovládacího prvku změněn od posledního uložení; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Stav ovládacího prvku je upraven při změně hodnoty vlastnosti.

##  <a name="isoptimizeddraw"></a>COleControl –:: IsOptimizedDraw

Určuje, zda kontejner podporuje optimalizované vykreslování pro aktuální operaci kreslení.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Návratová hodnota

TRUE, pokud kontejner podporuje optimalizované vykreslování pro aktuální operaci kreslení; v opačném případě FALSE.

### <a name="remarks"></a>Poznámky

Pokud je podporováno optimalizované vykreslování, ovládací prvek po dokončení vykreslování nemusí vybrat staré objekty (pera, štětce, písma atd.) do kontextu zařízení.

##  <a name="issubclassedcontrol"></a>COleControl –:: IsSubclassedControl

Volá se rozhraním, aby se určilo, jestli ovládací prvek podtřídí ovládací prvek Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je ovládací prvek roztříděný; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tuto funkci je nutné přepsat a vrátit hodnotu TRUE, pokud ovládací prvek OLE podtřídí ovládací prvek systému Windows.

##  <a name="load"></a>COleControl –:: Load

Obnoví asynchronně načtená data a iniciuje nové načtení asynchronní vlastnosti ovládacího prvku.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parametry

*strNewPath*<br/>
Ukazatel na řetězec obsahující cestu, která odkazuje na absolutní umístění vlastnosti asynchronního ovládacího prvku.

*Úprava*<br/>
Objekt [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) implementující vlastnost asynchronního ovládacího prvku.

##  <a name="lockinplaceactive"></a>COleControl –:: LockInPlaceActive

Zabraňuje kontejneru v deaktivaci vašeho ovládacího prvku.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parametry

*Blokované*<br/>
TRUE, pokud má být místní aktivní stav ovládacího prvku uzamčen; FALSE, pokud má být odemčen.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud zámek byl úspěšný; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Všimněte si, že každé uzamknutí ovládacího prvku musí být spárováno s odemknutím ovládacího prvku po dokončení. Měli byste uzamknout pouze ovládací prvek pro krátká období, například při vyvolávání události.

##  <a name="onambientpropertychange"></a>COleControl –:: OnAmbientPropertyChange

Volá se rozhraním, když se změní hodnota vlastnosti okolí kontejneru.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*dispID*<br/>
ID odeslání vlastnosti ambientd, která se změnila nebo DISPID_UNKNOWN, pokud se změnilo více vlastností.

##  <a name="onappearancechanged"></a>COleControl –:: OnAppearanceChanged

Volá se rozhraním, když se změní hodnota vlastnosti burzovní vzhled.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Poznámky

Tuto funkci můžete přepsat, pokud chcete po změně této vlastnosti oznámení změnit. Výchozí implementace volá `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>COleControl –:: OnBackColorChanged

Volá se rozhraním, když se změní hodnota vlastnosti Barva pozadí.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Poznámky

Tuto funkci můžete přepsat, pokud chcete po změně této vlastnosti oznámení změnit. Výchozí implementace volá `InvalidateControl`.

##  <a name="onborderstylechanged"></a>COleControl –:: OnBorderStyleChanged

Volá se rozhraním, když se změní hodnota vlastnosti okraje na populaci.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá `InvalidateControl`.

Tuto funkci můžete přepsat, pokud chcete po změně této vlastnosti oznámení změnit.

##  <a name="onclick"></a>COleControl –:: Click

Volá se rozhraním, když se kliklo na tlačítko myši, nebo se vyvolala DoClicka uložená metoda.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parametry

*iButton*<br/>
Index tlačítka myši Může mít jednu z následujících hodnot:

- LEFT_BUTTON kliknutí levým tlačítkem myši.

- MIDDLE_BUTTON bylo kliknuto na prostřední tlačítko myši.

- RIGHT_BUTTON stisknutí pravého tlačítka myši.

### <a name="remarks"></a>Poznámky

Výchozí implementace volá `COleControl::FireClick`.

Přepište tuto členskou funkci pro úpravu nebo rozšiřování výchozího zpracování.

##  <a name="onclose"></a>COleControl –::-Close

Volá se rozhraním, když se kontejner nazývá funkce `IOleControl::Close` ovládacího prvku.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parametry

*dwSaveOption*<br/>
Příznak, který označuje, zda má být objekt před načtením uložen. Platné hodnoty jsou:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Poznámky

Ve výchozím nastavení `OnClose` uloží objekt ovládacího prvku, pokud byl změněn a *dwSaveOption* je buď OLECLOSE_SAVEIFDIRTY nebo OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>COleControl –:: OnDoVerb

Volá se rozhraním, když kontejner volá členskou funkci `IOleObject::DoVerb`.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*iVerb*<br/>
Index příkazu ovládacího prvku, který má být vyvolán.

*lpMsg*<br/>
Ukazatel na zprávu systému Windows, která způsobila vyvolání příkazu.

*hWndParent*<br/>
Popisovač nadřazeného okna ovládacího prvku. Pokud spuštění příkazu vytvoří okno (nebo Windows), *hwndParent* by mělo být použito jako nadřazené.

*lpRect*<br/>
Ukazatel na strukturu RECT, do které se zkopírují souřadnice ovládacího prvku vzhledem k kontejneru, se zkopírují.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo volání úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace používá ON_OLEVERB a ON_STDOLEVERB položky mapování zpráv k určení správné funkce k vyvolání.

Přepsáním této funkce změníte výchozí zpracování příkazu.

##  <a name="ondraw"></a>COleControl –:: Draw

Volá se rozhraním, aby se nakreslil ovládací prvek OLE v zadaném ohraničujícím obdélníku pomocí zadaného kontextu zařízení.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Kontext zařízení, ve kterém probíhá vykreslování.

*rcBounds*<br/>
Obdélníková oblast ovládacího prvku, včetně ohraničení.

*rcInvalid*<br/>
Obdélníková oblast ovládacího prvku, která je neplatná.

### <a name="remarks"></a>Poznámky

`OnDraw` se obvykle volá pro zobrazení obrazovky a při předávání kontextu zařízení obrazovky jako *primárního řadiče domény*. Parametr *rcBounds* identifikuje obdélník v kontextu cílového zařízení (vzhledem k aktuálnímu režimu mapování). Parametr *rcInvalid* je skutečný obdélník, který je neplatný. V některých případech bude tato oblast menší než *rcBounds*.

##  <a name="ondrawmetafile"></a>COleControl –:: OnDrawMetafile

Volá se rozhraním, aby se nakreslil ovládací prvek OLE v zadaném ohraničujícím obdélníku pomocí zadaného kontextu zařízení v metasouboru.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Kontext zařízení, ve kterém probíhá vykreslování.

*rcBounds*<br/>
Obdélníková oblast ovládacího prvku, včetně ohraničení.

### <a name="remarks"></a>Poznámky

Výchozí implementace volá funkci [nakreslit](#ondraw) .

##  <a name="onedit"></a>COleControl –:: s úpravami

Způsobí, že se ovládací prvek aktivuje v uživatelském rozhraní.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Ukazatel na zprávu systému Windows, která vyvolala příkaz.

*hWndParent*<br/>
Popisovač nadřazeného okna ovládacího prvku.

*lpRect*<br/>
Ukazatel na obdélník, který je použit ovládacím prvkem v kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je volání úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

To má stejný účinek jako vyvolání operace OLEIVERB_UIACTIVATE ovládacího prvku.

Tato funkce se obvykle používá jako funkce obslužné rutiny pro položku ON_OLEVERB mapování zpráv. Tím se příkaz Edit zpřístupní v nabídce "objekt" ovládacího prvku. Příklad:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>COleControl –:: OnEnabledChanged

Volá se rozhraním, když se změní hodnota vlastnosti s povoleným zásobou.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Poznámky

Tuto funkci můžete přepsat, pokud chcete po změně této vlastnosti oznámení změnit. Výchozí implementace volá [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>COleControl –:: OnEnumVerbs

Volá se rozhraním, když kontejner volá členskou funkci `IOleObject::EnumVerbs`.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parametry

*ppenumOleVerb*<br/>
Ukazatel na objekt `IEnumOLEVERB`, který vytvoří výčet sloves ovládacího prvku.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud jsou k dispozici příkazy; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace vytvoří výčet položek ON_OLEVERB v mapě zpráv.

Přepsáním této funkce změníte výchozí způsob vytváření výčtu operací.

##  <a name="oneventadvise"></a>COleControl –:: OnEventAdvise

Volá se rozhraním, když je obslužná rutina události připojená k ovládacímu prvku OLE nebo se k němu odpojila.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parametry

*bAdvise*<br/>
Hodnota TRUE označuje, že byla k ovládacímu prvku připojena obslužná rutina události. Hodnota FALSE označuje, že obslužná rutina události byla odpojena od ovládacího prvku.

##  <a name="onfontchanged"></a>COleControl –:: OnFontChanged

Volá se rozhraním, když se změní hodnota vlastnosti zásobed Font.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá `COleControl::InvalidateControl`. Pokud ovládací prvek roztřídí ovládací prvek systému Windows, výchozí implementace také pošle WM_SETFONTovou zprávu do okna ovládacího prvku.

Tuto funkci můžete přepsat, pokud chcete po změně této vlastnosti oznámení změnit.

### <a name="example"></a>Příklad

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>COleControl –:: OnForeColorChanged

Volá se rozhraním, když se změní hodnota vlastnosti zásobovaná barva.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá `InvalidateControl`.

Tuto funkci můžete přepsat, pokud chcete po změně této vlastnosti oznámení změnit.

##  <a name="onfreezeevents"></a>COleControl –:: OnFreezeEvents

Volá se rozhraním, když kontejner volá `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parametry

*bFreeze*<br/>
TRUE, pokud je zablokováno zpracování událostí ovládacího prvku; v opačném případě FALSE.

### <a name="remarks"></a>Poznámky

Výchozí implementace neprovádí žádnou akci.

Tuto funkci můžete přepsat, pokud chcete další chování při zmrazení nebo nezmrazení události.

##  <a name="ongetcolorset"></a>COleControl –:: OnGetColorSet

Volá se rozhraním, když kontejner volá členskou funkci `IViewObject::GetColorSet`.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parametry

*ptd*<br/>
Odkazuje na cílové zařízení, pro které se má obrázek vykreslovat. Pokud je tato hodnota NULL, měl by se obrázek vykreslovat pro výchozí cílové zařízení, obvykle pro zobrazovací zařízení.

*hicTargetDev*<br/>
Určuje informační kontext na cílovém zařízení, které indikuje *PTD*. Tento parametr může být kontextem zařízení, ale není jednou nutně. Pokud má *PTD* hodnotu null, *hicTargetDev* by měl mít také hodnotu null.

*ppColorSet*<br/>
Ukazatel na umístění, do kterého se mají zkopírovat sadu barev, které by se měly použít. Pokud funkce nevrátí sadu barev, je vrácena hodnota NULL.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je vrácena platná sada barev; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Kontejner volá tuto funkci, aby získal všechny barvy potřebné k vykreslení ovládacího prvku OLE. Kontejner může použít sady barev získané ve spojení s barvami, které musí nastavovat celkovou paletu barev. Výchozí implementace vrátí hodnotu FALSE.

Přepsáním této funkce proveďte jakékoli speciální zpracování této žádosti.

##  <a name="ongetcontrolinfo"></a>COleControl –:: OnGetControlInfo

Volá se rozhraním, když kontejner ovládacího prvku požaduje informace o ovládacím prvku.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parametry

*pControlInfo*<br/>
Ukazatel na strukturu [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) , která se má vyplnit.

### <a name="remarks"></a>Poznámky

Tyto informace se skládají hlavně z popisu popisných kláves ovládacího prvku. Výchozí implementace vyplní *pControlInfo* výchozími informacemi.

Tuto funkci přepište, pokud váš ovládací prvek potřebuje zpracovat klávesové zkratky.

##  <a name="ongetdisplaystring"></a>COleControl –:: OnGetDisplayString

Volá se rozhraním, aby se získal řetězec, který představuje aktuální hodnotu vlastnosti identifikované identifikátorem *DISPID*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
ID odeslání vlastnosti ovládacího prvku.

*strValue*<br/>
Odkaz na objekt [CString](../../atl-mfc-shared/reference/cstringt-class.md) , pomocí kterého bude vrácen řetězec.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byl v StrValue vrácen řetězec *;* v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tuto funkci přepište, pokud má váš ovládací prvek vlastnost, jejíž hodnota nemůže být převedena přímo na řetězec a chcete, aby se hodnota vlastnosti zobrazovala v prohlížeči vlastností dodaných kontejnerem.

##  <a name="ongetinplacemenu"></a>COleControl –:: OnGetInPlaceMenu

Volá se rozhraním, když je ovládací prvek aktivovaný, aby se získala nabídka, která se sloučí do existující nabídky kontejneru.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Návratová hodnota

Popisovač nabídky ovládacího prvku nebo hodnotu NULL, pokud ovládací prvek nemá žádný. Výchozí implementace vrací hodnotu NULL.

### <a name="remarks"></a>Poznámky

Další informace o slučování prostředků OLE najdete v článcích [nabídky a prostředky (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>COleControl –:: OnGetNaturalExtent

Volá se rozhraním v reakci na požadavek `IViewObjectEx::GetNaturalExtent` kontejneru.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Určuje způsob reprezentace objektu. Reprezentace zahrnují obsah, ikonu, miniaturu nebo vytištěný dokument. Platné hodnoty jsou pořízeny z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*lindex*<br/>
Část objektu, která je zajímavá. V současné době je platná pouze-1.

*ptd*<br/>
Odkazuje na strukturu [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) definující cílové zařízení, pro které by měla být vrácena velikost objektu.

*hicTargetDev*<br/>
Určuje kontext informací pro cílové zařízení, které je uvedené v parametru *PTD* , ze kterého může objekt extrahovat metriky zařízení a testovat schopnosti zařízení. Pokud má *PTD* hodnotu null, objekt by měl ignorovat hodnotu v parametru *hicTargetDev* .

*pExtentInfo*<br/>
Odkazuje na strukturu `DVEXTENTINFO`, která určuje data o velikosti. Struktura `DVEXTENTINFO`:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

`dwExtentMode` členů struktury může mít jednu ze dvou hodnot:

- DVEXTENT_CONTENT Dotázat se na to, jak velký by měl ovládací prvek odpovídat obsahu (přichycení k velikosti)

- Při změně velikosti předejte navrhovanou velikost pro řízení DVEXTENT_INTEGRAL.

*psizel*<br/>
Odkazuje na velikost dat vrácených ovládacím prvkem. Vrácená data změny velikosti jsou nastavena na hodnotu-1 pro libovolnou dimenzi, která nebyla upravena.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud úspěšně vrátí nebo upraví velikost; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Přepsáním této funkce vrátíte velikost zobrazované velikosti objektu, která je nejblíže navržené velikosti a režimu rozsahu ve struktuře `DVEXTENTINFO`. Výchozí implementace vrátí hodnotu FALSE a neprovede žádné úpravy velikosti.

##  <a name="ongetpredefinedstrings"></a>COleControl –:: OnGetPredefinedStrings

Volá se rozhraním, aby se získala sada předdefinovaných řetězců, které představují možné hodnoty pro vlastnost.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
ID odeslání vlastnosti ovládacího prvku.

*pStringArray*<br/>
Pole řetězců, které se má vyplnit návratovými hodnotami.

*pCookieArray*<br/>
Pole DWORD, které se má vyplnit návratovými hodnotami.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byly přidány prvky do *pStringArray* a *pCookieArray*.

### <a name="remarks"></a>Poznámky

Tuto funkci přepište, pokud má váš ovládací prvek vlastnost se sadou možných hodnot, které mohou být reprezentovány řetězci. Pro každý prvek přidaný do *pStringArray*byste měli přidat odpovídající prvek "cookie" do *pCookieArray.* Tyto hodnoty "cookie" mohou být později předány rozhraním funkce `COleControl::OnGetPredefinedValue`.

##  <a name="ongetpredefinedvalue"></a>COleControl –:: OnGetPredefinedValue

Volá se rozhraním, aby se získala hodnota odpovídající jednomu z předdefinovaných řetězců dříve vráceného přepsáním `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
ID odeslání vlastnosti ovládacího prvku.

*dwCookie*<br/>
Hodnota souboru cookie dříve vrácená přepsáním `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Ukazatel na strukturu `VARIANT`, pomocí které se vrátí hodnota vlastnosti.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byla vrácena hodnota v *lpvarOut*; v opačném případě 0.

##  <a name="ongetviewextent"></a>COleControl –:: OnGetViewExtent

Volá se rozhraním v reakci na požadavek [IViewObject2:: getrozsahu](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) kontejneru.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parametry

*dwDrawAspect*<br/>
Hodnota DWORD popisující, který formulář nebo aspekt objektu má být zobrazen. Platné hodnoty jsou pořízeny z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*lindex*<br/>
Část objektu, která je zajímavá. V současné době je platná pouze-1.

*ptd*<br/>
Odkazuje na strukturu [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) definující cílové zařízení, pro které by měla být vrácena velikost objektu.

*lpsizel*<br/>
Odkazuje na umístění, kde je vrácena velikost objektu.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud jsou informace o rozsahu úspěšně vráceny; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tuto funkci přepište, pokud váš ovládací prvek používá oboustranný výkres, přičemž jeho neprůhledné a transparentní součásti mají různé rozměry.

##  <a name="ongetviewrect"></a>COleControl –:: OnGetViewRect

Volá se rozhraním v reakci na požadavek `IViewObjectEx::GetRect` kontejneru.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Hodnota DWORD popisující, který formulář nebo aspekt objektu má být zobrazen. Platné hodnoty jsou pořízeny z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2:

- DVASPECT_CONTENT ohraničující obdélník celého objektu. Levý horní roh na počátku a velikost objektu, který se rovná rozsahu vrácenému `GetViewExtent` *.*

- DVASPECT_OPAQUE objektů s obdélníkovou neprůhlednou oblastí vrátí tento obdélník. Ostatní selžou.

- DVASPECT_TRANSPARENT obdélník, který pokrývá všechny transparentní nebo nedovolené části.

*pRect*<br/>
Odkazuje na strukturu [Rect](/previous-versions/dd162907\(v=vs.85\)) určující obdélník, ve kterém má být objekt vykreslen. Tento parametr řídí umístění a roztažení objektu.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je velikost rámečku na objekt úspěšně vrácena; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Velikost objektu je převedena pomocí `OnGetViewRect` do obdélníku, který začíná na konkrétní pozici (výchozí je levý horní roh zobrazení). Tuto funkci přepište, pokud váš ovládací prvek používá oboustranný výkres, přičemž jeho neprůhledné a transparentní součásti mají různé rozměry.

##  <a name="ongetviewstatus"></a>COleControl –:: OnGetViewStatus

Volá se rozhraním v reakci na požadavek `IViewObjectEx::GetViewStatus` kontejneru.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Návratová hodnota

Jedna z hodnot výčtu VIEWSTATUS, pokud je úspěšná; v opačném případě 0. Možné hodnoty jsou jakékoli kombinace následujících:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Objekt je zcela neprůhledný. Pokud tento bit není nastaven, objekt obsahuje průhledné části. Tento bit se vztahuje pouze na aspekty související s obsahem a nikoli na DVASPECT_ICON ani DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Objekt má plné pozadí (tvořené plnou barvou, ne vzorkem štětce). Tento bit má smysl pouze v případě, že je nastavena VIEWSTATUS_OPAQUE a vztahuje se pouze na aspekty související s obsahem a nikoli na DVASPECT_ICON nebo DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Objekt podporuje DVASPECT_OPAQUE. Všechny metody IViewObjectEx, které přijímají aspekty vykreslování jako parametr, lze s tímto aspektem volat.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Objekt podporuje DVASPECT_TRANSPARENT. Všechny metody `IViewObjectEx`, které přijímají aspekty vykreslování jako parametr, lze s tímto aspektem volat.|

### <a name="remarks"></a>Poznámky

Tuto funkci přepište, pokud váš ovládací prvek používá oboustranný výkres. Výchozí implementace vrací VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>COleControl –:: OnHideToolBars

Volá se rozhraním, když je ovládací prvek deaktivován z uživatelského rozhraní.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Poznámky

Implementace by měla skrývat všechny panely nástrojů zobrazené `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>COleControl –:: OnInactiveMouseMove

Volá se kontejnerem pro neaktivní objekt pod ukazatelem myši při přijetí zprávy WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Objekt ohraničující obdélník v souřadnicích klienta nadřazeného okna. Upozorní objekt na jeho přesné umístění a velikost na obrazovce při přijetí WM_MOUSEMOVE zprávy.

*znak*<br/>
Souřadnice x umístění myši v souřadnicích klienta nadřazeného okna

*požadované*<br/>
Souřadnice y umístění myši v souřadnicích klienta nadřazeného okna

*dwKeyState*<br/>
Určuje aktuální stav klávesových zkratek klávesnice na klávesnici. Platné hodnoty mohou být kombinace všech příznaků MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON a MK_RBUTTON.

### <a name="remarks"></a>Poznámky

Všimněte si, že souřadnice klienta okna (pixely) se používají k předání pozice kurzoru myši. To je možné také předáním ohraničujícího obdélníku objektu ve stejném souřadnicovém systému.

##  <a name="oninactivesetcursor"></a>COleControl –:: OnInactiveSetCursor

Volá se kontejnerem pro neaktivní objekt pod ukazatelem myši při přijetí zprávy WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Objekt ohraničující obdélník v souřadnicích klienta nadřazeného okna. Upozorní objekt na jeho přesné umístění a velikost na obrazovce při přijetí WM_SETCURSOR zprávy.

*znak*<br/>
Souřadnice x umístění myši v souřadnicích klienta nadřazeného okna

*požadované*<br/>
Souřadnice y umístění myši v souřadnicích klienta nadřazeného okna

*dwMouseMsg*<br/>
Identifikátor zprávy myši, pro kterou došlo k WM_SETCURSOR.

*bSetAlways*<br/>
Určuje, zda objekt musí nastavit kurzor. Je-li nastaveno na hodnotu TRUE, musí objekt nastavit kurzor. Pokud je hodnota FALSE, kurzor není povinný nastavit kurzor a měl by v takovém případě vracet S_FALSE.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Všimněte si, že souřadnice klienta okna (pixely) se používají k předání pozice kurzoru myši. To je možné také předáním ohraničujícího obdélníku objektu ve stejném souřadnicovém systému.

##  <a name="onkeydownevent"></a>COleControl –:: OnKeyDownEvent

Volá se rozhraním, když se zpracovává událost skladové události.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Hodnota kódu virtuálního klíče vylisovaných kláves. Seznam standardních kódů virtuálních klíčů naleznete v tématu Winuser. h.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK stisknutí klávesy SHIFT během akce.

- CTRL_MASK stisknutí klávesy CTRL během akce.

- ALT_MASK stisknutí klávesy ALT během akce.

### <a name="remarks"></a>Poznámky

Tuto funkci přepište, pokud váš ovládací prvek potřebuje přístup k informacím o klíči poté, co byla událost aktivována.

##  <a name="onkeypressevent"></a>COleControl –:: OnKeyPressEvent

Volá se rozhraním, když se aktivuje událost KeyPress.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Obsahuje hodnotu kódu virtuálního klíče pro stisknutí klávesy. Seznam standardních kódů virtuálních klíčů naleznete v tématu Winuser. h.

### <a name="remarks"></a>Poznámky

Všimněte si, že hodnota *nchar* mohla být upravena kontejnerem.

Tuto funkci popište, pokud chcete po této události obejít oznámení.

##  <a name="onkeyupevent"></a>COleControl –:: OnKeyUpEvent

Volá se rozhraním, když se zpracovává událost skladové události.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Hodnota kódu virtuálního klíče vylisovaných kláves. Seznam standardních kódů virtuálních klíčů naleznete v tématu Winuser. h.

*nShiftState*<br/>
Obsahuje kombinaci následujících příznaků:

- SHIFT_MASK stisknutí klávesy SHIFT během akce.

- CTRL_MASK stisknutí klávesy CTRL během akce.

- ALT_MASK stisknutí klávesy ALT během akce.

### <a name="remarks"></a>Poznámky

Tuto funkci přepište, pokud váš ovládací prvek potřebuje přístup k informacím o klíči poté, co byla událost aktivována.

##  <a name="onmappropertytopage"></a>COleControl –:: OnMapPropertyToPage

Volá se rozhraním, aby se získal identifikátor třídy stránky vlastností, která implementuje úpravy zadané vlastnosti.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
ID odeslání vlastnosti ovládacího prvku.

*lpclsid*<br/>
Ukazatel na strukturu `CLSID`, pomocí které se vrátí ID třídy.

*pbPageOptional*<br/>
Vrátí indikátor, zda je použití zadané stránky vlastností volitelné.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud bylo vráceno ID třídy v *lpClsid*; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Přepište tuto funkci, pokud chcete poskytnout způsob, jak vyvolat stránky vlastností ovládacího prvku z prohlížeče vlastností kontejneru.

##  <a name="onmnemonic"></a>COleControl –::-Symbolickéy

Volá se rozhraním, když kontejner zjistil, že se stiskl symbolický klíč ovládacího prvku OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parametry

*pMsg*<br/>
Ukazatel na zprávu Windows generovanou stisknutím klávesové zkratky.

##  <a name="onproperties"></a>COleControl –::-Properties

Volá se rozhraním, když se v kontejneru vyvolala operace vlastností ovládacího prvku.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Ukazatel na zprávu systému Windows, která vyvolala příkaz.

*hWndParent*<br/>
Popisovač nadřazeného okna ovládacího prvku.

*lpRect*<br/>
Ukazatel na obdélník, který je použit ovládacím prvkem v kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je volání úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace zobrazí dialogové okno modální vlastnost.

Tuto funkci můžete také využít k tomu, aby se zobrazily stránky vlastností ovládacího prvku. Zavolejte funkci `OnProperties`, která předá popisovači nadřazeného prvku ovládacího prvku v parametru *hwndParent* . V tomto případě jsou hodnoty parametrů *lpMsg* a *lpRect* ignorovány.

##  <a name="onqueryhitpoint"></a>COleControl –:: OnQueryHitPoint

Volá se rozhraním v reakci na požadavek `IViewObjectEx::QueryHitPoint` kontejneru.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Určuje způsob reprezentace objektu. Platné hodnoty jsou pořízeny z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*pRectBounds*<br/>
Ukazatel na strukturu `RECT` určující ohraničující obdélník klientské oblasti ovládacího prvku OLE.

*ptlLoc*<br/>
Ukazatel na strukturu `POINT` určující bod, který má být zkontrolován pro dosažení pozice. Bod je určen v souřadnicích klientské oblasti technologie OLE.

*lCloseHint*<br/>
Vzdálenost definující "Close" do bodu kontrolovaného pro dosažení pozice.

*pHitResult*<br/>
Ukazatel na výsledek dotazu na volání. Jedna z následujících hodnot:

- HITRESULT_OUTSIDE *ptlLoc* je mimo objekt OLE a nemůže být zavřen.

- HITRESULT_TRANSPARENT *ptlLoc* je v mezích objektu OLE, ale ne blízko k imagi. Například bod uprostřed průhledného kruhu může být HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* je uvnitř nebo vně objektu OLE, ale je dostatečně blízko objektu, který má být považován za uvnitř. Tuto hodnotu mohou používat malé, tenké nebo podrobné objekty. I v případě, že je bod mimo ohraničující obdélník objektu, může být stále zavřen (to je nutné pro povýšení malých objektů).

- HITRESULT_HIT *ptlLoc* je v rámci obrázku objektu.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je výsledek volání úspěšně vrácen; v opačném případě 0. Pozice je překrytí v oblasti zobrazení ovládacího prvku OLE.

### <a name="remarks"></a>Poznámky

Dotazuje se na to, zda se má obdélník zobrazení objektu překrývat s daným bodem (při výskytu tohoto bodu). `QueryHitPoint` může být přepsána na test přístupů pro jiné než obdélníkové objekty.

##  <a name="onqueryhitrect"></a>COleControl –:: OnQueryHitRect

Volá se rozhraním v reakci na požadavek `IViewObjectEx::QueryHitRect` kontejneru.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Určuje způsob reprezentace objektu. Platné hodnoty jsou pořízeny z výčtu [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) nebo DVASPECT2.

*pRectBounds*<br/>
Ukazatel na strukturu `RECT` určující ohraničující obdélník klientské oblasti ovládacího prvku OLE.

*prcLoc*<br/>
Ukazatel na strukturu `RECT` určující obdélník, který má být vybrán (překrývá se s obdélníkem objektu), relativně k levému hornímu rohu objektu.

*lCloseHint*<br/>
Nepoužívá se.

*pHitResult*<br/>
Ukazatel na výsledek dotazu na volání. Jedna z následujících hodnot:

- Objekt OLE neHITRESULT_OUTSIDE žádný bod v obdélníku.

- HITRESULT_HIT alespoň jeden bod v obdélníku by byl zásahem objektu.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je výsledek volání úspěšně vrácen; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Dotazuje se na to, zda se má obdélník zobrazení objektu překrývat s jakýmkoli bodem v daném obdélníku (výsledkem je obdélník). `QueryHitRect` může být přepsána na test přístupů pro jiné než obdélníkové objekty.

##  <a name="onrenderdata"></a>COleControl –:: OnRenderData

Volá se rozhraním, aby se načetla data v zadaném formátu.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Odkazuje na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) s určením formátu, ve kterém jsou požadovány informace.

*lpStgMedium*<br/>
Odkazuje na strukturu [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) , ve které se mají vrátit data.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Zadaný formát je ten dřív umístěný do objektu Control pomocí členských funkcí [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) nebo [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) pro zpožděné vykreslování. Výchozí implementace této funkce volá `OnRenderFileData` nebo `OnRenderGlobalData`, v případě, že zadané paměťové médium je buď soubor, nebo paměť. Pokud je požadovaný formát CF_METAFILEPICT nebo formát nastavený jako trvalá vlastnost, výchozí implementace Vykreslí příslušná data a vrátí nenulovou hodnotu. V opačném případě vrátí 0 a neprovede žádnou akci.

Pokud je TYMED_NULL *lpStgMedium-> TYMED* , STGMEDIUM by měl být přidělen a vyplněn podle zadání v *lpFormatEtc-> TYMED*. Pokud není TYMED_NULL, STGMEDIUM by měl být vyplněn s daty.

Tuto funkci potlačíte tak, aby poskytovala data v požadovaném formátu a na středních médiích. V závislosti na vašich datech možná budete chtít místo toho přepsat jednu z dalších verzí této funkce. Pokud jsou vaše data malá a pevná velikost, přepište `OnRenderGlobalData`. Pokud jsou vaše data v souboru nebo mají proměnlivou velikost, popište `OnRenderFileData`.

Další informace naleznete v tématu `FORMATETC` a `STGMEDIUM` struktury v Windows SDK.

##  <a name="onrenderfiledata"></a>COleControl –:: OnRenderFileData

Volá se rozhraním, aby se načetla data v zadaném formátu, když je paměťové médium soubor.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Odkazuje na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) s určením formátu, ve kterém jsou požadovány informace.

*pFile*<br/>
Odkazuje na objekt [CFile –](../../mfc/reference/cfile-class.md) , ve kterém se mají data vykreslovat.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Zadaný formát je ten dřív umístěný v ovládacím prvku pomocí členské funkce [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pro zpožděné vykreslování. Výchozí implementace této funkce jednoduše vrátí hodnotu FALSE.

Tuto funkci potlačíte tak, aby poskytovala data v požadovaném formátu a na středních médiích. V závislosti na vašich datech možná budete chtít místo toho přepsat jednu z dalších verzí této funkce. Pokud chcete zpracovat více úložných médií, přepište `OnRenderData`. Pokud jsou vaše data v souboru nebo mají proměnlivou velikost, popište `OnRenderFileData`.

Další informace najdete v tématu Struktura `FORMATETC` v Windows SDK.

##  <a name="onrenderglobaldata"></a>COleControl –:: OnRenderGlobalData

Volá se rozhraním, aby se načetla data v zadaném formátu, pokud je zadané paměťové médium globální paměti.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Odkazuje na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) s určením formátu, ve kterém jsou požadovány informace.

*phGlobal*<br/>
Odkazuje na popisovač globální paměti, ve které mají být vrácena data. Pokud není přidělena žádná paměť, tento parametr může mít hodnotu NULL.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Zadaný formát je ten dřív umístěný v ovládacím prvku pomocí členské funkce [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pro zpožděné vykreslování. Výchozí implementace této funkce jednoduše vrátí hodnotu FALSE.

Pokud má *phGlobal* hodnotu null, měl by se přidělit a vrátit nový HGLOBAL v *phGlobal*. V opačném případě by měl být HGLOBAL zadaný pomocí *phGlobal* vyplněn daty. Množství dat umístěných v HGLOBAL nesmí překročit aktuální velikost bloku paměti. Blok nelze také přidělit větší velikosti.

Tuto funkci potlačíte tak, aby poskytovala data v požadovaném formátu a na středních médiích. V závislosti na vašich datech možná budete chtít místo toho přepsat jednu z dalších verzí této funkce. Pokud chcete zpracovat více úložných médií, přepište `OnRenderData`. Pokud jsou vaše data v souboru nebo mají proměnlivou velikost, popište `OnRenderFileData`.

Další informace najdete v tématu Struktura `FORMATETC` v Windows SDK.

##  <a name="onresetstate"></a>COleControl –:: OnResetState

Volá se rozhraním, když by měly být vlastnosti ovládacího prvku nastavené na výchozí hodnoty.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá [DoPropExchange](#dopropexchange), který předává objekt `CPropExchange`, který způsobí, že vlastnosti budou nastaveny na výchozí hodnoty.

Zapisovač ovládacího prvku může vložit inicializační kód pro ovládací prvek OLE v této přepsatelné. Tato funkce se volá, když se volá rozhraní [IPersistStream:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) nebo [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) , nebo [IPersistStreamInit:: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) nebo [IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) , aniž byste nejdřív navolali buď `IPersistStream::Load`, nebo `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>COleControl –:: OnSetClientSite

Volá se rozhraním, když se kontejner nazývá funkce `IOleControl::SetClientSite` ovládacího prvku.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Poznámky

Ve výchozím nastavení `OnSetClientSite` kontroluje, zda jsou načteny vlastnosti cesty k datům a, pokud jsou, volání `DoDataPathPropExchange`.

Tuto funkci můžete přepsat, chcete-li provést jakékoli zvláštní zpracování tohoto oznámení. Konkrétně by přepsání této funkce měla volat základní třídu.

##  <a name="onsetdata"></a>COleControl –::-SetData

Volá se rozhraním, aby se data ovládacího prvku nahradila zadanými daty.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která určuje formát dat.

*lpStgMedium*<br/>
Ukazatel na strukturu [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) , ve které jsou uložena data.

*bRelease*<br/>
TRUE, pokud by měl ovládací prvek uvolnit paměťové médium; FALSE, pokud by neměl ovládací prvek uvolnit paměťové médium.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Pokud jsou data ve formátu trvalé sady vlastností, výchozí implementace upraví stav ovládacího prvku odpovídajícím způsobem. V opačném případě výchozí implementace neprovede žádnou akci. Pokud má *bRelease* hodnotu true, pak je prováděno volání `ReleaseStgMedium`; v opačném případě ne.

Přepište tuto funkci, aby se data ovládacího prvku nahradila zadanými daty.

Další informace naleznete v tématu `FORMATETC` a `STGMEDIUM` struktury v Windows SDK.

##  <a name="onsetextent"></a>COleControl –:: OnSetExtent

Volá se rozhraním, když se musí změnit rozsah ovládacího prvku, v důsledku volání metody [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parametry

*lpSizeL*<br/>
Ukazatel na `SIZEL` strukturu, která používá dlouhé celočíselné hodnoty k reprezentaci šířky a výšky ovládacího prvku vyjádřeného v jednotkách HIMETRIC

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byla změna velikosti přijata; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace zpracovává změnu velikosti rozsahu ovládacího prvku. Pokud je ovládací prvek na místě aktivní, pak se provede volání `OnPosRectChanged` kontejneru.

Tuto funkci potlačíte, chcete-li změnit výchozí velikost ovládacího prvku.

##  <a name="onsetobjectrects"></a>COleControl –:: OnSetObjectRects

Volá se rozhraním, aby se implementovalo volání [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parametry

*lpRectPos*<br/>
Ukazatel na `RECT` strukturu indikující novou polohu a velikost ovládacího prvku vzhledem ke kontejneru.

*lpRectClip*<br/>
Ukazatel na `RECT` strukturu indikující obdélníkovou oblast, do které má být ovládací prvek oříznut.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo přemístění přijato; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace automaticky zpracuje změnu umístění a velikost okna ovládacího prvku a vrátí hodnotu TRUE.

Tuto funkci potlačíte, chcete-li změnit výchozí chování této funkce.

##  <a name="onshowtoolbars"></a>COleControl –:: OnShowToolBars

Volá se rozhraním, když je ovládací prvek aktivovaný.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace neprovádí žádnou akci.

##  <a name="ontextchanged"></a>COleControl –:: OnTextChanged.

Volá se rozhraním, když se změní hodnota vlastnosti titulkového titulu nebo textu.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá `InvalidateControl`.

Tuto funkci můžete přepsat, pokud chcete po změně této vlastnosti oznámení změnit.

##  <a name="onwindowlessmessage"></a>COleControl –:: OnWindowlessMessage

Volá se rozhraním v reakci na požadavek `IOleInPlaceObjectWindowless::OnWindowMessage` kontejneru.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parametry

*MSG*<br/>
Identifikátor zprávy předaný systémem Windows.

*wParam*<br/>
Jak je předáno systémem Windows. Určuje další informace specifické pro zprávu. Obsah tohoto parametru závisí na hodnotě parametru *MSG* .

*lParam*<br/>
Jak je předáno systémem Windows. Určuje další informace specifické pro zprávu. Obsah tohoto parametru závisí na hodnotě parametru *MSG* .

*plResult*<br/>
Kód výsledku Windows Určuje výsledek zpracování zprávy a závisí na odeslané zprávě.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Zpracuje zprávy okna pro ovládací prvky bez oken. `OnWindowlessMessage` `COleControl`by se měly používat pro zprávy oken jiné než zprávy myši a klávesnice. `COleControl` poskytuje [SetCapture](#setcapture) a [SetFocus](#setfocus) konkrétně k získání zachytávání myší a zaostření klávesnice pro objekty OLE bez oken.

Vzhledem k tomu, že objekty bez oken nemají okno, potřebují mechanismus, který jim umožní odeslat do kontejneru zprávy. Objekt OLE bez oken získává zprávy z jeho kontejneru prostřednictvím metody `OnWindowMessage` v rozhraní `IOleInPlaceObjectWindowless` (rozšíření [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) pro podporu bez oken). `OnWindowMessage` nepřijímá parametr `HWND`.

##  <a name="parenttoclient"></a>COleControl –::P arentToClient

Přeloží souřadnice *pPoint* do souřadnic klientů.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Ukazatel na hranice ovládacího prvku OLE v rámci kontejneru. Ne klientská oblast, ale oblast celého ovládacího prvku, včetně ohraničení a posuvníků.

*pPoint*<br/>
Ukazatel na nadřazený (kontejner) bod, který má být přeložen do souřadnic oblasti klienta ovládacího prvku.

*bHitTest*<br/>
Určuje, zda má být v daném bodě provedeno testování volání.

### <a name="return-value"></a>Návratová hodnota

Pokud je *BHITTEST* false, vrátí HTNOWHERE. Pokud má *bHitTest* hodnotu true, vrátí umístění, ve kterém byl nadřazený (kontejner) bod vyloženo v klientské oblasti ovládacího prvku OLE a je jednou z následujících hodnot testu při volání myši:

- HTBORDER na okraji okna, které nemá ohraničení pro změnu velikosti.

- HTBOTTOM v dolním horizontálním okraji okna.

- HTBOTTOMLEFT v levém dolním rohu ohraničení okna.

- HTBOTTOMRIGHT v pravém dolním rohu ohraničení okna.

- HTCAPTION v oblasti záhlaví.

- HTCLIENT v klientské oblasti.

- HTERROR na pozadí obrazovky nebo na rozdělení čáry mezi Windows (stejné jako HTNOWHERE s tím rozdílem, že funkce `DefWndProc` Windows vytvoří zvukový signál systému k indikaci chyby).

- HTGROWBOX v poli velikosti.

- HTHSCROLL na vodorovný posuvník.

- HTLEFT na levém okraji okna.

- HTMAXBUTTON na tlačítko maximalizovat.

- HTMENU v oblasti nabídek.

- HTMINBUTTON na tlačítko minimalizovat.

- HTNOWHERE na pozadí obrazovky nebo na rozdělení čáry mezi Windows.

- HTREDUCE na tlačítko minimalizovat.

- HTRIGHT na pravém okraji okna.

- HTSIZE v poli velikosti (stejné jako HTGROWBOX).

- HTSYSMENU v nabídce ovládacího prvku nebo v tlačítku Zavřít v podřízeném okně.

- HTTOP v horním vodorovném okraji okna.

- HTTOPLEFT v levém horním rohu ohraničení okna.

- HTTOPRIGHT v pravém horním rohu ohraničení okna.

- HTTRANSPARENT v okně, které aktuálně pokrývá jiné okno.

- HTVSCROLL na svislém posuvníku.

- HTZOOM na tlačítko maximalizovat.

### <a name="remarks"></a>Poznámky

Vstupní *pPoint* je relativní vzhledem k počátku nadřazeného objektu (v levém horním rohu kontejneru). Ve výstupní *pPoint* je relativní vzhledem k počátku klientské oblasti ovládacího prvku OLE (levý horní roh oblasti klienta ovládacího prvku).

##  <a name="postmodaldialog"></a>COleControl –::P ostModalDialog

Upozorní kontejner, že modální dialogové okno bylo zavřeno.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Popisovač do nadřazeného okna modálního dialogového okna.

### <a name="remarks"></a>Poznámky

Tuto funkci volejte po zobrazení modálního dialogového okna. Tuto funkci je třeba zavolat, aby kontejner mohl povolit jakékoli Windows nejvyšší úrovně zakázané `PreModalDialog`. Tato funkce by měla být spárována s voláním `PreModalDialog`.

##  <a name="premodaldialog"></a>COleControl –::P reModalDialog

Upozorní kontejner, že se chystá zobrazení modálního dialogového okna.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Popisovač do nadřazeného okna modálního dialogového okna.

### <a name="remarks"></a>Poznámky

Před zobrazením modálního dialogového okna volejte tuto funkci. Tato funkce musí být volána, aby kontejner mohl zakázat všechna okna nejvyšší úrovně. Po zobrazení modálního dialogového okna musíte zavolat `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>COleControl –:: RecreateControlWindow

Zničí a znovu vytvoří okno ovládacího prvku.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Poznámky

To může být nutné v případě, že potřebujete změnit bity stylu okna.

##  <a name="refresh"></a>COleControl –:: Refresh

Vynutí překreslení ovládacího prvku OLE.

```
void Refresh();
```

### <a name="remarks"></a>Poznámky

Tato funkce je podporována `COleControl` základní třídou jako zásobovaná metoda, která se nazývá aktualizovat. To umožňuje uživatelům ovládacího prvku OLE překreslit ovládací prvek v určitou dobu. Další informace o této metodě naleznete v článku [ovládací prvky ActiveX: metody](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>COleControl –:: ReleaseCapture

Uvolňuje zachycení myši.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Pokud má ovládací prvek v současné době zachycení myši, zachytávání se uvolní. V opačném případě tato funkce nemá žádný vliv.

##  <a name="releasedc"></a>COleControl –:: ReleaseDC

Uvolní kontext zobrazovaného zařízení kontejneru řízení bez oken a uvolní kontext zařízení pro použití jinými aplikacemi.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Identifikuje kontext zařízení kontejneru, který se má uvolnit.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Aplikace musí volat `ReleaseDC` pro každé volání do [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>COleControl –:: ReparentControlWindow

Nastaví nadřazený ovládací prvek.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parametry

*hWndOuter*<br/>
Popisovač okna ovládacího prvku.

*hWndParent*<br/>
Popisovač nového nadřazeného okna.

### <a name="remarks"></a>Poznámky

Voláním této funkce resetujete nadřazené okno ovládacího prvku.

##  <a name="resetstockprops"></a>COleControl –:: ResetStockProps

Inicializuje stav `COleControl` uložených vlastností na jejich výchozí hodnoty.

```
void ResetStockProps();
```

### <a name="remarks"></a>Poznámky

Vlastnosti jsou: vzhled, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd a text. Popis uložených vlastností naleznete v tématu [ovládací prvky ActiveX: Přidání uložených vlastností](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Můžete zlepšit výkon binární inicializace ovládacího prvku pomocí `ResetStockProps` a `ResetVersion` přepsat `COleControl::OnResetState`. Viz následující příklad. Další informace o optimalizaci inicializace naleznete v tématu [ovládací prvky ActiveX: optimalizace](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Příklad

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>COleControl –:: ResetVersion

Inicializuje číslo verze na určenou hodnotu.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parametry

*dwVersionDefault*<br/>
Číslo verze, která má být přiřazena k ovládacímu prvku.

### <a name="remarks"></a>Poznámky

Můžete zlepšit výkon binární inicializace ovládacího prvku pomocí `ResetVersion` a `ResetStockProps` přepsat `COleControl::OnResetState`. Podívejte se na příklad na adrese [ResetStockProps](#resetstockprops). Další informace o optimalizaci inicializace naleznete v tématu [ovládací prvky ActiveX: optimalizace](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>COleControl –:: ScrollWindow

Umožňuje objektu OLE bez oken posouvání oblasti v rámci místní aktivní image na obrazovce.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*xAmount*<br/>
Určuje velikost vodorovného posouvání v jednotkách zařízení. Tento parametr musí být záporná hodnota pro posouvání doleva.

*yAmount*<br/>
Určuje velikost svislého posouvání v jednotkách zařízení. Tento parametr musí být záporná hodnota pro posouvání směrem nahoru.

*lpRect*<br/>
Odkazuje na objekt [CRect](../../atl-mfc-shared/reference/crect-class.md) nebo strukturu Rect, která určuje část klientské oblasti objektu OLE pro posouvání, v souřadnicích klienta obsahujícího okna. Pokud má *lpRect* hodnotu null, je posunuta celá klientská oblast objektu OLE.

*lpClipRect*<br/>
Odkazuje na objekt `CRect` nebo strukturu `RECT`, která určuje obdélník, ke kterému se má vystřihnout. Budou posunuty pouze pixely uvnitř obdélníku. Bity mimo obdélník nejsou ovlivněny ani v případě, že jsou v obdélníku *lpRect* . Pokud má *lpClipRect* hodnotu null, na posuvníku se neprovede žádné oříznutí.

##  <a name="selectfontobject"></a>COleControl –:: SelectFontObject

Vybere písmo v kontextu zařízení.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Ukazatel na objekt kontextu zařízení.

*fontHolder*<br/>
Odkaz na objekt [CFontHolder](../../mfc/reference/cfontholder-class.md) představující písmo, které má být vybráno.

### <a name="return-value"></a>Návratová hodnota

Ukazatel na dříve vybrané písmo. Když volající dokončí všechny operace kreslení, které používají *fontHolder,* měl by znovu vybrat dříve vybrané písmo tak, že ho předáte jako parametr pro [CDC:: VybratObjekt](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>COleControl –:: SelectStockFont

Vybere vlastnost písma zásob v kontextu zařízení.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Emulátor*<br/>
Kontext zařízení, do kterého bude písmo vybráno.

### <a name="return-value"></a>Návratová hodnota

Ukazatel na dříve vybraný objekt `CFont`. Po dokončení použijte příkaz [CDC:: VybratObjekt](../../mfc/reference/cdc-class.md#selectobject) k výběru tohoto písma zpátky do kontextu zařízení.

##  <a name="serializeextent"></a>COleControl –:: SerializeExtent

Zaserializace nebo inicializuje stav zobrazovaného prostoru přiděleného ovládacímu prvku.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*snížen*<br/>
Objekt `CArchive` k serializaci do nebo z.

### <a name="remarks"></a>Poznámky

Můžete zlepšit výkon binárního trvalosti ovládacího prvku pomocí `SerializeExtent`, `SerializeStockProps`a `SerializeVersion` přepsat `COleControl::Serialize`. Viz následující příklad. Další informace o optimalizaci inicializace naleznete v tématu [ovládací prvky ActiveX: optimalizace](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Příklad

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>COleControl –:: SerializeStockProps

Serializace nebo inicializuje stav `COleControl` uložených vlastností: vzhled, BackColor, BorderStyle, titulek, povoleno, písmo, ForeColor a text.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*snížen*<br/>
Objekt `CArchive` k serializaci do nebo z.

### <a name="remarks"></a>Poznámky

Popis uložených vlastností naleznete v tématu [ovládací prvky ActiveX: Přidání uložených vlastností](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Můžete zlepšit výkon binárního trvalosti ovládacího prvku pomocí `SerializeStockProps`, `SerializeExtent`a `SerializeVersion` přepsat `COleControl::Serialize`. Příklad naleznete v kódu na adrese [SerializeExtent](#serializeextent). Další informace o optimalizaci inicializace naleznete v tématu [ovládací prvky ActiveX: optimalizace](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>COleControl –:: SerializeVersion

Serializace nebo inicializuje stav informací o verzi ovládacího prvku.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*snížen*<br/>
Objekt `CArchive` k serializaci do nebo z.

*dwVersionDefault*<br/>
Aktuální číslo verze ovládacího prvku.

*bConvert*<br/>
Určuje, zda mají být trvalá data při uložení převedena do nejnovějšího formátu nebo udržována ve stejném formátu, v jakém byly načteny.

### <a name="return-value"></a>Návratová hodnota

Číslo verze ovládacího prvku. Pokud se načte zadaný archiv, `SerializeVersion` vrátí verzi načtenou z tohoto archivu. V opačném případě vrátí aktuálně načtenou verzi.

### <a name="remarks"></a>Poznámky

Můžete zlepšit výkon binárního trvalosti ovládacího prvku pomocí `SerializeVersion`, `SerializeExtent`a `SerializeStockProps` přepsat `COleControl::Serialize`. Příklad naleznete v kódu na adrese [SerializeExtent](#serializeextent). Další informace o optimalizaci inicializace naleznete v tématu [ovládací prvky ActiveX: optimalizace](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>COleControl –:: SetAppearance

Nastaví hodnotu vlastnosti burzovní vzhled ovládacího prvku.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parametry

*sAppearance*<br/>
**Krátká** hodnota (VT_I2), která se má použít pro vzhled ovládacího prvku. Hodnota 0 nastaví vzhled ovládacího prvku na plochý a hodnota 1 nastaví vzhled ovládacího prvku na 3D.

### <a name="remarks"></a>Poznámky

Další informace o uložených vlastnostech naleznete v tématu [ovládací prvky ActiveX: vlastnosti](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>COleControl –:: SetBackColor

Nastaví hodnotu vlastnosti Barva pozadí ovládacího prvku na zásobu.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parametry

*dwBackColor*<br/>
OLE_COLOR hodnota, která se má použít pro vykreslování ovládacího prvku na pozadí.

### <a name="remarks"></a>Poznámky

Další informace o použití této vlastnosti a dalších souvisejících vlastností naleznete v článku [ovládací prvky ActiveX: vlastnosti](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>COleControl –:: SetBorderStyle

Nastaví hodnotu vlastnosti okraje akcie ovládacího prvku.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parametry

*sBorderStyle*<br/>
Nový styl ohraničení ovládacího prvku; 0 znamená bez ohraničení a 1 označuje normální ohraničení.

### <a name="remarks"></a>Poznámky

Okno ovládacího prvku se pak znovu vytvoří a `OnBorderStyleChanged` se zavolá.

##  <a name="setcapture"></a>COleControl –:: SetCapture

Způsobí, že okno kontejneru ovládacího prvku provede zachycení myši jménem ovládacího prvku.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na objekt okna `CWnd`, který dříve přijal vstup myši.

### <a name="remarks"></a>Poznámky

Pokud je ovládací prvek aktivován a bez okna, tato funkce způsobí, že okno kontejneru ovládacího prvku provede zachycení myši, a to jménem ovládacího prvku. V opačném případě tato funkce způsobí, že ovládací prvek převezme zachycení myši (stejné jako `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>COleControl –:: SetControlSize

Nastaví velikost okna ovládacího prvku OLE a upozorní kontejner, který mění lokalita ovládacího prvku.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parametry

*CX*<br/>
Určuje novou šířku ovládacího prvku v pixelech.

*kr*<br/>
Určuje novou výšku ovládacího prvku v pixelech.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo volání úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tato funkce by neměla být použita v konstruktoru ovládacího prvku.

Všimněte si, že všechny souřadnice pro okna ovládacích prvků jsou relativní vzhledem k levému hornímu rohu ovládacího prvku.

##  <a name="setenabled"></a>COleControl –:: SetEnabled

Nastaví hodnotu vlastnosti povolenou pro datovou sadu ovládacího prvku.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parametry

*bEnabled*<br/>
TRUE, pokud má být ovládací prvek povolen; v opačném případě FALSE.

### <a name="remarks"></a>Poznámky

Po nastavení této vlastnosti se zavolá `OnEnabledChange`.

##  <a name="setfocus"></a>COleControl –:: SetFocus

Způsobí, že okno kontejneru ovládacího prvku převezme fokus vstupu v zastoupení ovládacího prvku.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na objekt okna `CWnd`, který dříve měl vstupní fokus, nebo hodnotu NULL, pokud takové okno neexistuje.

### <a name="remarks"></a>Poznámky

Pokud je ovládací prvek aktivován a bez okna, tato funkce způsobí, že okno kontejneru ovládacího prvku bude moci převzít fokus vstupu, a to jménem ovládacího prvku. Vstupní fokus směruje vstup z klávesnice do okna kontejneru a kontejner odesílá všechny následné zprávy klávesnice objektu OLE, který volá `SetFocus`. Jakékoli okno, které dříve mělo fokus vstupu, ztratí.

Pokud ovládací prvek není bez okna, tato funkce způsobí, že samotný ovládací prvek převezme fokus vstupu (totéž jako `CWnd::SetFocus`).

##  <a name="setfont"></a>COleControl –:: SetFont

Nastaví vlastnost burzovního písma vašeho ovládacího prvku.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parametry

*pFontDisp*<br/>
Ukazatel na rozhraní pro expedici písma.

##  <a name="setforecolor"></a>COleControl –:: SetForeColor

Nastaví hodnotu vlastnosti Barva ForeColor ovládacího prvku na burzovní.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parametry

*dwForeColor*<br/>
Hodnota OLE_COLOR, která se má použít pro vykreslování ovládacího prvku na popředí.

### <a name="remarks"></a>Poznámky

Další informace o použití této vlastnosti a dalších souvisejících vlastností naleznete v článku [ovládací prvky ActiveX: vlastnosti](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>COleControl –:: SetInitialDataFormats

Volá se rozhraním, aby se inicializoval seznam formátů dat, které ovládací prvek podporuje.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace určuje dva formáty: CF_METAFILEPICT a trvalou sadu vlastností.

##  <a name="setinitialsize"></a>COleControl –:: SetInitialSize

Nastaví velikost ovládacího prvku OLE při prvním zobrazení v kontejneru.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parametry

*CX*<br/>
Počáteční šířka ovládacího prvku OLE v pixelech

*kr*<br/>
Počáteční výška ovládacího prvku OLE v pixelech

### <a name="remarks"></a>Poznámky

Voláním této funkce v konstruktoru nastavte počáteční velikost ovládacího prvku. Počáteční velikost se měří v jednotkách zařízení nebo v pixelech. Doporučuje se, aby toto volání bylo provedeno v konstruktoru ovládacího prvku.

##  <a name="setmodifiedflag"></a>COleControl –:: SetModifiedFlag

Změní upravený stav ovládacího prvku.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parametry

*bModified*<br/>
Nová hodnota příznaku pro úpravu ovládacího prvku Hodnota TRUE označuje, že došlo ke změně stavu ovládacího prvku. Hodnota FALSE označuje, že byl stav ovládacího prvku právě uložen.

### <a name="remarks"></a>Poznámky

Tuto funkci volejte, když dojde ke změně, která by ovlivnila trvalý stav ovládacího prvku. Například pokud se změní hodnota trvalé vlastnosti, zavolejte tuto funkci s *bModified* **true**.

##  <a name="setnotpermitted"></a>COleControl –:: SetNotPermitted

Indikuje, že žádost o úpravu se nezdařila.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Poznámky

Tuto funkci volejte, když `BoundPropertyRequestEdit` selžou. Tato funkce vyvolá výjimku typu `COleDispScodeException` pro indikaci, že operace set nebyla povolena.

##  <a name="setnotsupported"></a>COleControl –:: SetNotSupported

Brání uživateli v úpravách hodnoty vlastnosti ovládacího prvku.

```
void SetNotSupported();
```

### <a name="remarks"></a>Poznámky

Volání této funkce namísto funkce Set u jakékoli vlastnosti, kde změna hodnoty vlastnosti uživatelem ovládacího prvku není podporována. Jedním z příkladů může být vlastnost, která je jen pro čtení.

##  <a name="setrectincontainer"></a>COleControl –:: SetRectInContainer

Nastaví souřadnice obdélníku ovládacího prvku vzhledem ke kontejneru vyjádřené v jednotkách zařízení.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Ukazatel na obdélník obsahující nové souřadnice ovládacího prvku vzhledem ke kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo volání úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Pokud je ovládací prvek otevřen, změní se jeho velikost. v opačném případě se zavolá funkce `OnPosRectChanged` kontejneru.

##  <a name="settext"></a>COleControl –:: SetText

Nastaví hodnotu vlastnosti titulkového titulu nebo textu ovládacího prvku.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parametry

*pszText*<br/>
Ukazatel na řetězec znaků.

### <a name="remarks"></a>Poznámky

Všimněte si, že burzovní popisky a vlastnosti textu jsou namapovány na stejnou hodnotu. To znamená, že všechny změny provedené u obou vlastností budou automaticky měnit obě vlastnosti. Obecně platí, že ovládací prvek by měl podporovat buď vlastnost titulku nebo text, ale ne obojí.

##  <a name="throwerror"></a>COleControl –:: ThrowError

Signalizuje výskyt chyby ve vašem ovládacím prvku.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*příkaz*<br/>
Hodnota stavového kódu, který se má ohlásit Úplný seznam možných kódů naleznete v článku [ovládací prvky ActiveX: Pokročilá témata](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
ID prostředku řetězce výjimky, která má být hlášena.

*nHelpID*<br/>
ID nápovědy k tématu, které má být oznámeno.

*pszDescription*<br/>
Řetězec obsahující vysvětlení výjimky, která má být hlášena.

### <a name="remarks"></a>Poznámky

Tato funkce by měla být volána pouze v rámci funkce Get nebo set pro vlastnost OLE nebo implementaci metody automatizace OLE. Pokud potřebujete signalizovat chyby, ke kterým dochází v jiné době, měli byste vyvolat událost s chybou akcie.

##  <a name="transformcoords"></a>COleControl –:: TransformCoords

Transformuje hodnoty souřadnic mezi HIMETRIC jednotkami a nativními jednotkami kontejneru.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parametry

*lpptlHimetric*<br/>
Ukazatel na strukturu `POINTL` obsahující souřadnice v jednotkách HIMETRIC

*lpptfContainer*<br/>
Ukazatel na strukturu `POINTF` obsahující souřadnice v velikosti jednotky kontejneru.

*Flag*<br/>
Kombinace následujících hodnot:

- XFORMCOORDS_POSITION pozici v kontejneru.

- XFORMCOORDS_SIZE velikost v kontejneru.

- XFORMCOORDS_HIMETRICTOCONTAINER transformovat jednotky HIMETRIC na jednotky kontejneru.

- XFORMCOORDS_CONTAINERTOHIMETRIC transformovat jednotky kontejneru na jednotky HIMETRIC.

### <a name="remarks"></a>Poznámky

První dva příznaky XFORMCOORDS_POSITION a XFORMCOORDS_SIZE označují, zda by měly být souřadnice považovány za pozici nebo velikost. Zbývající dva příznaky označují směr transformace.

##  <a name="translatecolor"></a>COleControl –:: TranslateColor

Převede hodnotu barvy z OLE_COLOR datového typu na datový typ [COLORREF](/windows/win32/gdi/colorref) .

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parametry

*clrColor*<br/>
OLE_COLOR datový typ. Další informace najdete v tématu funkce Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) .

*hpal*<br/>
Popisovač k volitelné paletě. může mít hodnotu NULL.

### <a name="return-value"></a>Návratová hodnota

Hodnota barevné barvy RGB (červená, zelená, modrá 32), která definuje plnou barvu nejbližší hodnotě *clrColor* , kterou může zařízení reprezentovat.

### <a name="remarks"></a>Poznámky

Tato funkce je užitečná pro přeložení vlastností barva barva barvy barvy a pozadí na COLORREF typy používané členskými funkcemi [CDC](../../mfc/reference/cdc-class.md) .

##  <a name="willambientsbevalidduringload"></a>COleControl –:: WillAmbientsBeValidDuringLoad

Určuje, zda má ovládací prvek použít hodnoty vlastností okolí jako výchozí hodnoty, pokud je následně načten z jeho trvalého stavu.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové znamená, že vlastnosti okolí budou platné; v opačném případě vlastnosti okolí nebudou platné.

### <a name="remarks"></a>Poznámky

V některých kontejnerech může mít ovládací prvek během počátečního volání přepsaného `COleControl::DoPropExchange`mít přístup k jeho okolním vlastnostem. Jedná se o případ, že kontejner volá [IPersistStreamInit:: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) nebo [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) před voláním [IOleObject:: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (to znamená, pokud nedodržuje stavový bit OLEMISC_SETCLIENTSITEFIRST).

##  <a name="windowproc"></a>COleControl –:: WindowProc

Poskytuje proceduru Windows pro objekt `COleControl`.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametry

*message*<br/>
Určuje zprávu Windows, která se má zpracovat.

*wParam*<br/>
Poskytuje další informace, které se používají při zpracování zprávy. Hodnota parametru závisí na zprávě.

*lParam*<br/>
Poskytuje další informace, které se používají při zpracování zprávy. Hodnota parametru závisí na zprávě.

### <a name="return-value"></a>Návratová hodnota

Návratová hodnota zprávy byla odeslána.

### <a name="remarks"></a>Poznámky

Voláním této funkce odešlete konkrétní zprávy přes mapu zprávy ovládacího prvku.

## <a name="see-also"></a>Viz také

[CIRC3 Sample MFC](../../overview/visual-cpp-samples.md)<br/>
[TESTHELP Sample MFC](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage – třída](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd – třída](../../mfc/reference/cwnd-class.md)<br/>
[Graf hierarchie](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder – třída](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder – třída](../../mfc/reference/cpictureholder-class.md)<br/>
