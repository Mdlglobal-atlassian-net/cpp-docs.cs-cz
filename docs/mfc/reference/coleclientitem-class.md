---
title: COleClientItem – třída
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 4a4492e168d36b114811192c8a5c341a62c156ad
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/15/2019
ms.locfileid: "69504379"
---
# <a name="coleclientitem-class"></a>COleClientItem – třída

Definuje rozhraní kontejneru pro položky OLE.

## <a name="syntax"></a>Syntaxe

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Členové

### <a name="public-constructors"></a>Veřejné konstruktory

|Name|Popis|
|----------|-----------------|
|[COleClientItem:: COleClientItem](#coleclientitem)|`COleClientItem` Vytvoří objekt.|

### <a name="public-methods"></a>Veřejné metody

|Name|Popis|
|----------|-----------------|
|[COleClientItem:: Activate](#activate)|Otevře položku OLE pro operaci a pak provede určenou operaci.|
|[COleClientItem:: ActivateAs](#activateas)|Aktivuje položku jako jiný typ.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Přistupuje k datům v objektu OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Označuje, zda kontejnerová aplikace může vytvořit vložený objekt.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Označuje, zda kontejnerová aplikace může vytvořit propojený objekt.|
|[COleClientItem:: CanPaste](#canpaste)|Označuje, zda schránka obsahuje vloženou nebo statickou položku OLE.|
|[COleClientItem:: CanPasteLink](#canpastelink)|Označuje, zda schránka obsahuje položku OLE, kterou se propojí.|
|[COleClientItem:: Close](#close)|Zavře odkaz na server, ale nezničí položku OLE.|
|[COleClientItem::ConvertTo](#convertto)|Převede položku na jiný typ.|
|[COleClientItem:: CopyToClipboard](#copytoclipboard)|Zkopíruje položku OLE do schránky.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Vytvoří duplikát existující položky.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Vytvoří ze schránky vloženou položku.|
|[COleClientItem::CreateFromData](#createfromdata)|Vytvoří vloženou položku z datového objektu.|
|[COleClientItem::CreateFromFile](#createfromfile)|Vytvoří vloženou položku ze souboru.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Vytvoří propojenou položku ze schránky.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Vytvoří propojenou položku z datového objektu.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Vytvoří propojenou položku ze souboru.|
|[COleClientItem::CreateNewItem](#createnewitem)|Vytvoří novou vloženou položku spuštěním serverové aplikace.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Vytvoří statickou položku ze schránky.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Vytvoří statickou položku z datového objektu.|
|[COleClientItem::D eactivate](#deactivate)|Deaktivuje položku.|
|[COleClientItem::D eactivateUI](#deactivateui)|Obnoví uživatelské rozhraní aplikace kontejneru do původního stavu.|
|[COleClientItem::D dstranit](#delete)|Odstraní nebo zavře položku OLE, pokud se jednalo o propojenou položku.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Provede operaci přetažení.|
|[COleClientItem::DoVerb](#doverb)|Provede zadanou operaci.|
|[COleClientItem: nezpracované:D](#draw)|Nakreslí položku OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Získá zobrazení, ve kterém je položka aktivována.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Vrátí hranice obdélníku položky OLE.|
|[COleClientItem:: GetClassID](#getclassid)|Získá ID třídy této položky.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Načte data, která se umístí do schránky, voláním `CopyToClipboard` členské funkce.|
|[COleClientItem::GetDocument](#getdocument)|`COleDocument` Vrátí objekt, který obsahuje aktuální položku.|
|[COleClientItem:: GetDrawAspect](#getdrawaspect)|Získá aktuální zobrazení položky pro vykreslení.|
|[COleClientItem:: getrozsah](#getextent)|Vrátí hranice obdélníku položky OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Načte popisovač na ikonu přidruženou k serveru konkrétního identifikátoru CLSID.|
|[COleClientItem:: GetIconicMetafile](#geticonicmetafile)|Získá metasoubor používaný k vykreslení ikony položky.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Vrátí ukazatel na místní okno pro úpravu položky.|
|[COleClientItem:: GetItemState](#getitemstate)|Získá aktuální stav položky.|
|[COleClientItem:: GetLastStatus](#getlaststatus)|Vrátí stav poslední operace OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Vrátí režim aktualizace pro propojenou položku (Pokročilá funkce).|
|[COleClientItem::GetType](#gettype)|Vrátí typ (integrovaný, propojený nebo statický) položky OLE.|
|[COleClientItem::GetUserType](#getusertype)|Získá řetězec popisující typ položky.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Vrátí hodnotu TRUE, pokud je položka na místě aktivní.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Vrátí hodnotu TRUE, pokud je propojená položka v aktuálním stavu pomocí zdrojového dokumentu.|
|[COleClientItem::IsModified](#ismodified)|Vrátí hodnotu pravda, pokud byla položka změněna od posledního uložení.|
|[COleClientItem::IsOpen](#isopen)|Vrátí hodnotu TRUE, pokud je položka aktuálně otevřena v serverové aplikaci.|
|[COleClientItem:: inrunning](#isrunning)|Vrátí hodnotu TRUE, pokud je spuštěna serverová aplikace položky.|
|[COleClientItem:: Activate](#onactivate)|Volá se rozhraním, aby se upozornilo na položku, která je aktivovaná.|
|[COleClientItem:: OnActivateUI](#onactivateui)|Volá se rozhraním, aby se upozornila na položku, která je aktivovaná, a měla by zobrazovat své uživatelské rozhraní.|
|[COleClientItem::OnChange](#onchange)|Volá se, když Server změní položku OLE. Vyžaduje se implementace.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Volá se rozhraním, když se položka deaktivuje.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Volá se rozhraním, když server odebral své místní uživatelské rozhraní.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Volá se rozhraním, aby se mohla zkopírovat data do schránky.|
|[COleClientItem:: OnInsertMenus](#oninsertmenus)|Volá se rozhraním, aby se vytvořila složená nabídka.|
|[COleClientItem:: OnRemoveMenus](#onremovemenus)|Volá se rozhraním, aby se odebraly nabídky kontejneru ze složené nabídky.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Volá se rozhraním, aby se nainstalovala a odebrala složená nabídka.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Volá se rozhraním, aby se zobrazily nebo skryly ovládací panely.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Volá se rozhraním, aby se aktualizovalo záhlaví okna rámce.|
|[COleClientItem:: ReactivateAndUndo](#reactivateandundo)|Znovu aktivuje položku a vrátí poslední místní operaci úprav.|
|[COleClientItem:: Release](#release)|Uvolní připojení k propojené položce OLE a zavře je, pokud byla otevřená. Nezničí položku klienta.|
|[COleClientItem:: reload](#reload)|Znovu načte položku po volání `ActivateAs`.|
|[COleClientItem:: Run](#run)|Spustí aplikaci přidruženou k položce.|
|[COleClientItem:: SetDrawAspect](#setdrawaspect)|Nastaví aktuální zobrazení položky pro vykreslování.|
|[COleClientItem:: SetExtent](#setextent)|Nastaví ohraničující obdélník položky OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Nastaví názvy, které server zobrazuje při úpravách položky OLE.|
|[COleClientItem:: SetIconicMetafile](#seticonicmetafile)|Ukládá do mezipaměti metasoubor používaný k vykreslení ikony položky.|
|[COleClientItem:: SetItemRects](#setitemrects)|Nastaví ohraničovací obdélník položky.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Nastaví režim aktualizace pro propojenou položku (Pokročilá funkce).|
|[COleClientItem:: SetPrintDevice](#setprintdevice)|Nastaví pro tuto položku klienta zařízení cíle tisku.|
|[COleClientItem::UpdateLink](#updatelink)|Aktualizuje mezipaměť prezentace položky.|

### <a name="protected-methods"></a>Chráněné metody

|Name|Popis|
|----------|-----------------|
|[COleClientItem:: CanActivate](#canactivate)|Volá se rozhraním, aby se zjistilo, jestli je povolená místní aktivace.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Volá se rozhraním, když se změní pozice položky.|
|[COleClientItem:: OnDeactivateAndUndo](#ondeactivateandundo)|Volá se rozhraním, aby se po aktivaci vrátilo zpátky.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Volá se rozhraním, aby se zahozena zpětná informace o stavu položky.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Volá se rozhraním, aby se získaly souřadnice ořezového rámečku položky.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Volá se rozhraním, aby se získala pozice položky relativně vzhledem k zobrazení.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Volá se rozhraním, když se aktivuje položka.|
|[COleClientItem:: OnScrollBy](#onscrollby)|Volá se rozhraním, aby se položka přesunula na zobrazení.|
|[COleClientItem:: OnShowItem](#onshowitem)|Volá se rozhraním, aby se zobrazila položka OLE.|

## <a name="remarks"></a>Poznámky

Položka OLE představuje data vytvořená a udržovaná serverovou aplikací, která může být "bez problémů" začleněná do dokumentu, aby se zobrazila jako jeden dokument. Výsledkem je složený dokument, který se skládá z položky OLE a obsahujícího dokumentu.

Položka OLE může být buď vložená, nebo propojená. Pokud je vložená, data se ukládají jako součást složeného dokumentu. Pokud je propojena, uloží se data jako součást samostatného souboru vytvořeného serverovou aplikací a pouze odkaz na tento soubor je uložen ve složeném dokumentu. Všechny položky OLE obsahují informace určující serverovou aplikaci, která se má volat pro jejich úpravu.

`COleClientItem`definuje několik přepisovatelných funkcí, které jsou volány v reakci na požadavky ze serverové aplikace. Tyto k přepisovatelným obvykle fungují jako oznámení. Tím umožníte, aby serverová aplikace informovala kontejner o změnách, které uživatel provede při úpravách položky OLE, nebo k načtení informací potřebných během úprav.

`COleClientItem`lze použít buď s třídou [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)nebo [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) . Chcete- `COleClientItem`li použít, odvodit z něj třídu a [](#onchange) implementovat členskou funkci s příponou, která definuje, jak kontejner reaguje na změny provedené u položky. Pro podporu místní aktivace přepište členskou funkci [OnGetItemPosition](#ongetitemposition) . Tato funkce poskytuje informace o zobrazené pozici položky OLE.

Další informace o použití rozhraní kontejneru najdete v kontejnerech článků [: Implementace kontejneru](../../mfc/containers-implementing-a-container.md) a [Aktivace](../../mfc/activation-cpp.md).

> [!NOTE]
>  Windows SDK odkazuje na vložené a propojené položky jako "objekty" a odkazuje na typy položek jako "třídy". Tento odkaz používá termín "Item" pro odlišení entity OLE od odpovídajícího C++ objektu a podmínky "Type" pro odlišení kategorie OLE od C++ třídy.

## <a name="inheritance-hierarchy"></a>Hierarchie dědičnosti

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Požadavky

**Záhlaví:** AFXOLE. h

##  <a name="activate"></a>COleClientItem:: Activate

Voláním této funkce spustíte určenou operaci namísto [DoVerb](#doverb) , abyste mohli provádět vlastní zpracování, pokud je vyvolána výjimka.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Určuje operaci, která má být provedena. Může být jeden z následujících akcí:

|Value|Význam|Písmeno|
|-----------|-------------|------------|
|- 0|primární požadavek|OLEIVERB_PRIMARY|
|- 1|Sekundární příkaz|NTato|
|- 1|Zobrazit položku pro úpravy|OLEIVERB_SHOW|
|- 2|Upravit položku v samostatném okně|OLEIVERB_OPEN|
|- 3|Skrýt položku|OLEIVERB_HIDE|

Hodnota-1 je obvykle alias pro jinou operaci. Pokud není podporováno otevírání úprav, má-2 stejný účinek jako-1. Další hodnoty naleznete v tématu [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) v Windows SDK.

*pView*<br/>
Ukazatel na okno zobrazení kontejneru, které obsahuje položku OLE; tuto hodnotu používá serverová aplikace pro místní aktivaci. Tento parametr by měl mít hodnotu NULL, pokud kontejner nepodporuje místní aktivaci.

*lpMsg*<br/>
Ukazatel na zprávu, která způsobila aktivaci položky.

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace napsána pomocí knihovna Microsoft Foundation Class, tato funkce způsobí provedení [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) členské funkce odpovídajícího `COleServerItem` objektu.

Pokud je primární příkaz Edit a v parametru *nVerb* je zadáno nula, je spuštěna serverová aplikace, aby bylo možné upravovat položku OLE. Pokud aplikace kontejneru podporuje místní aktivaci, lze úpravy provést na místě. Pokud kontejner nepodporuje místní aktivaci (nebo pokud je zadána otevřená operace), server se spustí v samostatném okně a v takovém případě je možné provést úpravy. V případě, že uživatel aplikace typu kontejner dvakrát klikne na položku OLE, určuje hodnota pro primární příkaz v parametru *nVerb* akci, kterou může uživatel provést. Pokud však server podporuje pouze jednu akci, provede tuto akci bez ohledu na to, která hodnota je uvedena v parametru *nVerb* .

Další informace najdete v tématu [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) v Windows SDK.

##  <a name="activateas"></a>COleClientItem:: ActivateAs

Používá funkce převodu objektů OLE k aktivaci položky, jako by šlo o položku typu určenou parametrem *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*lpszUserType*<br/>
Ukazatel na řetězec představující cílový typ uživatele, například wordový dokument.

*clsidOld*<br/>
Odkaz na ID aktuální třídy položky ID třídy by mělo představovat typ skutečného objektu, jak je uloženo, pokud se nejedná o odkaz. V takovém případě by měl být identifikátor CLSID položky, na kterou odkaz odkazuje. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) automaticky poskytuje správné ID třídy pro položku.

*clsidNew*<br/>
Odkaz na ID cílové třídy.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tento název je automaticky volán [COleConvertDialog::D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Obvykle se nevolá přímo.

##  <a name="attachdataobject"></a>COleClientItem:: AttachDataObject

Voláním této funkce inicializujete [COleDataObject](../../mfc/reference/coledataobject-class.md) pro přístup k datům v položce OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametry

*rDataObject*<br/>
Odkaz na `COleDataObject` objekt, který bude inicializován, aby povoloval přístup k datům v položce OLE.

##  <a name="canactivate"></a>COleClientItem:: CanActivate

Volá se rozhraním, když uživatel požaduje místní aktivaci položky OLE. Vrácená hodnota funkce určuje, jestli je povolená místní aktivace.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je povolená místní aktivace; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace umožňuje místní aktivaci, pokud má kontejner platné okno. Přepište tuto funkci, pokud chcete implementovat speciální logiku pro přijetí nebo odmítnutí žádosti o aktivaci. Například žádost o aktivaci může být odmítnuta v případě, že je položka OLE příliš malá nebo není aktuálně viditelná.

Další informace naleznete v tématu [IOleInPlaceSite:: CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) v Windows SDK.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Kontroluje, zda kontejnerová aplikace může vytvořit vložený objekt z daného `COleDataObject` objektu.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel na objekt [COleDataObject](../../mfc/reference/coledataobject-class.md) , ze kterého má být vytvořena položka OLE.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud kontejner může vytvořit vložený objekt z `COleDataObject` objektu; v opačném případě 0.

### <a name="remarks"></a>Poznámky

`COleDataObject` Třída se používá v přenosech dat pro načítání dat v různých formátech ze schránky, prostřednictvím přetažení nebo z vložené položky OLE.

Kontejnery mohou tuto funkci použít k rozhodnutí povolit nebo zakázat speciální příkazy pro vložení a úpravu vložení.

Další informace najdete v článku [datové objekty a zdroje dat (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Kontroluje, zda kontejnerová aplikace může vytvořit propojený objekt z daného `COleDataObject` objektu.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel na objekt [COleDataObject](../../mfc/reference/coledataobject-class.md) , ze kterého má být vytvořena položka OLE.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud kontejner může vytvořit propojený objekt z `COleDataObject` objektu.

### <a name="remarks"></a>Poznámky

`COleDataObject` Třída se používá v přenosech dat pro načítání dat v různých formátech ze schránky, prostřednictvím přetažení nebo z vložené položky OLE.

Kontejnery mohou tuto funkci použít k rozhodnutí povolit nebo zakázat příkazy pro vložení a vložení odkazu pro vložení.

Další informace najdete v článku [datové objekty a zdroje dat (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>COleClientItem:: CanPaste

Voláním této funkce zjistíte, zda vložená položka OLE může být vložena ze schránky.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud vložená položka OLE může být vložena ze schránky; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Další informace najdete v tématu [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) a [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) v Windows SDK.

##  <a name="canpastelink"></a>COleClientItem:: CanPasteLink

Voláním této funkce zjistíte, zda propojenou položku OLE lze vložit ze schránky.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud propojenou položku OLE lze vložit ze schránky; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Další informace najdete v tématu [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) a [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) v Windows SDK.

##  <a name="close"></a>COleClientItem:: Close

Voláním této funkce změníte stav položky OLE ze stavu spuštěno na načtený stav, který je načten s jeho obslužnou rutinou v paměti, ale na serveru není spuštěn.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Příznak určující, za jakých okolností se položka OLE uloží při návratu do načteného stavu. Může mít jednu z následujících hodnot:

- OLECLOSE_SAVEIFDIRTY uložte položku OLE.

- OLECLOSE_NOSAVE Neukládat položku OLE.

- OLECLOSE_PROMPTSAVE vyzve uživatele, zda má být položka OLE uložena.

### <a name="remarks"></a>Poznámky

Tato funkce nemá žádný vliv, pokud není spuštěná položka OLE.

Další informace najdete v tématu [IOleObject:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) v Windows SDK.

##  <a name="coleclientitem"></a>COleClientItem:: COleClientItem

Vytvoří objekt a přidá jej do kolekce položek dokumentu kontejneru kontejneru, která vytvoří pouze C++ objekt a neprovádí žádnou inicializaci technologie OLE. `COleClientItem`

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametry

*pContainerDoc*<br/>
Ukazatel na kontejnerový dokument, který bude obsahovat tuto položku. Může to být jakýkoli [COleDocument](../../mfc/reference/coledocument-class.md) odvozený.

### <a name="remarks"></a>Poznámky

Pokud předáte ukazatel s hodnotou NULL, není provedeno žádné přidání do kontejneru dokumentů. Musíte explicitně zavolat [COleDocument:: AddItem](../../mfc/reference/coledocument-class.md#additem).

Než použijete položku OLE, je nutné zavolat jednu z následujících funkcí členů:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>COleClientItem:: ConvertTo

Zavolejte tuto členskou funkci pro převedení položky na typ určený parametrem *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*clsidNew*<br/>
ID třídy cílového typu.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tato metoda je automaticky volána nástrojem [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Není nutné volat ji přímo.

##  <a name="copytoclipboard"></a>COleClientItem:: CopyToClipboard

Voláním této funkce zkopírujte položku OLE do schránky.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
TRUE, pokud mají být do schránky zkopírovány informace o propojení, což umožní vložení propojené položky; v opačném případě FALSE.

### <a name="remarks"></a>Poznámky

Obvykle zavoláte tuto funkci při psaní obslužných rutin zpráv pro příkazy Kopírovat nebo vyjmout z nabídky upravit. Je nutné implementovat výběr položky v aplikaci kontejneru, pokud chcete implementovat příkazy Copy nebo vyjmout.

Další informace najdete v tématu [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) v Windows SDK.

##  <a name="createclonefrom"></a>COleClientItem:: CreateCloneFrom

Voláním této funkce vytvoříte kopii zadané položky OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametry

*pSrcItem*<br/>
Ukazatel na položku OLE, která má být duplikována.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Kopie je shodná se zdrojovou položkou. Tuto funkci můžete použít pro podporu operací vrácení zpět.

##  <a name="createfromclipboard"></a>COleClientItem:: CreateFromClipboard

Voláním této funkce vytvoříte vloženou položku z obsahu schránky.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tuto funkci obvykle vyvoláte z obslužné rutiny zprávy pro příkaz Vložit v nabídce Upravit. (Příkaz pro vložení je povolen rozhraním, pokud členská funkce [CanPaste](#canpaste) vrátí nenulovou hodnotu.)

Další informace najdete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Voláním této funkce vytvoříte vloženou položku z `COleDataObject` objektu.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel na objekt [COleDataObject](../../mfc/reference/coledataobject-class.md) , ze kterého má být vytvořena položka OLE.

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Operace přenosu dat, jako je vložení ze schránky nebo operace přetažení, poskytují `COleDataObject` objekty obsahující informace, které nabízí serverová aplikace. Obvykle se používá v přepsání [: CView:: drop](../../mfc/reference/cview-class.md#ondrop).

Další informace naleznete v tématu [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createfromfile"></a>COleClientItem:: CreateFromFile

Voláním této funkce vytvoříte vloženou položku OLE ze souboru.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Ukazatel na název souboru, ze kterého má být vytvořena položka OLE.

*CLSID*<br/>
Vyhrazeno pro budoucí použití.

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Rozhraní volá tuto funkci z [COleInsertDialog:: CreateItem –](../../mfc/reference/coleinsertdialog-class.md#createitem) , pokud uživatel zvolí tlačítko OK v dialogovém okně Vložit objekt, když je vybráno tlačítko vytvořit ze souboru.

Další informace naleznete v tématu [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createlinkfromclipboard"></a>COleClientItem:: CreateLinkFromClipboard

Voláním této funkce vytvoříte propojenou položku z obsahu schránky.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tuto funkci obvykle vyvoláte z obslužné rutiny zprávy pro příkaz Vložit odkaz v nabídce Upravit. (Příkaz Vložit odkaz je povolen ve výchozí implementaci [COleDocument](../../mfc/reference/coledocument-class.md) , Pokud schránka obsahuje položku OLE, na kterou lze vytvořit propojení.)

Další informace najdete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Voláním této funkce vytvoříte propojenou položku z `COleDataObject` objektu.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel na objekt [COleDataObject](../../mfc/reference/coledataobject-class.md) , ze kterého má být vytvořena položka OLE.

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tuto metodu zavolejte během operace přetažení, když uživatel indikuje, že má být vytvořen odkaz. Dá se použít také k zpracování příkazu pro úpravu vložení. Je volána rozhraním v `COleClientItem::CreateLinkFromClipboard` a v [COlePasteSpecialDialog:: CreateItem –](../../mfc/reference/colepastespecialdialog-class.md#createitem) , pokud byla vybrána možnost Link.

Další informace naleznete v tématu [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Voláním této funkce vytvoříte propojenou položku OLE ze souboru.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Ukazatel na název souboru, ze kterého má být vytvořena položka OLE.

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Rozhraní volá tuto funkci, pokud uživatel zvolí možnost OK v dialogovém okně Vložit objekt, když je vybráno tlačítko vytvořit ze souboru a políčko odkaz je zaškrtnuté. Je volána z [COleInsertDialog:: CreateItem –](../../mfc/reference/coleinsertdialog-class.md#createitem).

Další informace naleznete v tématu [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createnewitem"></a>COleClientItem:: CreateNewItem

Voláním této funkce vytvoříte vloženou položku. Tato funkce spustí serverovou aplikaci, která umožňuje uživateli vytvořit položku OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*CLSID*<br/>
ID, které jednoznačně identifikuje typ položky OLE, která se má vytvořit.

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Rozhraní volá tuto funkci, pokud uživatel zvolí tlačítko OK v dialogovém okně Vložit objekt, když je vybráno tlačítko vytvořit nový.

Další informace naleznete v tématu [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createstaticfromclipboard"></a>COleClientItem:: CreateStaticFromClipboard

Voláním této funkce vytvoříte statickou položku z obsahu schránky.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Statická položka obsahuje data prezentace, ale ne nativní data; Proto jej nelze upravit. Tato funkce se obvykle volá, pokud se členská funkce [CreateFromClipboard](#createfromclipboard) nezdařila.

Další informace najdete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Voláním této funkce vytvoříte statickou položku z `COleDataObject` objektu.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel na objekt [COleDataObject](../../mfc/reference/coledataobject-class.md) , ze kterého má být vytvořena položka OLE.

*činit*<br/>
Příznak určující, jak bude server vykreslovat položku OLE Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky, který má být ukládán do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na strukturu [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , která se používá v případě, že je *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu za formát schránky určený parametrem *cfFormat*. Pokud tento parametr vynecháte, použijí se výchozí hodnoty pro ostatní pole ve `FORMATETC` struktuře.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Statická položka obsahuje data prezentace, ale ne nativní data; v důsledku toho jej nelze upravovat. To je v podstatě totéž jako [CreateStaticFromClipboard](#createstaticfromclipboard) s tím rozdílem, že statickou položku lze vytvořit z libovolného `COleDataObject`, nikoli pouze ze schránky.

Používá se v [COlePasteSpecialDialog:: CreateItem –](../../mfc/reference/colepastespecialdialog-class.md#createitem) , pokud je vybraná možnost static.

Další informace naleznete v tématu [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v Windows SDK.

##  <a name="deactivate"></a>COleClientItem::D eactivate

Voláním této funkce dezaktivujete položku OLE a uvolníte všechny přidružené prostředky.

```
void Deactivate();
```

### <a name="remarks"></a>Poznámky

Obvykle deaktivujete místní aktivní položku OLE, když uživatel klikne na myš v klientské oblasti mimo hranice položky. Všimněte si, že deaktivace položky OLE zruší svůj stav vrácení zpět, což znemožňuje volání členské funkce [ReactivateAndUndo](#reactivateandundo) .

Pokud vaše aplikace podporuje vrácení zpět, Nevolejte `Deactivate`; namísto toho zavolejte [DeactivateUI](#deactivateui).

Další informace naleznete v tématu [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) v Windows SDK.

##  <a name="deactivateui"></a>COleClientItem::D eactivateUI

Tuto funkci volejte, když uživatel deaktivuje položku, která byla aktivována na místě.

```
void DeactivateUI();
```

### <a name="remarks"></a>Poznámky

Tato funkce obnoví uživatelské rozhraní aplikace typu kontejner do původního stavu, skryje všechny nabídky a další ovládací prvky, které byly vytvořeny pro místní aktivaci.

Tato funkce nevyprazdňuje informace o stavu vrácení zpět pro položku. Tyto informace jsou zachovány, aby [ReactivateAndUndo](#reactivateandundo) mohl být později použit ke spuštění příkazu zpět v serverové aplikaci, pro případ, že je vybrán příkaz pro vrácení kontejneru ihned po deaktivaci položky.

Další informace naleznete v tématu [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) v Windows SDK.

##  <a name="delete"></a>COleClientItem::D dstranit

Voláním této funkce odstraníte položku OLE z dokumentu kontejneru.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametry

*bAutoDelete*<br/>
Určuje, zda má být položka z dokumentu odebrána.

### <a name="remarks"></a>Poznámky

Tato funkce volá členskou funkci [release](#release) , která zase odstraní C++ objekt pro položku a trvale odebere položku OLE z dokumentu. Pokud je položka OLE vložena, jsou odstraněna nativní data pro položku. Vždycky zavírá běžící Server. Proto pokud je položka otevřený odkaz, tato funkce ji uzavře.

##  <a name="dodragdrop"></a>COleClientItem::D oDragDrop

Chcete-li provést operaci přetažení, zavolejte členskoufunkci.`DoDragDrop`

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametry

*lpItemRect*<br/>
Obdélník položky na obrazovce v souřadnicích klienta (pixely).

*ptOffset*<br/>
Posun od *lpItemRect* , kde byla pozice myši v době tažení.

*bIncludeLink*<br/>
Nastavte tuto hodnotu na TRUE, pokud se mají data odkazu zkopírovat do schránky. Nastavte na hodnotu FALSE, pokud serverová aplikace nepodporuje odkazy.

*dwEffects*<br/>
Určuje efekty, které bude zdroj přetažení umožňovat v operaci přetažení.

*lpRectStartDrag*<br/>
Ukazatel na obdélník, který definuje, kde se má skutečně začít přetahování. Další informace naleznete v následující části poznámky.

### <a name="return-value"></a>Návratová hodnota

Hodnota DROPEFFECT Pokud je DROPEFFECT_MOVE, měla by se odebrat původní data.

### <a name="remarks"></a>Poznámky

Operace přetažení se nespustí okamžitě. Počká, dokud ukazatel myši neopustí obdélník určený parametrem *lpRectStartDrag* , nebo dokud neuplyne zadaný počet milisekund. Pokud má *lpRectStartDrag* hodnotu null, je velikost obdélníku jeden pixel.

Doba zpoždění je určena nastavením klíče registru. Dobu zpoždění můžete změnit voláním [CWinApp:: WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) nebo [CWinApp:: WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Pokud nezadáte dobu zpoždění, použije se výchozí hodnota 200 milisekund. Čas zpoždění při přetahování je uložený takto:

- Čas zpoždění při přetahování Windows NT je uložený v HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Čas zpoždění při přetahování Windows 3. x je uložený v souboru WIN. Soubor INI, v části [Windows}.

- Čas zpoždění při přetahování Windows 95/98 je uložený ve verzi WIN uložené v mezipaměti. Užívaný.

Další informace o tom, jak jsou informace o zpoždění při přetahování uloženy v registru nebo v. Soubor INI, viz [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) v Windows SDK.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Zavolá `DoVerb` se, aby se spustila Zadaná operace.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Určuje operaci, která má být provedena. Může zahrnovat jednu z následujících možností:

|Value|Význam|Písmeno|
|-----------|-------------|------------|
|- 0|primární požadavek|OLEIVERB_PRIMARY|
|- 1|Sekundární příkaz|NTato|
|- 1|Zobrazit položku pro úpravy|OLEIVERB_SHOW|
|- 2|Upravit položku v samostatném okně|OLEIVERB_OPEN|
|- 3|Skrýt položku|OLEIVERB_HIDE|

Hodnota-1 je obvykle alias pro jinou operaci. Pokud není podporováno otevírání úprav, má-2 stejný účinek jako-1. Další hodnoty naleznete v tématu [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) v Windows SDK.

*pView*<br/>
Ukazatel na okno zobrazení; používá ho Server k místní aktivaci. Tento parametr by měl mít hodnotu NULL, pokud aplikace kontejneru nepovoluje místní aktivaci.

*lpMsg*<br/>
Ukazatel na zprávu, která způsobila aktivaci položky.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud se operace úspěšně provedla; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tato funkce volá členskou funkci [Activate](#activate) pro provedení příkazu. Také zachycuje výjimky a při vyvolání jedné zobrazí uživateli okno se zprávou.

Pokud je primární příkaz Edit a v parametru *nVerb* je zadáno nula, je spuštěna serverová aplikace, aby bylo možné upravovat položku OLE. Pokud aplikace kontejneru podporuje místní aktivaci, lze úpravy provést na místě. Pokud kontejner nepodporuje místní aktivaci (nebo pokud je zadána otevřená operace), server se spustí v samostatném okně a v takovém případě je možné provést úpravy. V případě, že uživatel aplikace typu kontejner dvakrát klikne na položku OLE, určuje hodnota pro primární příkaz v parametru *nVerb* akci, kterou může uživatel provést. Pokud však server podporuje pouze jednu akci, provede tuto akci bez ohledu na to, která hodnota je uvedena v parametru *nVerb* .

##  <a name="draw"></a>COleClientItem: nezpracované:D

Voláním této funkce nakreslete položku OLE do zadaného ohraničovacího obdélníku pomocí zadaného kontextu zařízení.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*pDC*<br/>
Ukazatel na objekt [CDC](../../mfc/reference/cdc-class.md) použitý pro vykreslení položky OLE.

*lpBounds*<br/>
Ukazatel na objekt [](../../atl-mfc-shared/reference/crect-class.md) nebo `RECT` strukturu CRect definující ohraničující obdélník, ve kterém se má vykreslovat položka OLE (v logických jednotkách určených kontextem zařízení).

*nDrawAspect*<br/>
Určuje aspekt položky OLE, to znamená, jak by měla být zobrazena. Pokud je *nDrawAspect* -1, použije se poslední aspekt nastavený pomocí [SetDrawAspect](#setdrawaspect) . Další informace o možných hodnotách tohoto příznaku naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Funkce může používat reprezentace metasouboru pro položku OLE vytvořenou funkcí vykreslit [](../../mfc/reference/coleserveritem-class.md#ondraw) členskou funkcí `COleServerItem`.

Obvykle se používá `Draw` pro zobrazení obrazovky a předání kontextu zařízení obrazovky jako *primárního řadiče domény*. V takovém případě je nutné zadat pouze první dva parametry.

Parametr *lpBounds* identifikuje obdélník v kontextu cílového zařízení (vzhledem k aktuálnímu režimu mapování). Vykreslování může zahrnovat škálování obrázku a může je používat aplikace typu kontejner k uložení zobrazení, které se škáluje mezi zobrazeným zobrazením a finální tištěnou imagí.

Další informace najdete v tématu [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) v Windows SDK.

##  <a name="getactiveview"></a>COleClientItem:: GetActiveView

Vrátí zobrazení, ve kterém je položka na místě aktivována.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na zobrazení; jinak NULL, pokud položka není aktivována na místě.

##  <a name="getcachedextent"></a>COleClientItem:: GetCachedExtent

Voláním této funkce načtete velikost položky OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Ukazatel na `SIZE` strukturu nebo objekt [CSize](../../atl-mfc-shared/reference/csize-class.md) , který obdrží informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejíž hranice mají být načteny. Možné hodnoty naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; 0, pokud je položka OLE prázdná.

### <a name="remarks"></a>Poznámky

Tato funkce poskytuje stejné informace jako [getrozsah](#getextent). Nicméně můžete zavolat `GetCachedExtent` , chcete-li získat informace o rozsahu během zpracování jiných obslužných rutin OLE, jako je například při [změně](#onchange). Dimenze jsou v jednotkách MM_HIMETRIC.

To je možné z `GetCachedExtent` toho důvodu, že používá rozhraní [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) namísto použití rozhraní [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) k získání rozsahu této položky. Objekt modelu COM ukládá do mezipaměti informace o rozsahu použitém v předchozím volání [IViewObject::D RAW.](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) `IViewObject2`

Další informace naleznete v tématu [IViewObject2:: getrozsah](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) v Windows SDK.

##  <a name="getclassid"></a>COleClientItem:: GetClassID

Vrátí ID třídy položky do paměti, na kterou odkazuje *pClassId*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametry

*pClassID*<br/>
Ukazatel na identifikátor typu [CLSID](/windows/win32/com/clsid-key-hklm) , který načte ID třídy. Informace o identifikátoru CLSID naleznete v Windows SDK.

### <a name="remarks"></a>Poznámky

ID třídy je 128 číslo, které jedinečně identifikuje aplikaci, která položku upravuje.

Další informace naleznete v tématu [IPersist:: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) v Windows SDK.

##  <a name="getclipboarddata"></a>COleClientItem:: GetClipboardData

Voláním této funkce získáte `COleDataSource` objekt obsahující všechna data, která by byla umístěna ve schránce voláním členské funkce [CopyToClipboard](#copytoclipboard) .

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametry

*pDataSource*<br/>
Ukazatel na objekt [COleDataSource –](../../mfc/reference/coledatasource-class.md) , který obdrží data obsažená v položce OLE.

*bIncludeLink*<br/>
TRUE, pokud se mají zahrnout data odkazu; v opačném případě FALSE.

*lpOffset*<br/>
Posun kurzoru myši od počátku objektu v pixelech

*lpSize*<br/>
Velikost objektu v pixelech

### <a name="remarks"></a>Poznámky

`GetClipboardData`je volána jako výchozí implementace [OnGetClipboardData](#ongetclipboarddata). Přepsat `OnGetClipboardData` pouze v případě, že chcete kromě těch, které `CopyToClipboard`nabízí, nabídnout i formáty dat. Umístěte `COleDataSource` tyto formáty do objektu před nebo po volání `CopyToClipboard`a potom předejte `COleDataSource` objekt funkci [COleDataSource –:: SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) . Například pokud chcete, aby se pozice položky OLE v jeho kontejneru doprovází do schránky, měli byste definovat vlastní formát pro předání těchto informací a umístit je do `COleDataSource` před voláním. `CopyToClipboard`

##  <a name="getdocument"></a>COleClientItem:: GetDocument

Voláním této funkce získáte ukazatel na dokument, který obsahuje položku OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na dokument, který obsahuje položku OLE. Hodnota NULL, pokud položka není součástí dokumentu.

### <a name="remarks"></a>Poznámky

Tento ukazatel umožňuje přístup k `COleDocument` objektu, který jste předali jako argument `COleClientItem` konstruktoru.

##  <a name="getdrawaspect"></a>COleClientItem:: GetDrawAspect

Chcete-li určit aktuální "aspekt" nebo "zobrazení" položky, zavolejte členskoufunkci.`GetDrawAspect`

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Návratová hodnota

Hodnota z výčtu DVASPECT, jejíž hodnoty jsou uvedeny v odkazu pro [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Poznámky

Aspekt určuje, jak má být položka vykreslena.

##  <a name="getextent"></a>COleClientItem:: getrozsah

Voláním této funkce načtete velikost položky OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Ukazatel na `SIZE` strukturu `CSize` nebo objekt, který získá informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejíž hranice mají být načteny. Možné hodnoty naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; 0, pokud je položka OLE prázdná.

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace napsána pomocí knihovna Microsoft Foundation Class, tato funkce způsobí volání členské funkce [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) odpovídajícího `COleServerItem` objektu. Počítejte s tím, že načtená velikost se může lišit od velikosti, která byla naposledy nastavena členskou funkcí [SetExtent](#setextent) ; Velikost určená parametrem `SetExtent` je považována za návrh. Dimenze jsou v jednotkách MM_HIMETRIC.

> [!NOTE]
>  Nevolejte `GetExtent` během zpracování obslužné rutiny OLE, jako je například- [Change](#onchange). Místo toho zavolejte [GetCachedExtent](#getcachedextent) .

Další informace naleznete v tématu [IOleObject:: getrozsah](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) v Windows SDK.

##  <a name="geticonfromregistry"></a>COleClientItem:: GetIconFromRegistry

Voláním této členské funkce Načtěte popisovač prostředku ikony přidruženého k serveru určitého identifikátoru CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametry

*CLSID*<br/>
Odkaz na CLSID pro server přidružený k ikoně.

### <a name="return-value"></a>Návratová hodnota

Platný popisovač pro prostředek ikony nebo hodnotu NULL, pokud ikona serveru nebo výchozí ikona není nalezena.

### <a name="remarks"></a>Poznámky

Tato členská funkce nespustí Server nebo dynamicky získá ikonu, a to i v případě, že je server už spuštěný. Místo toho tato členská funkce otevře spustitelnou kopii serveru a načte statickou ikonu přidruženou k serveru, jak byla zaregistrována.

##  <a name="geticonicmetafile"></a>COleClientItem:: GetIconicMetafile

Načte metasoubor používaný k vykreslení ikony položky.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Návratová hodnota

Popisovač na metasoubor, pokud je úspěšný; jinak NULL.

### <a name="remarks"></a>Poznámky

Pokud není k dispozici žádná aktuální ikona, bude vrácena výchozí ikona. Tato metoda je volána automaticky dialogy MFC/OLE a obvykle není volána přímo.

Tato funkce také volá [SetIconicMetafile](#seticonicmetafile) , aby metasoubor mohl ukládat do mezipaměti pro pozdější použití.

##  <a name="getinplacewindow"></a>COleClientItem:: GetInPlaceWindow

`GetInPlaceWindow` Zavolejte členskou funkci, aby získala ukazatel na okno, ve kterém byla položka otevřena pro místní úpravy.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na místní okno pro úpravu položky; Hodnota NULL, pokud položka není aktivní nebo pokud její server není k dispozici.

### <a name="remarks"></a>Poznámky

Tato funkce by měla být volána pouze pro položky, které jsou místně aktivní.

##  <a name="getitemstate"></a>COleClientItem:: GetItemState

Voláním této funkce načtete aktuální stav položky OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Návratová hodnota

`openState` `loadedState` `emptyState` `activeUIState` `activeState`Výčtová hodnota, která může být jedna z následujících:,,,,. `COleClientItem::ItemState` Informace o těchto stavech najdete v kontejnerech [článků: Stavy](../../mfc/containers-client-item-states.md)klientských položek.

### <a name="remarks"></a>Poznámky

Chcete-li být upozorněni na změnu stavu položky OLE, použijte [](#onchange) funkci přiměnit členskou funkci.

Další informace najdete v kontejnerech článků [: Stavy](../../mfc/containers-client-item-states.md)klientských položek.

##  <a name="getlaststatus"></a>COleClientItem:: GetLastStatus

Vrátí stavový kód poslední operace OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Návratová hodnota

Hodnota Code

### <a name="remarks"></a>Poznámky

Pro členské funkce, které vracejí hodnotu bool false nebo jiné členské funkce, které vracejí hodnotu null, `GetLastStatus` vrátí podrobnější informace o selhání. Uvědomte si, že většina členských funkcí OLE vyvolává výjimky pro závažnější chyby. Konkrétní informace o interpretaci code závisí na podkladovém volání OLE, které naposledy vrátilo hodnotu Code.

Další informace o Code najdete v tématu [Struktura kódů chyb com](/windows/win32/com/structure-of-com-error-codes) v dokumentaci Windows SDK.

##  <a name="getlinkupdateoptions"></a>COleClientItem:: GetLinkUpdateOptions

Voláním této funkce získáte aktuální hodnotu možnosti propojení-aktualizace pro položku OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Návratová hodnota

Jedna z následujících hodnot:

- OLEUPDATE_ALWAYS aktualizuje propojenou položku, kdykoli je to možné. Tato možnost podporuje přepínač Automatické aktualizace propojení v dialogovém okně odkazy.

- OLEUPDATE_ONCALL aktualizuje propojenou položku pouze na vyžádání z aplikace kontejneru (při volání členské funkce [UpdateLink](#updatelink) ). Tato možnost podporuje přepínač ruční aktualizace propojení v dialogovém okně odkazy.

### <a name="remarks"></a>Poznámky

Toto je pokročilá operace.

Tato funkce je volána automaticky třídou [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Další informace naleznete v tématu [IOleLink:: GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) v Windows SDK.

##  <a name="gettype"></a>COleClientItem:: GetType

Voláním této funkce určíte, zda je položka OLE vložena nebo propojena nebo statická.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Návratová hodnota

Unsigned integer s jednou z následujících hodnot:

- OT_LINK položka OLE je odkaz.

- OT_EMBEDDED položka OLE je vložená.

- OT_STATIC položka OLE je statická, to znamená, že obsahuje pouze prezentační data, ne nativní data a nelze je proto upravovat.

##  <a name="getusertype"></a>COleClientItem:: GetUserType

Voláním této funkce získáte řetězec viditelný pro uživatele, který popisuje typ položky OLE, například "wordový dokument".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametry

*nUserClassType*<br/>
Hodnota, která označuje požadovanou variantu řetězce popisujícího typ položky OLE. To může mít jednu z následujících hodnot:

- USERCLASSTYPE_FULL úplný název typu, který se zobrazí uživateli.

- USERCLASSTYPE_SHORT krátký název (maximálně 15 znaků) pro použití v místních nabídkách a v dialogovém okně Upravit odkazy.

- USERCLASSTYPE_APPNAME název aplikace, která obsluhuje třídu.

*rString*<br/>
Odkaz na objekt [CString](../../atl-mfc-shared/reference/cstringt-class.md) , na který má být vrácen řetězec popisující typ položky OLE.

### <a name="remarks"></a>Poznámky

Často se jedná o položku v databázi pro registraci systému.

Pokud je požadován úplný název typu, ale není k dispozici, místo toho se použije krátký název. Pokud není v registrační databázi nalezena žádná položka pro typ položky OLE, nebo pokud pro typ položky OLE nejsou registrovány žádné typy uživatelů, pak je použit typ uživatele, který je aktuálně uložen v položce OLE. Pokud je tento název typu uživatele prázdný řetězec, je použita možnost neznámý objekt.

Další informace naleznete v tématu [IOleObject:: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) v Windows SDK.

##  <a name="isinplaceactive"></a>COleClientItem:: IsInPlaceActive

Voláním této funkce zjistíte, zda je položka OLE na místě aktivní.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je položka OLE na místě aktivní; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Je běžné spouštět různé logiky v závislosti na tom, jestli je položka upravována na místě. Funkce zkontroluje, zda je stav aktuální položky roven `activeState` `activeUIState`nebo.

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Voláním této funkce zjistíte, zda je položka OLE v aktuálním stavu.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je položka OLE aktuální; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Odkazovaná položka může být zastaralá, pokud je její zdrojový dokument aktualizovaný. Vložená položka, která obsahuje odkazy v rámci, může být podobně zastaralá. Funkce provádí rekurzivní kontrolu položky OLE. Všimněte si, že rozhodnutí, jestli je položka OLE zastaralá, může být při skutečném provádění aktualizace levnější.

Tato metoda je automaticky volána implementací [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Další informace naleznete v tématu [IOleObject:: IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) v Windows SDK.

##  <a name="ismodified"></a>COleClientItem::-Modified

Voláním této funkce zjistíte, jestli je položka OLE nečistá (změnila se od posledního uložení).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je položka OLE čistá; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Další informace naleznete v tématu [IPersistStorage::](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) dedirty v Windows SDK.

##  <a name="isopen"></a>COleClientItem:: Open

Voláním této funkce zjistíte, zda je položka OLE otevřená. To je otevřeno v instanci serverové aplikace spuštěné v samostatném okně.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je položka OLE otevřená; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Slouží k určení, kdy se má objekt nakreslit pomocí vzoru šrafování. Otevřený objekt by měl mít vzorek šrafování vykreslený nad objektem. K tomuto účelu můžete použít objekt [CRectTracker –](../../mfc/reference/crecttracker-class.md) .

##  <a name="isrunning"></a>COleClientItem:: inrunning

Voláním této funkce zjistíte, zda je spuštěna položka OLE. To znamená, zda je položka načtena a spuštěna v serverové aplikaci.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je spuštěna položka OLE; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Další informace najdete v tématu [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) v Windows SDK.

##  <a name="onactivate"></a>COleClientItem:: Activate

Volá se rozhraním, aby se upozornila na položku, že se právě aktivovala.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Poznámky

Všimněte si, že tato funkce je volána k označení toho, že server běží, a nemůže označovat, že jeho uživatelské rozhraní bylo nainstalováno v aplikaci kontejneru. V tomto okamžiku objekt nemá aktivní uživatelské rozhraní (není `activeUIState`). Nenainstalovalo se nabídky nebo panely nástrojů. Členská funkce [OnActivateUI](#onactivateui) je volána, když k ní dojde.

Výchozí implementace volá členskou funkci při [změně](#onchange) s OLE_CHANGEDSTATE jako parametr. Tuto funkci potlačíte, pokud chcete provádět vlastní zpracování, když se položka aktivuje místně.

##  <a name="onactivateui"></a>COleClientItem:: OnActivateUI

Rozhraní volá `OnActivateUI` , když objekt zadal aktivní stav uživatelského rozhraní.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Poznámky

Objekt nyní nainstaloval svůj panel nástrojů a nabídky.

Výchozí implementace pamatuje HWND serveru pro pozdější `GetServerWindow` volání.

##  <a name="onchange"></a>COleClientItem::-Change

Volá se rozhraním, když uživatel změní, uloží nebo zavře položku OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametry

*nCode*<br/>
Důvod, proč Server tuto položku změnil. Může mít jednu z následujících hodnot:

- OLE_CHANGED vzhled položky OLE se změnil.

- OLE_SAVED položka OLE byla uložena.

- OLE_CLOSED položka OLE byla zavřena.

- OLE_CHANGED_STATE položka OLE se změnila z jednoho stavu na jiný.

*dwParam*<br/>
Pokud *nCode* je OLE_SAVED nebo OLE_CLOSED, tento parametr se nepoužívá. Pokud je *NCODE* OLE_CHANGED, tento parametr určuje aspekt položky OLE, která se změnila. Možné hodnoty naleznete v parametru *DwParam* [COleClientItem::D RAW](#draw). Pokud je *nCode* OLE_CHANGED_STATE, tento parametr je `COleClientItem::ItemState` výčtovou hodnotou a popisuje zadaný stav. Může mít jednu z následujících hodnot: `emptyState`, `loadedState`, `openState`, `activeState`nebo `activeUIState`.

### <a name="remarks"></a>Poznámky

(Pokud je aplikace serveru zapsána pomocí knihovna Microsoft Foundation Class, je tato funkce volána v reakci na `Notify` členské `COleServerDoc` funkce nebo `COleServerItem`.) Výchozí implementace označí dokument kontejneru jako upravený, pokud *nCode* je OLE_CHANGED nebo OLE_SAVED.

V případě OLE_CHANGED_STATE bude aktuální stav vrácený z [GetItemState](#getitemstate) stále starým stavem, což znamená, že stav, který byl aktuální před touto změnou stavu.

Přepište tuto funkci, pokud chcete reagovat na změny ve stavu položky OLE. Obvykle se vzhled položky aktualizuje zrušením platnosti oblasti, ve které se položka zobrazuje. Na začátku přepsání volejte implementaci základní třídy.

##  <a name="onchangeitemposition"></a>COleClientItem:: OnChangeItemPosition

Volá se rozhraním, aby se oznámilo, že se změnil rozsah položky OLE během místní aktivace.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametry

*rectPos*<br/>
Určuje pozici položky vzhledem ke klientské oblasti aplikace kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je pozice položky úspěšně změněna; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace určuje nový viditelný obdélník položky OLE a volá [SetItemRects](#setitemrects) s novými hodnotami. Výchozí implementace vypočítá viditelný obdélník pro položku a předá tyto informace serveru.

Přepište tuto funkci, pokud chcete použít zvláštní pravidla na operaci změnit velikost nebo přesunutí. Pokud je aplikace napsána v knihovně MFC, toto volání bude mít za následek, že server s názvem [COleServerDoc:: RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>COleClientItem:: deaktivovat

Volá se rozhraním, když se položka OLE přechází z místního aktivního stavu ( `activeState`) do stavu načteno, což znamená, že se po místní aktivaci deaktivuje.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Poznámky

Všimněte si, že tato funkce je volána k označení toho, že položka OLE je zavřena, a ne její uživatelské rozhraní bylo odebráno z aplikace kontejneru. V takovém případě je volána členská funkce [OnDeactivateUI](#ondeactivateui) .

Výchozí implementace volá členskou funkci při [změně](#onchange) s OLE_CHANGEDSTATE jako parametr. Tuto funkci můžete přepsat, chcete-li provést vlastní zpracování při deaktivaci místní aktivní položky. Například Pokud podporujete příkaz zpět v aplikaci kontejneru, můžete tuto funkci přepsat, chcete-li zrušit stav vrácení zpět, což značí, že poslední operace prováděná na položce OLE nemůže být vrácena zpět, jakmile je položka deaktivována.

##  <a name="ondeactivateandundo"></a>COleClientItem:: OnDeactivateAndUndo

Volá se rozhraním, když uživatel vyvolá příkaz zpět po aktivaci položky OLE.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá [DeactivateUI](#deactivateui) k deaktivaci uživatelského rozhraní serveru. Tuto funkci potlačíte, Pokud implementujete příkaz pro vrácení zpět ve vaší aplikaci kontejneru. V přepsání zavolejte verzi základní třídy funkce a pak vraťte poslední příkaz spuštěný ve vaší aplikaci.

Další informace najdete v tématu [IOleInPlaceSite::D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) v Windows SDK.

##  <a name="ondeactivateui"></a>COleClientItem:: OnDeactivateUI

Volá se, když uživatel deaktivuje položku, která se aktivovala na místě.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametry

*bUndoable*<br/>
Určuje, zda lze změny úprav zrušit.

### <a name="remarks"></a>Poznámky

Tato funkce obnoví uživatelské rozhraní aplikace typu kontejner do původního stavu, skryje všechny nabídky a další ovládací prvky, které byly vytvořeny pro místní aktivaci.

Pokud má *bUndoable* hodnotu false, kontejner by měl zakázat příkaz zpět. v důsledku toho zahodí stav vrácení zpět kontejneru, protože indikuje, že poslední operace prováděné serverem nelze zrušit.

##  <a name="ondiscardundostate"></a>COleClientItem:: OnDiscardUndoState

Volá se rozhraním, když uživatel provede akci, která zahodí stav vrácení zpět při úpravách položky OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace neprovádí žádnou akci. Tuto funkci potlačíte, Pokud implementujete příkaz pro vrácení zpět ve vaší aplikaci kontejneru. Ve vašem přepsání zahoďte stav vrácení zpět se změnami aplikace kontejneru.

Pokud byl server napsán s knihovna Microsoft Foundation Class, může server způsobit volání této funkce voláním [COleServerDoc::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Další informace najdete v tématu [IOleInPlaceSite::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) v Windows SDK.

##  <a name="ongetclipboarddata"></a>COleClientItem:: OnGetClipboardData

Volá se rozhraním, aby se `COleDataSource` získal objekt obsahující všechna data, která by se umístila do schránky, voláním do [CopyToClipboard](#copytoclipboard) nebo členské funkce [DoDragDrop](#dodragdrop) .

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Nastavte tuto hodnotu na TRUE, pokud se mají data odkazu zkopírovat do schránky. Nastavte na hodnotu FALSE, pokud serverová aplikace nepodporuje odkazy.

*lpOffset*<br/>
Ukazatel na posun ukazatele myši od počátku objektu v pixelech.

*lpSize*<br/>
Ukazatel na velikost objektu v pixelech.

### <a name="return-value"></a>Návratová hodnota

Ukazatel na objekt [COleDataSource –](../../mfc/reference/coledatasource-class.md) obsahující data ze schránky.

### <a name="remarks"></a>Poznámky

Výchozí implementace této funkce volá [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>COleClientItem:: OnGetClipRect

Rozhraní volá `OnGetClipRect` členskou funkci, aby získala souřadnice ořezového rámečku položky, která je upravována na místě.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametry

*rClipRect*<br/>
Ukazatel na objekt třídy [CRect](../../atl-mfc-shared/reference/crect-class.md) , který bude obsahovat souřadnice ořezového obdélníku položky.

### <a name="remarks"></a>Poznámky

Souřadnice jsou v pixelech vzhledem k klientské oblasti okna kontejneru aplikace.

Výchozí implementace jednoduše vrátí obdélník klienta zobrazení, ve kterém je položka aktivní na místě.

##  <a name="ongetitemposition"></a>COleClientItem:: OnGetItemPosition

Rozhraní volá `OnGetItemPosition` členskou funkci, aby získala souřadnice položky, která je upravována na místě.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametry

*rPosition.*<br/>
Odkaz na objekt [CRect](../../atl-mfc-shared/reference/crect-class.md) , který bude obsahovat souřadnice pozice položky

### <a name="remarks"></a>Poznámky

Souřadnice jsou v pixelech vzhledem k klientské oblasti okna kontejneru aplikace.

Výchozí implementace této funkce neprovede žádnou akci. Aplikace, které podporují místní úpravy, vyžadují svou implementaci.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Volá se rozhraním, když se aktivuje položka.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametry

*ppMainFrame*<br/>
Ukazatel na ukazatel na hlavní okno rámce.

*ppDocFrame*<br/>
Ukazatel na ukazatel na okno rámce dokumentu.

*lpFrameInfo*<br/>
Ukazatel na strukturu [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oifi) , která obdrží informace o okně rámce.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tato funkce slouží k načtení informací o nadřazeném okně položky OLE.

Pokud je kontejner aplikace MDI, výchozí implementace vrátí ukazatel na objekt [CMDIFrameWnd –](../../mfc/reference/cmdiframewnd-class.md) v *ppMainFrame* a ukazatel na aktivní objekt [CMDIChildWnd –](../../mfc/reference/cmdichildwnd-class.md) v *ppDocFrame*. Pokud je kontejnerem aplikace SDI, výchozí implementace vrátí ukazatel na objekt [CFrameWnd](../../mfc/reference/cframewnd-class.md) v *ppMainFrame* a vrátí hodnotu null v *ppDocFrame*. Výchozí implementace také vyplní členy *lpFrameInfo*.

Tuto funkci popište pouze v případě, že výchozí implementace nevyhovuje vaší aplikaci. Například pokud má vaše aplikace paradigma uživatelského rozhraní, které se liší od SDI nebo MDI. Toto je pokročilá přepsatelné.

Další informace naleznete v tématu [IOleInPlaceSite:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) a struktura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oifi) v Windows SDK.

##  <a name="oninsertmenus"></a>COleClientItem:: OnInsertMenus

Volá se rozhraním během místní aktivace pro vložení nabídek aplikace typu kontejner do prázdné nabídky.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Odkazuje na prázdnou nabídku.

*lpMenuWidths*<br/>
Odkazuje na pole šesti DLOUHÝch hodnot, které určují, kolik nabídek je v každé z následujících skupin nabídek: Soubor, upravit, kontejner, objekt, okno, help. Aplikace kontejneru zodpovídá za skupiny souborů, kontejnerů a oken, které odpovídají prvkům 0, 2 a 4 tohoto pole.

### <a name="remarks"></a>Poznámky

Tato nabídka je pak předána serveru, který vloží vlastní nabídky a vytvoří složenou nabídku. Tuto funkci lze volat opakovaně pro sestavení několika složených nabídek.

Výchozí implementace vloží do *pMenuShared* nabídky kontejnerů na místě. To znamená, že skupiny v nabídce soubor, kontejner a okno. [CDocTemplate –:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) slouží k nastavení tohoto prostředku nabídky. Výchozí implementace také přiřadí příslušné hodnoty k prvkům 0, 2 a 4 v *lpMenuWidths*v závislosti na prostředku nabídky. Tuto funkci přepište, pokud výchozí implementace není vhodná pro vaši aplikaci. Například pokud vaše aplikace nepoužívá šablony dokumentů pro přidružení prostředků k typům dokumentů. Pokud přepíšete tuto funkci, měli byste také přepsat [OnSetMenu](#onsetmenu) a [OnRemoveMenus](#onremovemenus). Toto je pokročilá přepsatelné.

Další informace naleznete v tématu [IOleInPlaceFrame:: InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) v Windows SDK.

##  <a name="onremovemenus"></a>COleClientItem:: OnRemoveMenus

Volá se rozhraním, aby se odebraly nabídky kontejneru ze zadané složené nabídky, když končí místní aktivace.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Odkazuje na složenou nabídku vytvořenou voláním členské funkce [OnInsertMenus](#oninsertmenus) .

### <a name="remarks"></a>Poznámky

Výchozí implementace odebere z *pMenuShared* místní nabídky kontejnerů, tedy skupiny souborů, kontejnerů a nabídek okna. Tuto funkci přepište, pokud výchozí implementace není vhodná pro vaši aplikaci. Například pokud vaše aplikace nepoužívá šablony dokumentů pro přidružení prostředků k typům dokumentů. Pokud přepíšete tuto funkci, měli byste také přepsat [OnInsertMenus](#oninsertmenus) a [OnSetMenu](#onsetmenu) . Toto je pokročilá přepsatelné.

Podnabídky na *pMenuShared* může sdílet více než jedna složená nabídka, pokud se server opakovaně volá `OnInsertMenus`. Proto byste neměli odstraňovat žádné podnabídky v přepsání `OnRemoveMenus`. měli byste je oddělit.

Další informace naleznete v tématu [IOleInPlaceFrame:: RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) v Windows SDK.

##  <a name="onscrollby"></a>COleClientItem:: OnScrollBy

Volá se rozhraním, aby se přesunula položka OLE v reakci na požadavky ze serveru.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametry

*sizeExtent*<br/>
Určuje vzdálenosti v pixelech, které se mají posouvat v směrech x a y.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byla položka posunuta; 0, pokud se položka nepovedla posunout

### <a name="remarks"></a>Poznámky

Například pokud je položka OLE částečně viditelná a uživatel se přesune mimo viditelnou oblast při provádění místních úprav, je tato funkce volána, aby byl ukazatel viditelný. Výchozí implementace neprovádí žádnou akci. Potlačením této funkce posuňte položku o zadanou hodnotu. Všimněte si, že v důsledku posouvání se může viditelná část položky OLE změnit. Voláním [SetItemRects](#setitemrects) aktualizujte viditelný obdélník položky.

Další informace naleznete v tématu [IOleInPlaceSite:: Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) v Windows SDK.

##  <a name="onsetmenu"></a>COleClientItem:: OnSetMenu

Volá se v rozhraní dvakrát, když se zahájí a končí místní aktivace. První instalace složené nabídky a podruhé (s *holemenu* rovnou null) k jejímu odebrání.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Ukazatel na složenou nabídku vytvořenou voláním členské funkce [OnInsertMenus](#oninsertmenus) a `InsertMenu` funkce.

*holemenu*<br/>
Popisovač nabídky vrácený `OleCreateMenuDescriptor` funkcí nebo hodnotu null, pokud má být odebrán kód pro odeslání.

*hwndActiveObject*<br/>
Zpracovává okno úprav pro položku OLE. Toto je okno, které přijme příkazy pro úpravy z OLE.

### <a name="remarks"></a>Poznámky

Výchozí implementace nainstaluje nebo odebere složenou nabídku a potom zavolá funkci [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) pro instalaci nebo odebrání kódu odeslání. Tuto funkci přepište, pokud výchozí implementace není vhodná pro vaši aplikaci. Pokud přepíšete tuto funkci, měli byste také přepsat [OnInsertMenus](#oninsertmenus) a [OnRemoveMenus](#onremovemenus) . Toto je pokročilá přepsatelné.

Další informace naleznete v tématu [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)a [IOleInPlaceFrame:: SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) v Windows SDK.

##  <a name="onshowcontrolbars"></a>COleClientItem:: OnShowControlBars

Volá se rozhraním, aby se zobrazily a skryly ovládací panely aplikace kontejneru.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametry

*pFrameWnd*<br/>
Ukazatel na okno rámce aplikace kontejneru. Může to být buď hlavní okno rámce, nebo podřízené okno MDI.

*bShow*<br/>
Určuje, zda se mají zobrazovat nebo skrývat ovládací panely.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud volání funkce způsobí změnu stavu řídicích panelů; 0, pokud volání nezpůsobí změnu, nebo pokud *pFrameWnd* neodkazuje na okno rámce kontejneru.

### <a name="remarks"></a>Poznámky

Tato funkce vrátí hodnotu 0, pokud ovládací panely jsou již ve stavu určeném parametrem *bShow.* K tomu dojde například v případě, že jsou ovládací panely skryté a *bShow* je false.

Výchozí implementace odebere panel nástrojů z okna rámce nejvyšší úrovně.

##  <a name="onshowitem"></a>COleClientItem:: OnShowItem

Volá se rozhraním, aby se zobrazila položka OLE, takže se při úpravách úplně zobrazuje.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Poznámky

Používá se, pokud vaše aplikace kontejneru podporuje odkazy na vložené položky (to znamená, pokud jste třídu dokumentu odvodili z [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Tato funkce je volána během místní aktivace nebo je-li položka OLE zdrojem odkazu a uživatel ji chce upravit. Výchozí implementace aktivuje první zobrazení dokumentu kontejneru. Potlačením této funkce posuňte dokument tak, aby byla položka OLE viditelná.

##  <a name="onupdateframetitle"></a>COleClientItem:: OnUpdateFrameTitle

Volá se rozhraním během místní aktivace pro aktualizaci záhlaví okna rámce.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud tato funkce úspěšně aktualizovala nadpis rámce, jinak nula.

### <a name="remarks"></a>Poznámky

Výchozí implementace nemění název okna rámce. Tuto funkci přepište, pokud chcete pro aplikaci určit jiný název rámce, například "*položka* *serverové aplikace* - v *docName*" (jako v aplikaci "Microsoft Excel-tabulka v sestavě". DOC "). Toto je pokročilá přepsatelné.

##  <a name="reactivateandundo"></a>COleClientItem:: ReactivateAndUndo

Voláním této funkce znovu aktivujete položku OLE a vrátíte poslední operaci prováděnou uživatelem během místních úprav.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Pokud vaše aplikace kontejneru podporuje příkaz zpět, zavolejte tuto funkci, pokud uživatel zvolí příkaz pro vrácení zpět ihned po deaktivaci položky OLE.

Pokud je aplikace serveru zapsána pomocí knihoven Microsoft Foundation Class, tato funkce způsobí, že Server zavolá [COleServerDoc:: OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Další informace naleznete v tématu [IOleInPlaceObject:: ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) v Windows SDK.

##  <a name="release"></a>COleClientItem:: Release

Voláním této funkce vyčistíte prostředky používané položkou OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Příznak určující, za jakých okolností se položka OLE uloží při návratu do načteného stavu. Seznam možných hodnot naleznete v tématu [COleClientItem:: Close](#close).

### <a name="remarks"></a>Poznámky

`Release`je volán `COleClientItem` destruktorem.

Další informace naleznete v tématu [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) v Windows SDK.

##  <a name="reload"></a>COleClientItem:: reload

Zavře a znovu načte položku.

```
BOOL Reload();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Volání funkce po aktivaci položky jako položky jiného typu voláním metody [ActivateAs.](#activateas) `Reload`

##  <a name="run"></a>COleClientItem:: Run

Spustí aplikaci přidruženou k této položce.

```
void Run();
```

### <a name="remarks"></a>Poznámky

Než aktivujete tuto položku, zavolejte členskoufunkciprospuštěníserverovéaplikace.`Run` To se provádí automaticky [aktivací](#activate) a [DoVerb](#doverb), takže obvykle není nutné volat tuto funkci. Tuto funkci volejte, pokud je nutné spustit server, aby bylo možné před spuštěním [DoVerb](#doverb)nastavit atribut položky, například [SetExtent](#setextent).

##  <a name="setdrawaspect"></a>COleClientItem:: SetDrawAspect

Chcete-li nastavit "aspekt" nebo "zobrazení" položky, zavolejte členskoufunkci.`SetDrawAspect`

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametry

*nDrawAspect*<br/>
Hodnota z výčtu DVASPECT. Tento parametr může mít jednu z následujících hodnot:

- Položka DVASPECT_CONTENT je reprezentovaná takovým způsobem, že se dá zobrazit jako vložený objekt uvnitř kontejneru.

- Položka DVASPECT_THUMBNAIL se vykresluje v "miniatuře" reprezentace, aby se mohla zobrazit v nástroji pro procházení.

- Položka DVASPECT_ICON je reprezentována ikonou.

- Položka DVASPECT_DOCPRINT je reprezentována, jako kdyby byla vytištěna pomocí příkazu Print v nabídce soubor.

### <a name="remarks"></a>Poznámky

Aspekt určuje, jak má být položka vykreslena vykreslením, když je použita výchozí hodnota argumentu *nDrawAspect* této funkce. [](#draw)

Tato funkce je volána automaticky pomocí ikony Change (a dalších dialogových oken, které volají dialogové okno Změnit ikonu), aby bylo možné zobrazit aspekty zobrazení ikonickým v případě, že uživatel požaduje.

##  <a name="setextent"></a>COleClientItem:: SetExtent

Voláním této funkce určíte, kolik místa je k dispozici pro položku OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametry

*hodnota*<br/>
Objekt [CSize](../../atl-mfc-shared/reference/csize-class.md) , který obsahuje informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejíž hranice mají být nastaveny. Možné hodnoty naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace napsána pomocí knihovna Microsoft Foundation Class, způsobí to [](../../mfc/reference/coleserveritem-class.md#onsetextent) , že je volána členská `COleServerItem` funkce OnSetExtent odpovídajícího objektu. Položka OLE pak může odpovídajícím způsobem upravit její zobrazení. Dimenze musí být v jednotkách MM_HIMETRIC. Tato funkce se volá, když uživatel změní velikost položky OLE nebo Pokud podporujete nějakou formu vyjednávání o rozložení.

Další informace naleznete v tématu [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) v Windows SDK.

##  <a name="sethostnames"></a>COleClientItem:: SetHostNames

Voláním této funkce určíte název aplikace kontejneru a název kontejneru pro vloženou položku OLE.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametry

*lpszHost*<br/>
Ukazatel na název, který je pro aplikaci kontejneru zobrazený uživatelem.

*lpszHostObj*<br/>
Ukazatel na identifikační řetězec kontejneru, který obsahuje položku OLE.

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace napsána pomocí knihovna Microsoft Foundation Class, volá Tato funkce [](../../mfc/reference/coleserverdoc-class.md#onsethostnames) členskou funkci `COleServerDoc` OnSetHostNames dokumentu, která obsahuje položku OLE. Tyto informace se používají v názvech oken při úpravách položky OLE. Při každém načtení dokumentu kontejneru volá rozhraní tuto funkci pro všechny položky OLE v dokumentu. `SetHostNames`platí pouze pro vložené položky. Není nutné volat tuto funkci pokaždé, když je aktivována vložená položka OLE pro úpravy.

Tato metoda se také nazývá automaticky s názvem aplikace a názvem dokumentu při načtení objektu nebo při uložení souboru pod jiným názvem. Proto není obvykle nutné volat tuto funkci přímo.

Další informace naleznete v tématu [IOleObject:: SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) v Windows SDK.

##  <a name="seticonicmetafile"></a>COleClientItem:: SetIconicMetafile

Ukládá do mezipaměti metasoubor používaný k vykreslení ikony položky.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametry

*hMetaPict*<br/>
Popisovač metasouboru, který se používá k vykreslení ikony položky

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

K načtení metasouboru použijte [GetIconicMetafile](#geticonicmetafile) .

Parametr *hMetaPict* je zkopírován do položky; Proto musí být *hMetaPict* uvolněn volajícím.

##  <a name="setitemrects"></a>COleClientItem:: SetItemRects

Voláním této funkce nastavíte ohraničující obdélník nebo viditelný obdélník položky OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*lprcPosRect*<br/>
Ukazatel na obdélník obsahující hranice položky OLE vzhledem ke svému nadřazenému oknu v souřadnicích klienta.

*lprcClipRect*<br/>
Ukazatel na obdélník obsahující hranice viditelné části položky OLE vzhledem ke svému nadřazenému oknu v souřadnicích klienta.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud bylo úspěšné; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tato funkce je volána výchozí implementací členské funkce [OnChangeItemPosition](#onchangeitemposition) . Tuto funkci byste měli zavolat při každé změně pozice nebo viditelné části položky OLE. Obvykle to znamená, že ho voláte z členských funkcí OnScrollBy [velikosti](../../mfc/reference/cwnd-class.md#onsize) zobrazení. [](../../mfc/reference/cview-class.md#onscrollby)

Další informace naleznete v tématu [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) v Windows SDK.

##  <a name="setlinkupdateoptions"></a>COleClientItem:: SetLinkUpdateOptions

Voláním této funkce nastavíte možnost aktualizace propojení pro prezentaci zadané propojené položky.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametry

*dwUpdateOpt*<br/>
Hodnota možnosti aktualizovat propojení pro tuto položku. Tato hodnota musí být jedna z následujících hodnot:

- OLEUPDATE_ALWAYS aktualizuje propojenou položku, kdykoli je to možné. Tato možnost podporuje přepínač Automatické aktualizace propojení v dialogovém okně odkazy.

- OLEUPDATE_ONCALL aktualizuje propojenou položku pouze na vyžádání z aplikace kontejneru (při volání členské funkce [UpdateLink](#updatelink) ). Tato možnost podporuje přepínač ruční aktualizace propojení v dialogovém okně odkazy.

### <a name="remarks"></a>Poznámky

Obvykle byste neměli měnit možnosti aktualizace zvolené uživatelem v dialogovém okně odkazy.

Další informace naleznete v tématu [IOleLink:: SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) v Windows SDK.

##  <a name="setprintdevice"></a>COleClientItem:: SetPrintDevice

Voláním této funkce změníte zařízení cílení na tisk pro tuto položku.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametry

*ptd*<br/>
Ukazatel na strukturu dat [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , která obsahuje informace o novém zařízení cílení na tisk. Může mít hodnotu NULL.

*ppd*<br/>
Ukazatel na strukturu dat [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-pdw) , která obsahuje informace o novém zařízení cílení na tisk. Může mít hodnotu NULL.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byla funkce úspěšná; v opačném případě 0.

### <a name="remarks"></a>Poznámky

Tato funkce aktualizuje pro položku cílové zařízení pro tisk, ale neaktualizuje mezipaměť prezentace. Chcete-li aktualizovat mezipaměť prezentace pro položku, zavolejte na [UpdateLink](#updatelink).

Argumenty této funkce obsahují informace, které systém OLE používá k identifikaci cílového zařízení. `PRINTDLG` Struktura obsahuje informace, které systém Windows používá k inicializaci běžného tiskového dialogového okna. Po zavření uživatele v dialogovém okně vrátí systém Windows informace o výběru uživatele v této struktuře. Člen objektu `PRINTDLG` CPrintDialog je struktura. [](../../mfc/reference/cprintdialog-class.md) `m_pd`

Další informace o této struktuře naleznete v tématu [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-pdw) v Windows SDK.

Další informace najdete v tématu [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) v Windows SDK.

##  <a name="updatelink"></a>COleClientItem:: UpdateLink

Voláním této funkce aktualizujete data prezentace položky OLE hned.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové při úspěchu; v opačném případě 0.

### <a name="remarks"></a>Poznámky

U propojených položek funkce nalezne zdroj propojení, aby získal novou prezentaci pro položku OLE. Tento proces může zahrnovat spuštění jedné nebo více serverových aplikací, což může být časově náročné. U vložených položek funguje funkce rekurzivně a kontroluje, zda vložená položka obsahuje odkazy, které mohou být zastaralé a aktualizovány. Uživatel může také ručně aktualizovat jednotlivé odkazy pomocí dialogového okna odkazy.

Další informace naleznete v tématu [IOleLink:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) v Windows SDK.

## <a name="see-also"></a>Viz také:

[MFCBIND Sample MFC](../../overview/visual-cpp-samples.md)<br/>
[OCLIENT Sample MFC](../../overview/visual-cpp-samples.md)<br/>
[CDocItem – třída](../../mfc/reference/cdocitem-class.md)<br/>
[Graf hierarchie](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem – třída](../../mfc/reference/coleserveritem-class.md)
