---
title: COleClientItem – třída
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: c880b1fb724b533bb049666460948c6df661a03c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376287"
---
# <a name="coleclientitem-class"></a>COleClientItem – třída

Definuje rozhraní kontejneru na položky OLE.

## <a name="syntax"></a>Syntaxe

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Členové

### <a name="public-constructors"></a>Veřejné konstruktory

|Name (Název)|Popis|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Vytvoří `COleClientItem` objekt.|

### <a name="public-methods"></a>Veřejné metody

|Name (Název)|Popis|
|----------|-----------------|
|[COleClientItem::Aktivovat](#activate)|Otevře položku OLE pro operaci a potom provede zadané sloveso.|
|[COleClientItem::ActivateAs](#activateas)|Aktivuje položku jako jiný typ.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Přistupuje k datům v objektu OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Označuje, zda aplikace kontejneru může vytvořit vložený objekt.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Označuje, zda aplikace kontejneru můžete vytvořit propojený objekt.|
|[COleClientItem::Lze vložit](#canpaste)|Označuje, zda schránka obsahuje vložitelnou nebo statickou položku OLE.|
|[COleClientItem::CanPasteLink](#canpastelink)|Označuje, zda schránka obsahuje propojitelnou položku OLE.|
|[COleClientItem::Zavřít](#close)|Zavře propojení se serverem, ale nezničí položku OLE.|
|[COleClientItem::Převést na](#convertto)|Převede položku na jiný typ.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Zkopíruje položku OLE do schránky.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Vytvoří duplikát existující položky.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Vytvoří vloženou položku ze schránky.|
|[COleClientItem::CreateFromData](#createfromdata)|Vytvoří vloženou položku z datového objektu.|
|[COleClientItem::CreateFromFile](#createfromfile)|Vytvoří vloženou položku ze souboru.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Vytvoří propojenou položku ze schránky.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Vytvoří propojenou položku z datového objektu.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Vytvoří propojenou položku ze souboru.|
|[COleClientItem::CreateNewItem](#createnewitem)|Vytvoří novou vloženou položku spuštěním serverové aplikace.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Vytvoří statickou položku ze schránky.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Vytvoří statickou položku z datového objektu.|
|[COleClientItem::Deaktivovat](#deactivate)|Deaktivuje položku.|
|[COleClientItem::DeactivateUI](#deactivateui)|Obnoví uživatelské rozhraní aplikace kontejneru do původního stavu.|
|[COleClientItem::Delete](#delete)|Odstraní nebo zavře položku OLE, pokud se jednalo o propojenou položku.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Provede operaci přetažení myší.|
|[COleClientItem::DoVerb](#doverb)|Provede zadané sloveso.|
|[COleClientItem::Draw](#draw)|Nakreslí položku OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Získá zobrazení, na kterém je položka aktivována na místě.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Vrátí hranice obdélníku položky OLE.|
|[COleClientItem::GetClassID](#getclassid)|Získá ID třídy současné položky.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Získá data, která by byla umístěna `CopyToClipboard` do schránky voláním členské funkce.|
|[COleClientItem::GetDocument](#getdocument)|Vrátí `COleDocument` objekt, který obsahuje tuto položku.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Získá aktuální zobrazení položky pro vykreslování.|
|[COleClientItem::GetExtent](#getextent)|Vrátí hranice obdélníku položky OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Načte popisovač na ikonu přidruženou k serveru určitého souboru CLSID.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Získá metasoubor použitý pro kreslení ikony položky.|
|[COleClientItem::GetInplaceWindow](#getinplacewindow)|Vrátí ukazatel na okno pro úpravy položky na místě.|
|[COleClientItem::GetItemState](#getitemstate)|Získá aktuální stav položky.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Vrátí stav poslední operace OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Vrátí režim aktualizace propojené položky (upřesňující funkce).|
|[COleClientItem::GetType](#gettype)|Vrátí typ (vložený, propojený nebo statický) položky OLE.|
|[COleClientItem::GetUserType](#getusertype)|Získá řetězec popisující typ položky.|
|[COleClientItem::IsInplaceActive](#isinplaceactive)|Vrátí hodnotu PRAVDA, pokud je položka aktivní na místě.|
|[COleClientItem::islinkuptodate](#islinkuptodate)|Vrátí hodnotu PRAVDA, pokud je propojená položka aktuální se zdrojovým dokumentem.|
|[COleClientItem::IsModified](#ismodified)|Vrátí hodnotu PRAVDA, pokud byla položka od posledního uložení změněna.|
|[COleClientItem::IsOpen](#isopen)|Vrátí hodnotu PRAVDA, pokud je položka aktuálně otevřena v serverové aplikaci.|
|[COleClientItem::Jespuštěno](#isrunning)|Vrátí hodnotu PRAVDA, pokud je spuštěna serverová aplikace položky.|
|[COleClientItem::OnActivate](#onactivate)|Volat rámci upozornit položku, která je aktivována.|
|[COleClientItem::OnActivateUI](#onactivateui)|Volat rámci upozornit položku, která je aktivována a by měla zobrazit jeho uživatelské rozhraní.|
|[COleClientItem::OnChange](#onchange)|Nazývá se, když server změní položku OLE. Implementace je nutná.|
|[COleClientItem::OnDeaktivovat](#ondeactivate)|Volat rámci při deaktivaci položky.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Volat rámci, když server odebral jeho uživatelské rozhraní na místě.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Volat rámci získat data, která mají být zkopírovány do schránky.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Volat rámci k vytvoření složené nabídky.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Volat rámci odebrat nabídky kontejneru z složené nabídky.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Volat rámci k instalaci a odebrání složené nabídky.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Volat rámci zobrazit a skrýt ovládací panely.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Volat rámci aktualizovat záhlaví okna rámce.|
|[COleClientItem::Znovu aktivovatAndUndo](#reactivateandundo)|Znovu aktivuje položku a znovu provede poslední operaci úprav na místě.|
|[COleClientItem::Vydání](#release)|Uvolní připojení k propojené položce OLE a zavře ji, pokud byla otevřena. Nezničí položku klienta.|
|[COleClientItem::Opětovné načtení](#reload)|Znovu načte položku `ActivateAs`po volání .|
|[COleClientItem::Spustit](#run)|Spustí aplikaci přidruženou k položce.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Nastaví aktuální zobrazení položky pro vykreslování.|
|[COleClientItem::SetExtent](#setextent)|Nastaví ohraničovací obdélník položky OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Nastaví názvy, které server zobrazí při úpravách položky OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Uloží metasoubor použitý k nakreslení ikony položky.|
|[COleClientItem::SetItemRects](#setitemrects)|Nastaví ohraničující obdélník položky.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Nastaví režim aktualizace pro propojenou položku (upřesňující funkci).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Nastaví zařízení pro cíl tisku pro tuto položku klienta.|
|[COleClientItem::UpdateLink](#updatelink)|Aktualizuje mezipaměť prezentace položky.|

### <a name="protected-methods"></a>Chráněné metody

|Name (Název)|Popis|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Volat rámci k určení, zda je povolena aktivace na místě.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Volat rámci při změně pozice položky.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Volat rámci vrátit po aktivaci.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Volat rámci zahodit informace o stavu vrátit položku.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Volat rámci získat ořezové obdélníkové souřadnice.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Volat rámci získat pozici položky vzhledem k zobrazení.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Volat rámci při aktivaci položky na místě.|
|[COleClientItem::onScrollby](#onscrollby)|Volat rámci posunout položku do zobrazení.|
|[COleClientItem::OnShowItem](#onshowitem)|Volat rámci k zobrazení položky OLE.|

## <a name="remarks"></a>Poznámky

Položka OLE představuje data vytvořená a udržovaná serverovou aplikací, která mohou být "bezproblémově" začleněna do dokumentu tak, aby se uživateli jevila jako jeden dokument. Výsledkem je "složený dokument" složený z položky OLE a obsahujícího dokumentu.

Položka OLE může být vložená nebo propojená. Pokud je vložen, jeho data jsou uložena jako součást složeného dokumentu. Pokud je propojen, jeho data jsou uložena jako součást samostatného souboru vytvořeného serverovou aplikací a pouze odkaz na tento soubor je uložen ve složeném dokumentu. Všechny položky OLE obsahují informace určující serverovou aplikaci, která by měla být volána k jejich úpravám.

`COleClientItem`definuje několik overridable funkce, které jsou volány v reakci na požadavky ze serverové aplikace; tyto overridables obvykle působí jako oznámení. To umožňuje serverové aplikaci informovat kontejner o změnách, které uživatel provede při úpravách položky OLE, nebo načíst informace potřebné během úprav.

`COleClientItem`lze použít buď s třídou [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)nebo [COleServerDoc.](../../mfc/reference/coleserverdoc-class.md) Chcete-li použít `COleClientItem`, odvodit třídu z něj a implementovat [OnChange](#onchange) členská funkce, která definuje, jak kontejner reaguje na změny provedené v položce. Chcete-li podporovat aktivaci na místě, přepište člennou funkci [OnGetItemPosition.](#ongetitemposition) Tato funkce poskytuje informace o zobrazené pozici položky OLE.

Další informace o použití rozhraní kontejneru naleznete v článcích [Kontejnery: Implementace kontejneru](../../mfc/containers-implementing-a-container.md) a [aktivace](../../mfc/activation-cpp.md).

> [!NOTE]
> Sada Windows SDK odkazuje na vložené a propojené položky jako "objekty" a odkazuje na typy položek jako "třídy". Tento odkaz používá termín "položka" k rozlišení entity OLE od odpovídajícího objektu C++ a termín "typ" k odlišení kategorie OLE od třídy C++.

## <a name="inheritance-hierarchy"></a>Hierarchie dědičnosti

[CObjekt](../../mfc/reference/cobject-class.md)

[CCmdCíl](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Požadavky

**Záhlaví:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>COleClientItem::Aktivovat

Volání této funkce k provedení zadané ho sloveso namísto [DoVerb](#doverb) tak, aby můžete provést vlastní zpracování při vyvolání výjimky.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nSVNože*<br/>
Určuje sloveso, které má být spuštěno. Může to být jedna z následujících možností:

|Hodnota|Význam|Symbol|
|-----------|-------------|------------|
|- 0|primární požadavek|OLEIVERB_PRIMARY|
|- 1|Sekundární sloveso|(None)|
|- 1|Zobrazit položku pro úpravy|OLEIVERB_SHOW|
|- 2|Upravit položku v samostatném okně|OLEIVERB_OPEN|
|- 3|Skrýt položku|OLEIVERB_HIDE|

Hodnota -1 je obvykle alias pro jiné sloveso. Pokud otevřené úpravy není podporována, -2 má stejný účinek jako -1. Další hodnoty naleznete v tématu [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) v sadě Windows SDK.

*pZobrazit*<br/>
Ukazatel na okno zobrazení kontejneru, které obsahuje položku OLE; Používá se serverová aplikace pro aktivaci na místě. Tento parametr by měl být null, pokud kontejner nepodporuje aktivaci na místě.

*lpMsg*<br/>
Ukazatel na zprávu, která způsobila aktivaci položky.

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace zapsána pomocí knihovny tříd Microsoft Foundation, tato `COleServerItem` funkce způsobí, že členská funkce [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) odpovídajícího objektu bude spuštěna.

Pokud je primární sloveso Upravit a parametr *nVerb* je zadán nula, je spuštěna serverová aplikace, která umožňuje úpravu položky OLE. Pokud aplikace kontejneru podporuje aktivaci na místě, úpravy lze provést na místě. Pokud kontejner nepodporuje aktivaci na místě (nebo pokud je zadáno open sloveso), server se spustí v samostatném okně a úpravy lze provést zde. Obvykle když uživatel aplikace kontejneru poklepe na položku OLE, hodnota pro primární sloveso v *parametru nVerb* určuje, jakou akci může uživatel provést. Pokud však server podporuje pouze jednu akci, provede tuto akci bez ohledu na to, která hodnota je zadána v parametru *nVerb.*

Další informace naleznete v tématu [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) v sadě Windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>COleClientItem::ActivateAs

Používá zařízení ole převodu objektů k aktivaci položky, jako by se jednalo o položku typu určeného *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*lpszUserType*<br/>
Ukazatel na řetězec představující typ cílového uživatele, například "Dokument aplikace Word".

*clsidOld (ClsidOld)*<br/>
Odkaz na aktuální ID třídy položky. ID třídy by měla představovat typ skutečného objektu, jak je uložen, pokud se nejedná o propojení. V takovém případě by měl být CLSID položky, na kterou odkaz odkazuje. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) automaticky poskytuje správné ID třídy pro položku.

*clsidNew*<br/>
Odkaz na ID cílové třídy.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

To se nazývá automaticky [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Obvykle se nenazývá přímo.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>COleClientItem::AttachDataObject

Volání této funkce inicializovat [COleDataObject](../../mfc/reference/coledataobject-class.md) pro přístup k datům v položce OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametry

*rDataObject*<br/>
Odkaz na `COleDataObject` objekt, který bude inicializován, aby byl umožněn přístup k datům v položce OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>COleClientItem::CanActivate

Volat rámci, když uživatel požaduje na místě aktivaci položky OLE; vrácená hodnota této funkce určuje, zda je povolena aktivace na místě.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je povolena aktivace na místě; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace umožňuje aktivaci na místě, pokud kontejner má platné okno. Přepsat tuto funkci implementovat speciální logiku pro přijetí nebo odmítnutí požadavku na aktivaci. Požadavek na aktivaci může být například odmítnut, pokud je položka OLE příliš malá nebo není aktuálně viditelná.

Další informace naleznete v [tématu IOleInPlaceSite::CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) v sadě Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>COleClientItem::CanCreateFromData

Zkontroluje, zda aplikace kontejneru můžete vytvořit `COleDataObject` vložený objekt z daného objektu.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*objekt pDataObject*<br/>
Ukazatel na [cOleDataObject](../../mfc/reference/coledataobject-class.md) objektu, ze kterého má být vytvořena položka OLE.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud kontejner může vytvořit `COleDataObject` vložený objekt z objektu; jinak 0.

### <a name="remarks"></a>Poznámky

Třída `COleDataObject` se používá při přenosu dat pro načítání dat v různých formátech ze schránky, přes přetažení nebo z vložené položky OLE.

Kontejnery mohou pomocí této funkce rozhodnout o povolení nebo zakázání příkazů Upravit vložit a Upravit jinak.

Další informace naleznete v článku [Datové objekty a zdroje dat (OLE).](../../mfc/data-objects-and-data-sources-ole.md)

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>COleClientItem::CanCreateLinkFromData

Zkontroluje, zda aplikace kontejneru můžete `COleDataObject` vytvořit propojený objekt z daného objektu.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*objekt pDataObject*<br/>
Ukazatel na [cOleDataObject](../../mfc/reference/coledataobject-class.md) objektu, ze kterého má být vytvořena položka OLE.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud kontejner může vytvořit `COleDataObject` propojený objekt z objektu.

### <a name="remarks"></a>Poznámky

Třída `COleDataObject` se používá při přenosu dat pro načítání dat v různých formátech ze schránky, přes přetažení nebo z vložené položky OLE.

Kontejnery mohou pomocí této funkce rozhodnout o povolení nebo zakázání příkazů Upravit speciální a Upravit vazbu.

Další informace naleznete v článku [Datové objekty a zdroje dat (OLE).](../../mfc/data-objects-and-data-sources-ole.md)

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>COleClientItem::Lze vložit

Volání této funkce zobrazíte, zda lze vložené položky OLE vložit ze schránky.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud lze vloženou položku OLE vložit ze schránky; jinak 0.

### <a name="remarks"></a>Poznámky

Další informace naleznete v [tématech OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) a [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) v sadě Windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>COleClientItem::CanPasteLink

Volání této funkce zobrazíte, zda lze vloženou propojenou položku OLE ze schránky.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud lze propojenou položku OLE vložit ze schránky; jinak 0.

### <a name="remarks"></a>Poznámky

Další informace naleznete v [tématech OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) a [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) v sadě Windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a>COleClientItem::Zavřít

Volání této funkce změnit stav položky OLE z spuštěného stavu na načtený stav, to znamená, že načteste obslužnou rutinu v paměti, ale se serverem není spuštěn.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Příznak určující, za jakých okolností je položka OLE uložena, když se vrátí do načteného stavu. Může mít jednu z následujících hodnot:

- OLECLOSE_SAVEIFDIRTY Položku OLE uložit.

- OLECLOSE_NOSAVE Neukládejte položku OLE.

- OLECLOSE_PROMPTSAVE Dotázat se uživatele, zda má být položka OLE uložena.

### <a name="remarks"></a>Poznámky

Tato funkce nemá žádný vliv, pokud položka OLE není spuštěna.

Další informace naleznete v tématu [IOleObject::Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) in the Windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>COleClientItem::COleClientItem

Vytvoří `COleClientItem` objekt a přidá jej do kolekce položek dokumentu dokumentu kontejneru, který vytvoří pouze objekt Jazyka C++ a neprovede žádnou inicializaci OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametry

*pContainerDoc*<br/>
Ukazatel na dokument kontejneru, který bude obsahovat tuto položku. To může být všechny [COleDocument](../../mfc/reference/coledocument-class.md) derivát.

### <a name="remarks"></a>Poznámky

Pokud předáte ukazatel NULL, žádné přidání je provedena do dokumentu kontejneru. Musíte explicitně volat [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Před použitím položky OLE je nutné zavolat jednu z následujících členských funkcí vytvoření:

- [VytvořitFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [VytvořitStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [Vytvořit LinkFromData](#createlinkfromdata)

- [Soubor CreateLinkFromFile](#createlinkfromfile)

- [Vytvořitpoložku](#createnewitem)

- [VytvořitCloneFrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>COleClientItem::Převést na

Volání této členské funkce převést položku na typ určený *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*clsidNew*<br/>
ID třídy cílového typu.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

To se nazývá automaticky [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Není nutné volat přímo.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>COleClientItem::CopyToClipboard

Volání této funkce zkopírovat položku OLE do schránky.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
TRUE, pokud by měly být informace o vazbě zkopírovány do schránky, což umožňuje vložení propojené položky; jinak FALSE.

### <a name="remarks"></a>Poznámky

Obvykle voláte tuto funkci při psaní obslužných rutin zpráv pro příkazy Kopírovat nebo Vyjmout z nabídky Upravit. Výběr položek je nutné implementovat v aplikaci kontejneru, pokud chcete implementovat příkazy Kopírovat nebo Vyjmout.

Další informace naleznete v tématu [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) v sadě Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>COleClientItem::CreateCloneFrom

Volání této funkce k vytvoření kopie zadané položky OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametry

*pSrcPoložka*<br/>
Ukazatel na položku OLE, která má být duplikována.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Kopie je shodná se zdrojovou položkou. Tuto funkci můžete použít k podpoře operací se zrušením.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>COleClientItem::CreateFromClipboard

Volánítéto funkce k vytvoření vložené položky z obsahu schránky.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Obvykle voláte tuto funkci z obslužné rutiny zprávy pro příkaz Vložit v nabídce Úpravy. (Příkaz Vložit je povolen v rámci, pokud členská funkce [CanPaste](#canpaste) vrátí nenulovou hodnotu.)

Další informace naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>COleClientItem::CreateFromData

Volání této funkce k vytvoření vložené položky z objektu. `COleDataObject`

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*objekt pDataObject*<br/>
Ukazatel na [cOleDataObject](../../mfc/reference/coledataobject-class.md) objektu, ze kterého má být vytvořena položka OLE.

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Operace přenosu dat, jako je například vkládání ze schránky nebo `COleDataObject` operace přetažení, poskytují objekty obsahující informace nabízené serverovou aplikací. Obvykle se používá v přepsání [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Další informace naleznete v [tématech OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>COleClientItem::CreateFromFile

Volání této funkce k vytvoření vložené položky OLE ze souboru.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*název souboru lpsz*<br/>
Ukazatel na název souboru, ze kterého má být vytvořena položka OLE.

*Identifikátor clsid*<br/>
Vyhrazeno pro budoucí použití.

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Rozhraní Framework volá tuto funkci z [COleInsertDialog::CreateItem,](../../mfc/reference/coleinsertdialog-class.md#createitem) pokud uživatel vybere OK z dialogového okna Vložit objekt, když je vybráno tlačítko Vytvořit ze souboru.

Další informace naleznete v [tématech OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>COleClientItem::CreateLinkFromClipboard

Voláním této funkce vytvořte propojenou položku z obsahu schránky.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Tuto funkci obvykle voláte z obslužné rutiny zprávy pro příkaz Vložit odkaz v nabídce Úpravy. (Příkaz Vložit odkaz je povolen ve výchozí implementaci [COleDocument,](../../mfc/reference/coledocument-class.md) pokud schránka obsahuje položku OLE, se kterou lze propojit.)

Další informace naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>COleClientItem::CreateLinkFromData

Volání této funkce k vytvoření `COleDataObject` propojené položky z objektu.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*objekt pDataObject*<br/>
Ukazatel na [cOleDataObject](../../mfc/reference/coledataobject-class.md) objektu, ze kterého má být vytvořena položka OLE.

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Volání během operace přetažení, když uživatel označuje, že by měl být vytvořen odkaz. Lze jej také použít ke zpracování příkazu Upravit vložit. Je volána rámci `COleClientItem::CreateLinkFromClipboard` v a [cOlePasteSpecialDialog::CreateItem,](../../mfc/reference/colepastespecialdialog-class.md#createitem) když byla vybrána možnost Propojení.

Další informace naleznete v tématech [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>COleClientItem::CreateLinkFromFile

Volání této funkce k vytvoření propojené položky OLE ze souboru.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*název souboru lpsz*<br/>
Ukazatel na název souboru, ze kterého má být vytvořena položka OLE.

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Rozhraní Framework volá tuto funkci, pokud uživatel vybere OK z dialogového okna Vložit objekt, když je zaškrtnuto tlačítko Vytvořit ze souboru a je zaškrtnuto políčko Odkaz. Je volána z [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Další informace naleznete v tématech [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>COleClientItem::CreateNewItem

Volání této funkce k vytvoření vložené položky; Tato funkce spustí serverovou aplikaci, která umožňuje uživateli vytvořit položku OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Identifikátor clsid*<br/>
ID, které jednoznačně identifikuje typ položky OLE, která má být vytvořit.

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Rozhraní Framework volá tuto funkci, pokud uživatel vybere OK z dialogového okna Vložit objekt, když je vybráno tlačítko Vytvořit nový.

Další informace naleznete v [tématech OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>COleClientItem::CreateStaticFromClipboard

Volání této funkce k vytvoření statické položky z obsahu schránky.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Statická položka obsahuje data prezentace, ale ne nativní data; v důsledku toho jej nelze upravovat. Tuto funkci obvykle voláte, pokud se nepodaří členskou funkci [CreateFromClipboard.](#createfromclipboard)

Další informace naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>COleClientItem::CreateStaticFromData

Volání této funkce k vytvoření `COleDataObject` statické položky z objektu.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*objekt pDataObject*<br/>
Ukazatel na [cOleDataObject](../../mfc/reference/coledataobject-class.md) objektu, ze kterého má být vytvořena položka OLE.

*Vykreslení*<br/>
Příznak určující, jak bude server vykreslovat položku OLE. Možné hodnoty naleznete v tématu [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) v sadě Windows SDK.

*cfFormát*<br/>
Určuje datový formát schránky, který má být uložen do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel na [formatetc](/windows/win32/api/objidl/ns-objidl-formatetc) strukturu použitou v *případě, že vykreslení* je OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat další informace o formátu nad rámec formátu schránky určeného *formátem cfFormat*. Pokud tento parametr vynechete, budou pro `FORMATETC` ostatní pole ve struktuře použity výchozí hodnoty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Statická položka obsahuje data prezentace, ale ne nativní data; v důsledku toho jej nelze upravovat. To je v podstatě stejné jako [CreateStaticFromClipboard](#createstaticfromclipboard) s tím `COleDataObject`rozdílem, že statická položka může být vytvořena z libovolné , nejen ze schránky.

Používá se v [COlePasteSpecialDialog::CreateItem,](../../mfc/reference/colepastespecialdialog-class.md#createitem) když je vybrána možnost Statická.

Další informace naleznete v [tématech OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)a [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) v sadě Windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>COleClientItem::Deaktivovat

Voláním této funkce deaktivujte položku OLE a uvolníte všechny přidružené prostředky.

```
void Deactivate();
```

### <a name="remarks"></a>Poznámky

Obvykle deaktivujete aktivní položku OLE na místě, když uživatel klepne myší na klientské oblasti mimo hranice položky. Všimněte si, že deaktivace položky OLE zahodí její stav vrátit, takže není možné volat funkci [člena ReactivateAndUndo.](#reactivateandundo)

Pokud vaše aplikace podporuje vrátit, `Deactivate`nevolejte ; místo toho volejte [DeactivateUI](#deactivateui).

Další informace naleznete v tématu [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) v sadě Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>COleClientItem::DeactivateUI

Volání této funkce, když uživatel deaktivuje položku, která byla aktivována na místě.

```
void DeactivateUI();
```

### <a name="remarks"></a>Poznámky

Tato funkce obnoví uživatelské rozhraní aplikace kontejneru do původního stavu a skryje všechny nabídky a další ovládací prvky, které byly vytvořeny pro aktivaci na místě.

Tato funkce nevyprázdní informace o stavu vrátit do aplikace pro položku. Tyto informace jsou zachovány tak, aby [reactivateAndUndo](#reactivateandundo) lze později použít ke spuštění příkazu vrátit v aplikaci serveru, v případě, že příkaz vrátit kontejner je vybrán ihned po deaktivaci položky.

Další informace naleznete v tématu [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) v sadě Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a>COleClientItem::Delete

Volání této funkce odstranit položku OLE z dokumentu kontejneru.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametry

*bAutoDelete*<br/>
Určuje, zda má být položka z dokumentu odebrána.

### <a name="remarks"></a>Poznámky

Tato funkce volá [release](#release) členskou funkci, která zase odstraní objekt Jazyka C++ pro položku a trvale odebere položku OLE z dokumentu. Pokud je položka OLE vložena, nativní data pro položku se odstraní. Vždy zavře spuštěný server; proto pokud je položka otevřené propojení, tato funkce ji zavře.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>COleClientItem::DoDragDrop

Volání `DoDragDrop` členské funkce k provedení operace přetažení myší.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametry

*lpItemRect*<br/>
Obdélník položky na obrazovce v souřadnicích klienta (pixely).

*ptOffset*<br/>
Posun od *lpItemRect,* kde byla pozice myši v době přetažení.

*bIncludeLink*<br/>
Pokud mají být data propojení zkopírována do schránky, nastavte tuto hodnotu na hodnotu TRUE. Nastavte ji na hodnotu FALSE, pokud serverová aplikace nepodporuje odkazy.

*dwEfekty*<br/>
Určuje efekty, které zdroj přetažení povolí v operaci přetažení.

*lpRectStartDrag*<br/>
Ukazatel na obdélník, který definuje, kde přetažení skutečně začíná. Další informace naleznete v následující části poznámky.

### <a name="return-value"></a>Návratová hodnota

Hodnota DROPEFFECT. Pokud je DROPEFFECT_MOVE, původní data by měla být odebrána.

### <a name="remarks"></a>Poznámky

Operace přetažení se nespustí okamžitě. Čeká, dokud kurzor myši opustí obdélník určený *lpRectStartDrag* nebo dokud neuplyne zadaný počet milisekund. Pokud *lpRectStartDrag* je NULL, velikost obdélníku je jeden pixel.

Doba zpoždění je určena nastavením klíče registru. Čas zpoždění můžete změnit voláním [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) nebo [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Pokud nezadáte čas zpoždění, použije se výchozí hodnota 200 milisekund. Doba zpoždění přetažení je uložena následujícím způsobem:

- Doba zpoždění přetažení systému Windows NT je uložena v HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Windows 3.x Drag delay time je uložen v WIN. ini, v části [Windows}.

- Windows 95/98 Doba zpoždění přetažení je uložena ve verzi win uložené v mezipaměti. Ini.

Další informace o tom, jak jsou informace o zpoždění přetažení uloženy v registru nebo v . INI, viz [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) v sadě Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>COleClientItem::DoVerb

Volání `DoVerb` k provedení zadaného slovesa.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nSVNože*<br/>
Určuje sloveso, které má být spuštěno. Může obsahovat jednu z následujících možností:

|Hodnota|Význam|Symbol|
|-----------|-------------|------------|
|- 0|primární požadavek|OLEIVERB_PRIMARY|
|- 1|Sekundární sloveso|(None)|
|- 1|Zobrazit položku pro úpravy|OLEIVERB_SHOW|
|- 2|Upravit položku v samostatném okně|OLEIVERB_OPEN|
|- 3|Skrýt položku|OLEIVERB_HIDE|

Hodnota -1 je obvykle alias pro jiné sloveso. Pokud otevřené úpravy není podporována, -2 má stejný účinek jako -1. Další hodnoty naleznete v tématu [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) v sadě Windows SDK.

*pZobrazit*<br/>
Ukazatel na okno zobrazení; to je používáno serverem pro aktivaci na místě. Tento parametr by měl být null, pokud aplikace kontejneru neumožňuje aktivaci na místě.

*lpMsg*<br/>
Ukazatel na zprávu, která způsobila aktivaci položky.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud bylo sloveso úspěšně provedeno; jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce volá [aktivovat](#activate) členská funkce k provedení slovesa. Také zachytí výjimky a zobrazí okno se zprávou pro uživatele, pokud je vyvolána.

Pokud je primární sloveso Upravit a parametr *nVerb* je zadán nula, je spuštěna serverová aplikace, která umožňuje úpravu položky OLE. Pokud aplikace kontejneru podporuje aktivaci na místě, úpravy lze provést na místě. Pokud kontejner nepodporuje aktivaci na místě (nebo pokud je zadáno open sloveso), server se spustí v samostatném okně a úpravy lze provést zde. Obvykle když uživatel aplikace kontejneru poklepe na položku OLE, hodnota pro primární sloveso v *parametru nVerb* určuje, jakou akci může uživatel provést. Pokud však server podporuje pouze jednu akci, provede tuto akci bez ohledu na to, která hodnota je zadána v parametru *nVerb.*

## <a name="coleclientitemdraw"></a><a name="draw"></a>COleClientItem::Draw

Volání této funkce k nakreslení položky OLE do zadaného ohraničovacího obdélníku pomocí zadaného kontextu zařízení.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Ukazatel na objekt [CDC,](../../mfc/reference/cdc-class.md) který slouží k kreslení položky OLE.

*lpBounds*<br/>
Ukazatel na [cRect](../../atl-mfc-shared/reference/crect-class.md) `RECT` objekt nebo strukturu, která definuje ohraničující obdélník, ve kterém chcete nakreslit položku OLE (v logických jednotkách určených kontextem zařízení).

*nDrawAspect*<br/>
Určuje aspekt položky OLE, to znamená, jak by měla být zobrazena. Pokud *nDrawAspect* je -1, poslední aspekt nastavit pomocí [SetDrawAspect](#setdrawaspect) se používá. Další informace o možných hodnotách pro tento příznak naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Funkce může použít reprezentaci metasouboru položky OLE vytvořené `COleServerItem`členskou funkcí [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) .

Obvykle se `Draw` používá pro zobrazení na obrazovce, předávání kontextu zařízení obrazovky jako *pDC*. V takovém případě je třeba zadat pouze první dva parametry.

Parametr *lpBounds* identifikuje obdélník v kontextu cílového zařízení (vzhledem k aktuálnímu režimu mapování). Vykreslování může zahrnovat změnu velikosti obrázku a může být použit kontejneru aplikace uložit zobrazení, které se škáluje mezi zobrazené zobrazení a konečné tištěné obrázek.

Další informace naleznete v tématu [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) v sadě Windows SDK.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>COleClientItem::GetActiveView

Vrátí zobrazení, ve kterém je položka aktivována na místě.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na zobrazení; jinak NULL, pokud položka není aktivována na místě.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>COleClientItem::GetCachedExtent

Volání této funkce načíst velikost položky OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*lpVelikost*<br/>
Ukazatel na `SIZE` strukturu nebo [CSize](../../atl-mfc-shared/reference/csize-class.md) objekt, který obdrží informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejíž hranice mají být načteny. Možné hodnoty naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; 0, pokud je položka OLE prázdná.

### <a name="remarks"></a>Poznámky

Tato funkce poskytuje stejné informace jako [GetExtent](#getextent). Můžete však `GetCachedExtent` volat získat informace o rozsahu během zpracování jiných obslužných rutin OLE, [například OnChange](#onchange). Rozměry jsou v MM_HIMETRIC jednotkách.

To je `GetCachedExtent` možné, protože používá rozhraní [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) spíše než použít rozhraní [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) získat rozsah této položky. Objekt `IViewObject2` COM ukládá do mezipaměti informace o rozsahu použité v předchozím volání [iViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Další informace naleznete v tématu [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) v sadě Windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>COleClientItem::GetClassID

Vrátí ID třídy položky do paměti, na kterou se vztahuje *bod pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametry

*id třídy p*<br/>
Ukazatel na identifikátor typu [CLSID](/windows/win32/com/clsid-key-hklm) pro načtení ID třídy. Informace o clsid naleznete v sada Windows SDK.

### <a name="remarks"></a>Poznámky

ID třídy je 128bitové číslo, které jednoznačně identifikuje aplikaci, která položku upřesňuje.

Další informace naleznete v [tématu IPersist::GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) v sadě Windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>COleClientItem::GetClipboardData

Voláním této funkce `COleDataSource` získáte objekt obsahující všechna data, která by byla umístěna do schránky voláním členské funkce [CopyToClipboard.](#copytoclipboard)

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametry

*pZdroj dat*<br/>
Ukazatel na [cOleDataSource](../../mfc/reference/coledatasource-class.md) objekt, který obdrží data obsažená v položce OLE.

*bIncludeLink*<br/>
TRUE, pokud by měla být zahrnuta data propojení; jinak FALSE.

*lpOffset*<br/>
Posun kurzoru myši od počátku objektu v obrazových bodech.

*lpVelikost*<br/>
Velikost objektu v obrazových bodech.

### <a name="remarks"></a>Poznámky

`GetClipboardData`se nazývá jako výchozí implementace [OnGetClipboardData](#ongetclipboarddata). Přepisujte `OnGetClipboardData` pouze v případě, že chcete nabízet datové `CopyToClipboard`formáty kromě formátů nabízených společností . Umístěte tyto formáty `COleDataSource` do objektu `CopyToClipboard`před nebo `COleDataSource` po volání a pak předavěte objekt funkci [COleDataSource::SetClipboard.](../../mfc/reference/coledatasource-class.md#setclipboard) Například pokud chcete, aby pozice položky OLE v dokumentu kontejneru doprovázet ve schránce, byste definovat vlastní formát `COleDataSource` pro `CopyToClipboard`předávání informací a umístit jej před voláním .

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>COleClientItem::GetDocument

Volání této funkce získat ukazatel na dokument, který obsahuje položku OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na dokument, který obsahuje položku OLE. Null, pokud položka není součástí dokumentu.

### <a name="remarks"></a>Poznámky

Tento ukazatel umožňuje `COleDocument` přístup k objektu, který `COleClientItem` jste předali jako argument konstruktoru.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>COleClientItem::GetDrawAspect

Volání `GetDrawAspect` členské funkce k určení aktuální "aspekt" nebo zobrazení položky.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Návratová hodnota

Hodnota z výčtu DVASPECT, jehož hodnoty jsou uvedeny v odkazu pro [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Poznámky

Aspekt určuje, jak má být položka vykreslena.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>COleClientItem::GetExtent

Volání této funkce načíst velikost položky OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametry

*lpVelikost*<br/>
Ukazatel na `SIZE` strukturu `CSize` nebo objekt, který obdrží informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejíž hranice mají být načteny. Možné hodnoty naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; 0, pokud je položka OLE prázdná.

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace zapsána pomocí knihovny tříd Microsoft Foundation, tato `COleServerItem` funkce způsobí, že je volána členská funkce [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) odpovídajícího objektu. Všimněte si, že načtená velikost se může lišit od velikosti poslední sady členovou funkcí [SetExtent;](#setextent) velikost určená `SetExtent` je považována za návrh. Rozměry jsou v MM_HIMETRIC jednotkách.

> [!NOTE]
> Nevolat `GetExtent` během zpracování obslužné rutiny OLE, [například OnChange](#onchange). Místo toho volejte [GetCachedExtent.](#getcachedextent)

Další informace naleznete v [tématu IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) v sadě Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>COleClientItem::GetIconFromRegistry

Volání této členské funkce načíst popisovač na prostředek ikony přidružené k serveru určitého CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametry

*Identifikátor clsid*<br/>
Odkaz na CLSID pro server přidružený k ikoně.

### <a name="return-value"></a>Návratová hodnota

Platný popisovač prostředku ikony nebo null, pokud nelze najít ikonu serveru nebo výchozí ikonu.

### <a name="remarks"></a>Poznámky

Tato členská funkce nespustí server nebo získá ikonu dynamicky, a to ani v případě, že server je již spuštěn. Místo toho tato členská funkce otevře spustitelný obrázek serveru a načte statickou ikonu přidruženou k serveru tak, jak byla zaregistrována.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>COleClientItem::GetIconicMetafile

Načte metasoubor použitý k kreslení ikony položky.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Návratová hodnota

Popisovač metasouboru, pokud je úspěšný; jinak NULL.

### <a name="remarks"></a>Poznámky

Pokud není k dispozici žádná aktuální ikona, je vrácena výchozí ikona. To je voláno automaticky dialogy Knihovny MFC/OLE a obvykle není volána přímo.

Tato funkce také volá [SetIconicMetafile](#seticonicmetafile) do mezipaměti metasoubor pro pozdější použití.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>COleClientItem::GetInplaceWindow

Volání `GetInPlaceWindow` členské funkce získat ukazatel na okno, ve kterém byla položka otevřena pro úpravy na místě.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na okno pro úpravy položky na místě; Null, pokud položka není aktivní nebo pokud její server není k dispozici.

### <a name="remarks"></a>Poznámky

Tato funkce by měla být volána pouze pro položky, které jsou aktivní na místě.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>COleClientItem::GetItemState

Volání této funkce získat aktuální stav položky OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Návratová hodnota

`COleClientItem::ItemState` Výčet hodnoty, která může být jedna z `emptyState` `loadedState`následujících: , , `openState`, `activeState`. `activeUIState` Informace o těchto stavech naleznete v článku [Kontejnery: Stavy položky klienta](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Poznámky

Chcete-li být upozorněni při změně stavu položky OLE, použijte členskou funkci [OnChange.](#onchange)

Další informace naleznete v článku [Kontejnery: Stavy položky klienta](../../mfc/containers-client-item-states.md).

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>COleClientItem::GetLastStatus

Vrátí stavový kód poslední operace OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Návratová hodnota

Hodnota SCODE.

### <a name="remarks"></a>Poznámky

Pro členské funkce, které vracejí bool hodnotu FALSE nebo `GetLastStatus` jiné členské funkce, které vrátí NULL, vrátí podrobnější informace o selhání. Uvědomte si, že většina členských funkcí OLE vyvolat výjimky pro vážnější chyby. Konkrétní informace o interpretaci SCODE závisí na základní ole volání, které naposledy vrátil hodnotu SCODE.

Další informace o kódu SCODE naleznete v [tématu Struktura kódů chyb COM](/windows/win32/com/structure-of-com-error-codes) v dokumentaci k sada Windows SDK.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>COleClientItem::GetLinkUpdateOptions

Volání této funkce získat aktuální hodnotu možnost aktualizace propojení pro položku OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Návratová hodnota

Jedna z následujících hodnot:

- OLEUPDATE_ALWAYS Pokud je to možné, aktualizujte propojenou položku. Tato možnost podporuje přepínací tlačítko Automatická aktualizace odkazu v dialogovém okně Odkazy.

- OLEUPDATE_ONCALL Aktualizovat propojenou položku pouze na žádost aplikace kontejneru (při volání členské funkce [UpdateLink).](#updatelink) Tato možnost podporuje přepínací tlačítko Ruční aktualizace propojení v dialogovém okně Odkazy.

### <a name="remarks"></a>Poznámky

Tohle je pokročilá operace.

Tato funkce je volána automaticky třídou [COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Další informace naleznete v tématu [IOleLink::GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) v sadě Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a>COleClientItem::GetType

Volání této funkce k určení, zda je položka OLE vložené nebo propojené nebo statické.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Návratová hodnota

Nepodepsané celé číslo s jednou z následujících hodnot:

- OT_LINK Položka OLE je odkaz.

- OT_EMBEDDED Položka OLE je vložena.

- OT_STATIC Položka OLE je statická, to znamená, že obsahuje pouze data prezentace, nikoli nativní data, a proto ji nelze upravovat.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>COleClientItem::GetUserType

Volání této funkce získat uživatelem viditelný řetězec popisující typ položky OLE, například "Dokument aplikace Word."

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametry

*nTyp třídy uživatele*<br/>
Hodnota označující požadovanou variantu řetězce popisující typ položky OLE. To může mít jednu z následujících hodnot:

- USERCLASSTYPE_FULL Zobrazí se celé jméno typu, které se uživateli zobrazí.

- USERCLASSTYPE_SHORT Krátký název (maximálně 15 znaků) pro použití v rozbalovacích nabídkách a v dialogovém okně Upravit odkazy.

- USERCLASSTYPE_APPNAME Název aplikace obsluhující třídu.

*rString*<br/>
Odkaz na [CString](../../atl-mfc-shared/reference/cstringt-class.md) objekt, do kterého má být vrácen řetězec popisující typ položky OLE.

### <a name="remarks"></a>Poznámky

Toto je často položka v databázi registrace systému.

Pokud je požadován úplný název typu, ale není k dispozici, místo toho se použije krátký název. Pokud není v registrační databázi nalezena žádná položka pro typ položky OLE nebo pokud pro typ položky OLE nejsou registrovány žádné typy uživatelů, použije se typ uživatele aktuálně uložený v položce OLE. Pokud je tento název uživatelského typu prázdný řetězec, použije se "Neznámý objekt".

Další informace naleznete v [tématu IOleObject::GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) v sadě Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>COleClientItem::IsInplaceActive

Volání této funkce zobrazíte, zda je položka OLE aktivní na místě.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je položka OLE aktivní na místě; jinak 0.

### <a name="remarks"></a>Poznámky

Je běžné spustit různé logiky v závislosti na tom, zda je položka upravována na místě. Funkce zkontroluje, zda je aktuální stav `activeState` položky roven buď nebo `activeUIState`.

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>COleClientItem::islinkuptodate

Volání této funkce zobrazíte, zda je položka OLE aktuální.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je položka OLE aktuální. jinak 0.

### <a name="remarks"></a>Poznámky

Propojená položka může být zastaralá, pokud byl její zdrojový dokument aktualizován. Vložená položka, která obsahuje odkazy v něm může být podobně zastaralá. Funkce provádí rekurzivní kontrolu položky OLE. Všimněte si, že určení, zda je položka OLE zastaralá, může být stejně nákladné jako skutečné provedení aktualizace.

To se nazývá automaticky [cOleLinksDialog](../../mfc/reference/colelinksdialog-class.md) implementace.

Další informace naleznete v [tématu IOleObject::IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) v sadě Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>COleClientItem::IsModified

Volání této funkce zobrazíte, zda je položka OLE znečištěná (upravena od posledního uložení).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je položka OLE znečištěná; jinak 0.

### <a name="remarks"></a>Poznámky

Další informace naleznete v [tématu IPersistStorage::IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) v sadě Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a>COleClientItem::IsOpen

Volání této funkce zobrazíte, zda je položka OLE otevřena; to znamená, že je otevřena v instanci serverové aplikace spuštěné v samostatném okně.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je položka OLE otevřená; jinak 0.

### <a name="remarks"></a>Poznámky

Používá se k určení, kdy nakreslit objekt se šrafovacím vzorem. Otevřený objekt by měl mít šrafovací vzor nakreslený nad objektem. Můžete použít [CRectTracker](../../mfc/reference/crecttracker-class.md) objekt k dosažení tohoto cíle.

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>COleClientItem::Jespuštěno

Volání této funkce zobrazíte, zda je položka OLE spuštěna; to znamená, zda je položka načtena a spuštěna v serverové aplikaci.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je položka OLE spuštěna. jinak 0.

### <a name="remarks"></a>Poznámky

Další informace naleznete v tématu [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) v sadě Windows SDK.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>COleClientItem::OnActivate

Volána rámci upozornit položku, která byla právě aktivována na místě.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Poznámky

Všimněte si, že tato funkce je volána k označení, že server je spuštěn, nikoli znamenat, že jeho uživatelské rozhraní bylo nainstalováno v aplikaci kontejneru. V tomto okamžiku objekt nemá aktivní uživatelské rozhraní `activeUIState`(není ). Nenainstalovala své nabídky nebo panel nástrojů. Členská funkce [OnActivateUI](#onactivateui) je volána, když k tomu dojde.

Výchozí implementace volá členskou funkci [OnChange](#onchange) s OLE_CHANGEDSTATE jako parametrem. Přepište tuto funkci a proveďte vlastní zpracování, když se položka stane aktivní na místě.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>COleClientItem::OnActivateUI

Rozhraní framework `OnActivateUI` volá, když objekt vstoupil do aktivního stavu ui.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Poznámky

Objekt nyní nainstaloval panel nástrojů a nabídky.

Výchozí implementace si pamatuje HWND serveru `GetServerWindow` pro pozdější volání.

## <a name="coleclientitemonchange"></a><a name="onchange"></a>COleClientItem::OnChange

Volat rámci při uživatel upravuje, ukládá nebo zavře položku OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametry

*nKód*<br/>
Důvod, proč server tuto položku změnil. Může mít jednu z následujících hodnot:

- OLE_CHANGED Změnil se vzhled položky OLE.

- OLE_SAVED Položka OLE byla uložena.

- OLE_CLOSED Položka OLE byla uzavřena.

- OLE_CHANGED_STATE Položka OLE byla změněna z jednoho stavu do druhého.

*dwParam*<br/>
Pokud *nCode* je OLE_SAVED nebo OLE_CLOSED, tento parametr se nepoužívá. Pokud *nCode* je OLE_CHANGED, tento parametr určuje aspekt položky OLE, která byla změněna. Možné hodnoty naleznete v parametru *dwParam* [cOleClientItem::Draw](#draw). Pokud *nCode* je OLE_CHANGED_STATE, `COleClientItem::ItemState` tento parametr je výčtová hodnota a popisuje stav, který zadává. Může mít jednu z `emptyState`následujících `openState` `activeState`hodnot: `activeUIState`, `loadedState`, , , nebo .

### <a name="remarks"></a>Poznámky

(Pokud je serverová aplikace napsána pomocí knihovny tříd Microsoft `Notify` Foundation, `COleServerDoc` je `COleServerItem`tato funkce volána jako odpověď na členské funkce nebo .) Výchozí implementace označí dokument kontejneru jako upravený, pokud *nCode* je OLE_CHANGED nebo OLE_SAVED.

Pro OLE_CHANGED_STATE bude aktuální stav vrácený z [GetItemState](#getitemstate) stále starý stav, což znamená stav, který byl aktuální před touto změnou stavu.

Přepsat tuto funkci reagovat na změny ve stavu položky OLE. Obvykle aktualizujete vzhled položky zrušením neplatnosti oblasti, ve které je položka zobrazena. Volání implementace základní třídy na začátku přepsání.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>COleClientItem::OnChangeItemPosition

Volat rámci upozornit kontejneru, že rozsah položky OLE se změnil během aktivace na místě.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametry

*rectPos*<br/>
Označuje pozici položky vzhledem k klientské oblasti aplikace kontejneru.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je pozice položky úspěšně změněna; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace určuje nový viditelný obdélník položky OLE a volá [SetItemRects](#setitemrects) s novými hodnotami. Výchozí implementace vypočítá viditelný obdélník pro položku a předá tyto informace serveru.

Přepište tuto funkci a použijte zvláštní pravidla pro operaci změny velikosti/přesunutí. Pokud je aplikace zapsána v knihovně MFC, výsledkem tohoto volání je, že server s názvem [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>COleClientItem::OnDeaktivovat

Volat rámci při ole položka přechody z aktivního `activeState`stavu na místě ( ) do načteného stavu, což znamená, že je deaktivován po aktivaci na místě.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Poznámky

Všimněte si, že tato funkce je volána k označení, že položka OLE je uzavřena, nikoli, že její uživatelské rozhraní bylo odebráno z aplikace kontejneru. V takovém případě je volána členská funkce [OnDeactivateUI.](#ondeactivateui)

Výchozí implementace volá členskou funkci [OnChange](#onchange) s OLE_CHANGEDSTATE jako parametrem. Přepište tuto funkci a proveďte vlastní zpracování, když je aktivní položka na místě deaktivována. Pokud například podporujete příkaz zpět v aplikaci kontejneru, můžete přepsat tuto funkci a zahodit stav zpět, což znamená, že poslední operaci provedenou na položce OLE nelze vrátit zpět, jakmile je položka deaktivována.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>COleClientItem::OnDeactivateAndUndo

Volat rámci při uživatel vyvolá příkaz vrátit po aktivaci položky OLE na místě.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá [DeactivateUI](#deactivateui) deaktivovat uživatelské rozhraní serveru. Přepsat tuto funkci, pokud implementujete příkaz vrátit do aplikace. V přepsání volejte verzi základní třídy funkce a potom vrátit poslední příkaz spuštěný v aplikaci.

Další informace naleznete v tématu [IOleInPlaceSite::DeactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) v sadě Windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>COleClientItem::OnDeactivateUI

Volána, když uživatel deaktivuje položku, která byla aktivována na místě.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametry

*bNeodáhnutelný*<br/>
Určuje, zda jsou změny úprav nevratné.

### <a name="remarks"></a>Poznámky

Tato funkce obnoví uživatelské rozhraní aplikace kontejneru do původního stavu a skryje všechny nabídky a další ovládací prvky, které byly vytvořeny pro aktivaci na místě.

Pokud *bUndoable* je FALSE, kontejner by měl zakázat příkaz zpět, ve skutečnosti zahodit stav zpět kontejneru, protože označuje, že poslední operace provedená serverem není zpět.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>COleClientItem::OnDiscardUndoState

Volat rámci při uživatel i akce, která zahodí stav zpět při úpravách položky OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace neprovede žádné provádění. Přepsat tuto funkci, pokud implementujete příkaz vrátit do aplikace. V přepsání zahoďte stav vrátit kontejnerovou aplikaci.

Pokud byl server napsán pomocí knihovny tříd Microsoft Foundation, může způsobit volání této funkce voláním [cOleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Další informace naleznete v tématu [IOleInPlaceSite::DiscardUndoState](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) v sadě Windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>COleClientItem::OnGetClipboardData

Volat rámci získat `COleDataSource` objekt obsahující všechna data, která by byla umístěna na schránce voláním buď [CopyToClipboard](#copytoclipboard) nebo [DoDragDrop](#dodragdrop) členské funkce.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Pokud mají být data propojení zkopírována do schránky, nastavte tuto hodnotu na hodnotu TRUE. Pokud serverová aplikace nepodporuje odkazy, nastavte tuto hodnotu na hodnotu NEPRAVDA.

*lpOffset*<br/>
Ukazatel na posun kurzoru myši od počátku objektu v obrazových bodech.

*lpVelikost*<br/>
Ukazatel na velikost objektu v obrazových bodech.

### <a name="return-value"></a>Návratová hodnota

Ukazatel na [cOleDataSource](../../mfc/reference/coledatasource-class.md) objekt obsahující data schránky.

### <a name="remarks"></a>Poznámky

Výchozí implementace této funkce volá [GetClipboardData](#getclipboarddata).

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>COleClientItem::OnGetClipRect

Rozhraní Framework `OnGetClipRect` volá členské funkce získat ořezové obdélník ové souřadnice položky, která je upravována na místě.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametry

*rKlipRect*<br/>
Ukazatel na objekt třídy [CRect,](../../atl-mfc-shared/reference/crect-class.md) který bude obsahovat souřadnice ořezového obdélníku položky.

### <a name="remarks"></a>Poznámky

Souřadnice jsou v obrazových bodech vzhledem k klientské oblasti okna aplikace kontejneru.

Výchozí implementace jednoduše vrátí obdélník klienta zobrazení, ve kterém je položka aktivní na místě.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>COleClientItem::OnGetItemPosition

Rámec volá `OnGetItemPosition` členské funkce získat souřadnice položky, která je upravována na místě.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametry

*rPozice*<br/>
Odkaz na [CRect](../../atl-mfc-shared/reference/crect-class.md) objekt, který bude obsahovat souřadnice pozice položky.

### <a name="remarks"></a>Poznámky

Souřadnice jsou v obrazových bodech vzhledem k klientské oblasti okna aplikace kontejneru.

Výchozí implementace této funkce neprovede žádné provádění. Aplikace, které podporují úpravy na místě, vyžadují jeho implementaci.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>COleClientItem::OnGetWindowContext

Volat rámci při aktivaci položky na místě.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametry

*ppMainFrame*<br/>
Ukazatel na ukazatel na okno hlavního rámce.

*ppDocFrame*<br/>
Ukazatel na ukazatel na okno rámce dokumentu.

*lpFrameInfo*<br/>
Ukazatel na strukturu [OLEINPLACEFRAMEINFO,](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) která obdrží informace o okně rámce.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce se používá k načtení informací o nadřazeném okně položky OLE.

Pokud je kontejner aplikace MDI, výchozí implementace vrátí ukazatel [cmdiframewnd](../../mfc/reference/cmdiframewnd-class.md) objektu v *ppMainFrame* a ukazatel na aktivní [cmdichildwnd](../../mfc/reference/cmdichildwnd-class.md) objekt u *ppDocFrame*. Pokud je kontejner aplikace SDI, výchozí implementace vrátí ukazatel [cframewnd](../../mfc/reference/cframewnd-class.md) objektu v *ppMainFrame* a vrátí NULL v *ppDocFrame*. Výchozí implementace také vyplní členy *lpFrameInfo*.

Přepsat tuto funkci pouze v případě, že výchozí implementace nevyhovuje vaší aplikaci; Například pokud vaše aplikace má paradigma uživatelského rozhraní, které se liší od SDI nebo MDI. Tohle je pokročilé překažné.

Další informace naleznete v [tématu IOleInPlaceSite::GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) a [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) struktury v sadě Windows SDK.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>COleClientItem::OnInsertMenus

Volat rámci během aktivace na místě vložit nabídky aplikace kontejneru do prázdné nabídky.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Odkazuje na prázdnou nabídku.

*lpMenuWidths*<br/>
Odkazuje na pole šesti long hodnot označujících, kolik nabídek je v každé z následujících skupin nabídek: Soubor, Upravit, Kontejner, Objekt, Okno, Nápověda. Aplikace kontejneru je zodpovědná za skupiny nabídek Soubor, Kontejner a Okno, odpovídající prvkům 0, 2 a 4 tohoto pole.

### <a name="remarks"></a>Poznámky

Tato nabídka je pak předána serveru, který vloží vlastní nabídky a vytvoří složenou nabídku. Tato funkce může být volána opakovaně k vytvoření několika složených nabídek.

Výchozí implementace vloží do *pMenuShared* místní nabídky kontejneru; to znamená skupiny nabídek Soubor, Kontejner a Okno. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) se používá k nastavení tohoto prostředku nabídky. Výchozí implementace také přiřadí příslušné hodnoty prvkům 0, 2 a 4 v *lpMenuWidths*, v závislosti na prostředku nabídky. Přepsat tuto funkci, pokud výchozí implementace není vhodná pro vaši aplikaci; například pokud aplikace nepoužívá šablony dokumentů pro přisuzování prostředků s typy dokumentů. Pokud tuto funkci přepíšete, měli byste také přepsat [OnSetMenu](#onsetmenu) a [OnRemoveMenus](#onremovemenus). Tohle je pokročilé překažné.

Další informace naleznete v tématu [IOleInPlaceFrame::InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) v sadě Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>COleClientItem::OnRemoveMenus

Volat rámci odebrat nabídky kontejneru ze zadané složené nabídky při ukončení aktivace na místě.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Odkazuje na složenou nabídku vyrobenou voláním členské funkce [OnInsertMenus.](#oninsertmenus)

### <a name="remarks"></a>Poznámky

Výchozí implementace odebere z *pMenuShared* místní nabídky kontejneru, to znamená soubor, kontejner a okno nabídky skupiny. Přepsat tuto funkci, pokud výchozí implementace není vhodná pro vaši aplikaci; například pokud aplikace nepoužívá šablony dokumentů pro přisuzování prostředků s typy dokumentů. Pokud tuto funkci přepíšete, měli byste pravděpodobně přepsat také [OnInsertMenus](#oninsertmenus) a [OnSetMenu.](#onsetmenu) Tohle je pokročilé překažné.

Podnabídky na *pMenuShared* mohou být sdíleny více než jednou složenou `OnInsertMenus`nabídkou, pokud server opakovaně volal . Proto byste neměli odstraňovat žádné podnabídky `OnRemoveMenus`v přepsání ; měli byste je pouze odpojit.

Další informace naleznete v tématu [IOleInPlaceFrame::RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) v sadě Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>COleClientItem::onScrollby

Volat rámci posunout položku OLE v reakci na požadavky ze serveru.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametry

*sizeExtent*<br/>
Určuje vzdálenosti v obrazových bodech, které se mají posouvat ve směrech x a y.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byla položka posunuta; 0, pokud položku nelze posouvat.

### <a name="remarks"></a>Poznámky

Například pokud je položka OLE částečně viditelná a uživatel se při provádění úprav na místě přesune mimo viditelnou oblast, je tato funkce volána, aby byl kurzor viditelný. Výchozí implementace neprovede žádné provádění. Přepsáním této funkce posouváte položku o zadanou částku. Všimněte si, že v důsledku posouvání může změnit viditelná část položky OLE. Volání [SetItemRects](#setitemrects) aktualizovat viditelné obdélník položky.

Další informace naleznete v tématu [IOleInPlaceSite::Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) v sadě Windows SDK.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>COleClientItem::OnSetMenu

Volat rámci dvakrát při aktivaci na místě začíná a končí; poprvé nainstalovat složené menu a podruhé (s *holemenu* rovno HODNOTĚ NULL) ji odstranit.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Ukazatel na složenou nabídku vyrobenou voláním členské funkce `InsertMenu` [OnInsertMenus](#oninsertmenus) a funkce.

*holemenu*<br/>
Popisovač nabídky vrácené `OleCreateMenuDescriptor` funkce nebo NULL, pokud má být odebrán kód odeslání.

*hwndActiveObject*<br/>
Zpracovat okno pro úpravy položky OLE. Toto je okno, které obdrží příkazy pro úpravy z OLE.

### <a name="remarks"></a>Poznámky

Výchozí implementace nainstaluje nebo odebere složené nabídky a potom volá [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) funkce k instalaci nebo odebrání odeslání kódu. Přepsat tuto funkci, pokud výchozí implementace není vhodná pro vaši aplikaci. Pokud tuto funkci přepíšete, měli byste pravděpodobně přepsat také [OnInsertMenus](#oninsertmenus) a [OnRemoveMenus.](#onremovemenus) Tohle je pokročilé překažné.

Další informace naleznete v [tématech OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)a [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) v sadě Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>COleClientItem::OnShowControlBars

Volat rámci zobrazit a skrýt ovládací panely aplikace kontejneru.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametry

*pFrameWnd*<br/>
Ukazatel na okno rámce aplikace kontejneru. Může se jedná o okno hlavního rámce nebo podřízené okno MDI.

*bZobrazit*<br/>
Určuje, zda mají být ovládací panely zobrazeny nebo skryty.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud volání funkce způsobí změnu stavu ovládacích panelů; 0 Pokud volání nezpůsobí žádnou změnu nebo pokud *pFrameWnd* neukazuje na okno rámce kontejneru.

### <a name="remarks"></a>Poznámky

Tato funkce vrátí hodnotu 0, pokud jsou ovládací panely již ve stavu určeném *parametrem bShow.* K tomu by došlo, například pokud jsou ovládací panely skryté a *bShow* je FALSE.

Výchozí implementace odebere panel nástrojů z okna rámce nejvyšší úrovně.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>COleClientItem::OnShowItem

Volat rámci k zobrazení položky OLE, takže je zcela viditelné během úprav.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Poznámky

Používá se, když aplikace kontejneru podporuje odkazy na vložené položky (to znamená, pokud jste odvozeni třídy dokumentu z [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Tato funkce je volána během aktivace na místě nebo když je položka OLE zdrojem propojení a uživatel ji chce upravit. Výchozí implementace aktivuje první zobrazení v dokumentu kontejneru. Přepsáním této funkce posouváte dokument tak, aby byla položka OLE viditelná.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>COleClientItem::OnUpdateFrameTitle

Volat rámci během aktivace na místě aktualizovat záhlaví okna rámce.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud tato funkce úspěšně aktualizovala název rámce, jinak nula.

### <a name="remarks"></a>Poznámky

Výchozí implementace nezmění název okna rámce. Tuto funkci přepište, pokud chcete pro aplikaci jiný název rámce, například "*položku* *serverové aplikace* - v *názvu dokumentu*" (jako v> Microsoft Excel - tabulka v reportu. DOC"). Tohle je pokročilé překažné.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>COleClientItem::Znovu aktivovatAndUndo

Volání této funkce znovu aktivovat položku OLE a vrátit zpět poslední operaci provedenou uživatelem během úprav na místě.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Pokud aplikace kontejneru podporuje příkaz vrátit, zavolejte tuto funkci, pokud uživatel zvolí příkaz vrátit hned po deaktivaci položky OLE.

Pokud je serverová aplikace napsána pomocí knihoven tříd microsoft foundation, tato funkce způsobí, že server zavolá [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Další informace naleznete v tématu [IOleInPlaceObject::ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) v sadě Windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a>COleClientItem::Vydání

Volání této funkce vyčistit prostředky používané položkou OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Příznak určující, za jakých okolností je položka OLE uložena, když se vrátí do načteného stavu. Seznam možných hodnot naleznete v tématu [COleClientItem::Close](#close).

### <a name="remarks"></a>Poznámky

`Release`je volána `COleClientItem` destruktorem.

Další informace naleznete v [tématu IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) in the Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a>COleClientItem::Opětovné načtení

Zavře a znovu načte položku.

```
BOOL Reload();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Volání `Reload` funkce po aktivaci položky jako položky jiného typu voláním [ActivateAs](#activateas).

## <a name="coleclientitemrun"></a><a name="run"></a>COleClientItem::Spustit

Spustí aplikaci přidruženou k této položce.

```
void Run();
```

### <a name="remarks"></a>Poznámky

Před `Run` aktivací položky zavolejte členská funkci a spusťte serverovou aplikaci. To se provádí automaticky [aktivovat](#activate) a [DoVerb](#doverb), takže obvykle není nutné volat tuto funkci. Volání této funkce, pokud je nutné spustit server, aby bylo možné nastavit atribut položky, například [SetExtent](#setextent), před spuštěním [DoVerb](#doverb).

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>COleClientItem::SetDrawAspect

Volání `SetDrawAspect` členské funkce nastavit "aspekt" nebo zobrazení položky.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametry

*nDrawAspect*<br/>
Hodnota z výčtu DVASPECT. Tento parametr může mít jednu z následujících hodnot:

- DVASPECT_CONTENT Item je reprezentován a to takovým způsobem, že může být zobrazen jako vložený objekt uvnitř kontejneru.

- DVASPECT_THUMBNAIL Položka je vykreslena v "miniatuře", aby ji bylo možné zobrazit v nástroji pro procházení.

- DVASPECT_ICON položka je reprezentována ikonou.

- DVASPECT_DOCPRINT Položka je reprezentována, jako by byla vytištěna pomocí příkazu Tisk z nabídky Soubor.

### <a name="remarks"></a>Poznámky

Aspekt určuje, jak má být položka vykreslena [draw](#draw) při použití výchozí hodnoty pro argument *nDrawAspect* této funkce.

Tato funkce je volána automaticky ikonou změnit (a další mise, která přímo volají dialogové okno Změnit ikonu), aby bylo možné povolit ikonický aspekt zobrazení, pokud o to uživatel požádá.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>COleClientItem::SetExtent

Volání této funkce určit, kolik místa je k dispozici pro položku OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametry

*Velikost*<br/>
[CSize](../../atl-mfc-shared/reference/csize-class.md) objekt, který obsahuje informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejíž hranice mají být nastaveny. Možné hodnoty naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace zapsána pomocí knihovny tříd Microsoft Foundation, `COleServerItem` způsobí to, že je volána členská funkce [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) odpovídajícího objektu. Položka OLE pak můžete upravit jeho zobrazení odpovídajícím způsobem. Rozměry musí být v MM_HIMETRIC jednotkách. Volání této funkce při změně velikosti položky OLE uživatele nebo pokud podporujete nějakou formu vyjednávání rozložení.

Další informace naleznete v tématu [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) v sadě Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>COleClientItem::SetHostNames

Volání této funkce zadejte název aplikace kontejneru a název kontejneru pro vloženou položku OLE.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametry

*lpszHost*<br/>
Ukazatel na uživatelem viditelný název aplikace kontejneru.

*lpszHostObj*<br/>
Ukazatel na identifikační řetězec kontejneru, který obsahuje položku OLE.

### <a name="remarks"></a>Poznámky

Pokud byla serverová aplikace napsána pomocí knihovny tříd Microsoft Foundation, tato `COleServerDoc` funkce volá členskou funkci [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) dokumentu, který obsahuje položku OLE. Tyto informace se používají v názvech oken při úpravách položky OLE. Při každém načtení dokumentu kontejneru framework volá tuto funkci pro všechny položky OLE v dokumentu. `SetHostNames`se vztahuje pouze na vložené položky. Není nutné volat tuto funkci pokaždé, když je aktivována vložená položka OLE pro úpravy.

To se také nazývá automaticky s názvem aplikace a názvem dokumentu při načtení objektu nebo při uložení souboru pod jiným názvem. Proto není obvykle nutné volat tuto funkci přímo.

Další informace naleznete v tématu [IOleObject::SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) v sadě Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>COleClientItem::SetIconicMetafile

Uloží metasoubor použitý k nakreslení ikony položky.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametry

*hMetaPict*<br/>
Úchyt metasouboru použitého k kreslení ikony položky.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Pomocí [geticonicmetafile](#geticonicmetafile) načíst metasoubor.

Parametr *hMetaPict* je zkopírován do položky; proto *hMetaPict* musí být uvolněna volajícím.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>COleClientItem::SetItemRects

Volání této funkce nastavit ohraničovací obdélník nebo viditelný obdélník položky OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*lprcPosRect*<br/>
Ukazatel na obdélník obsahující hranice položky OLE vzhledem k nadřazenému oknu v souřadnicích klienta.

*lprcClipRect*<br/>
Ukazatel na obdélník obsahující hranice viditelné části položky OLE vzhledem k nadřazenému oknu v souřadnicích klienta.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud je úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce je volána výchozí implementací členské funkce [OnChangeItemPosition.](#onchangeitemposition) Tuto funkci byste měli volat vždy, když se změní pozice nebo viditelná část položky OLE. Obvykle to znamená, že jej voláte z členských funkcí [OnSize](../../mfc/reference/cwnd-class.md#onsize) a [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) vašeho zobrazení.

Další informace naleznete v tématu [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) v sadě Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>COleClientItem::SetLinkUpdateOptions

Voláním této funkce nastavte možnost aktualizace odkazu pro prezentaci zadané propojené položky.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametry

*dwUpdateOpt*<br/>
Hodnota možnosti aktualizace odkazu pro tuto položku. Tato hodnota musí být jedna z následujících hodnot:

- OLEUPDATE_ALWAYS Pokud je to možné, aktualizujte propojenou položku. Tato možnost podporuje přepínací tlačítko Automatická aktualizace odkazu v dialogovém okně Odkazy.

- OLEUPDATE_ONCALL Aktualizovat propojenou položku pouze na žádost aplikace kontejneru (při volání členské funkce [UpdateLink).](#updatelink) Tato možnost podporuje přepínací tlačítko Ruční aktualizace propojení v dialogovém okně Odkazy.

### <a name="remarks"></a>Poznámky

Obvykle byste neměli měnit možnosti aktualizace zvolené uživatelem v dialogovém okně Odkazy.

Další informace naleznete v tématu [IOleLink::SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) v sadě Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>COleClientItem::SetPrintDevice

Volánítéto funkce změnit zařízení pro tisk cíl pro tuto položku.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametry

*Ptd*<br/>
Ukazatel na datovou strukturu [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) která obsahuje informace o novém zařízení s cílem tisku. Může být NULL.

*Ppd*<br/>
Ukazatel na datovou strukturu [PRINTDLG,](/windows/win32/api/commdlg/ns-commdlg-printdlga) která obsahuje informace o novém zařízení s cílem tisku. Může být NULL.

### <a name="return-value"></a>Návratová hodnota

Nenulová, pokud byla funkce úspěšná; jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce aktualizuje zařízení pro cíl tisku pro položku, ale neaktualizuje mezipaměť prezentace. Chcete-li aktualizovat mezipaměť prezentace pro položku, volejte [UpdateLink](#updatelink).

Argumenty této funkce obsahují informace, které systém OLE používá k identifikaci cílového zařízení. Struktura `PRINTDLG` obsahuje informace, které systém Windows používá k inicializaci společného tiskového dialogového okna. Poté, co uživatel zavře dialogové okno, vrátí systém Windows informace o výběru uživatele v této struktuře. Člen `m_pd` [cprintdialog](../../mfc/reference/cprintdialog-class.md) objektu `PRINTDLG` je struktura.

Další informace o této struktuře naleznete v [tématu PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) v sadě Windows SDK.

Další informace naleznete v tématu [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) v sadě Windows SDK.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>COleClientItem::UpdateLink

Volání této funkce okamžitě aktualizovat data prezentace položky OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Návratová hodnota

Nenulová na úspěch; jinak 0.

### <a name="remarks"></a>Poznámky

U propojených položek funkce vyhledá zdroj odkazu, aby získala novou prezentaci pro položku OLE. Tento proces může zahrnovat spuštění jedné nebo více serverových aplikací, což může být časově náročné. U vložených položek funkce pracuje rekurzivně, kontrola, zda vložené položky obsahuje odkazy, které mohou být zastaralé a jejich aktualizace. Uživatel může také ručně aktualizovat jednotlivé odkazy pomocí dialogového okna Odkazy.

Další informace naleznete v tématu [IOleLink::Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) v sadě Windows SDK.

## <a name="see-also"></a>Viz také

[Knihovna MFC Ukázka knihovny MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[OKLIENT ukázkový příklad knihovny MFC](../../overview/visual-cpp-samples.md)<br/>
[CDocItem – třída](../../mfc/reference/cdocitem-class.md)<br/>
[Graf hierarchie](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem – třída](../../mfc/reference/coleserveritem-class.md)
