---
title: Coleclientitem – třída
ms.date: 11/04/2016
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 80d28aa6a71adb72b8a3e0f5cd997577d61d0a52
ms.sourcegitcommit: d441305fb19131afbd7fc259d8cda63ea26f2343
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/15/2018
ms.locfileid: "51678584"
---
# <a name="coleclientitem-class"></a>Coleclientitem – třída

Definuje rozhraní kontejneru položek OLE.

## <a name="syntax"></a>Syntaxe

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Členové

### <a name="public-constructors"></a>Veřejné konstruktory

|Název|Popis|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Vytvoří `COleClientItem` objektu.|

### <a name="public-methods"></a>Veřejné metody

|Název|Popis|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Otevře položku OLE pro operace a pak spustí zadaný příkaz.|
|[COleClientItem::ActivateAs](#activateas)|Aktivuje položku jako jiného typu.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Přistupuje k datům v objektu OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Určuje, zda aplikace typu kontejner můžete vytvořit vložený objekt.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Označuje, zda aplikace typu kontejner můžete vytvořit propojeného objektu.|
|[COleClientItem::CanPaste](#canpaste)|Určuje, zda schránky obsahuje Vložitelný nebo statické položky OLE.|
|[COleClientItem::CanPasteLink](#canpastelink)|Určuje, zda schránky obsahuje propojovací položky OLE.|
|[COleClientItem::Close](#close)|Odkaz na server se zavře, ale nezničí položky OLE.|
|[COleClientItem::ConvertTo](#convertto)|Položka převede na jiného typu.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Položky OLE se zkopíruje do schránky.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Vytvoří kopii existující položku.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Vytvoří položku vložené ze schránky.|
|[COleClientItem::CreateFromData](#createfromdata)|Vytvoří vloženou položku z datového objektu.|
|[COleClientItem::CreateFromFile](#createfromfile)|Vytvořit vložený položky ze souboru.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Vytvoří propojené položky ze schránky.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Vytvoří propojenou položku z datového objektu.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Vytvořit propojenou položku ze souboru.|
|[COleClientItem::CreateNewItem](#createnewitem)|Vytvoří novou položku vložený spusťte serverovou aplikaci.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Vytvoří statickou položky ze schránky.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Vytvoří statickou položku z datového objektu.|
|[COleClientItem::Deactivate](#deactivate)|Deaktivuje položku.|
|[COleClientItem::DeactivateUI](#deactivateui)|Uživatelské rozhraní aplikace typu kontejner se obnoví do původního stavu.|
|[COleClientItem::Delete](#delete)|Odstraní nebo zavře položku OLE, pokud byla propojená položka.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Provádí operaci přetažení myší.|
|[COleClientItem::DoVerb](#doverb)|Provede zadanou operaci.|
|[COleClientItem::Draw](#draw)|Nakreslí položku OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Načte zobrazení, na kterém je položka aktivována na místě.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Vrátí rozsah položky OLE obdélník.|
|[COleClientItem::GetClassID](#getclassid)|Získá ID k dispozici položky třídy.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Získá data, která bude umístěn do schránky voláním `CopyToClipboard` členskou funkci.|
|[COleClientItem::GetDocument](#getdocument)|Vrátí `COleDocument` objekt, který obsahuje položky k dispozici.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Získá aktuální zobrazení položky pro vykreslování.|
|[COleClientItem::GetExtent](#getextent)|Vrátí rozsah položky OLE obdélník.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Načte popisovač ikony přidružené k serveru s konkrétní identifikátorem CLSID.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Získá metasoubor použitý pro vykreslení položky ikony.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Vrací ukazatel na okno Úpravy na místě položky.|
|[COleClientItem::GetItemState](#getitemstate)|Získá aktuální stav položky.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Vrátí stav poslední operace OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Vrátí režim aktualizace pro propojenou položku (pokročilé funkce).|
|[COleClientItem::GetType](#gettype)|Vrátí typ položky OLE (vložené, propojené nebo statické).|
|[COleClientItem::GetUserType](#getusertype)|Získá řetězec, který popisuje typ položky.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Vrátí hodnotu PRAVDA, pokud je položka místní aktivní.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Vrátí hodnotu TRUE, pokud propojená položka je aktuální jeho zdrojový dokument.|
|[COleClientItem::IsModified](#ismodified)|Vrátí hodnotu TRUE, pokud položka byla změněna od posledního uložit.|
|[COleClientItem::IsOpen](#isopen)|Vrátí hodnotu TRUE Pokud je položka aktuálně otevřete v serverové aplikaci.|
|[COleClientItem::IsRunning](#isrunning)|Vrátí hodnotu PRAVDA, pokud je položky serverová aplikace spuštěna.|
|[COleClientItem::OnActivate](#onactivate)|Volá se rozhraním oznámit položky, že se aktivuje.|
|[COleClientItem::OnActivateUI](#onactivateui)|Volá se rozhraním položky upozornit, že se aktivuje a by se zobrazit jeho uživatelské rozhraní.|
|[COleClientItem::OnChange](#onchange)|Volá se při změně položky OLE na serveru. Implementace vyžaduje.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Volá se rozhraním, když položka je deaktivováno.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Volá se rozhraním, odebrání jeho místní uživatelské rozhraní serveru.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Volá se rozhraním při získávání dat, které se mají zkopírovat do schránky.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Volá se rozhraním, chcete-li vytvořit složené nabídky.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Volá se rozhraním, chcete-li odebrat se vložily nabídky kontejneru ze složené nabídky.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Volá se rozhraním, instalovat a odebírat složené nabídky.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Volá se rozhraním pro zobrazování a skrytí ovládacích panelů.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Volá se rozhraním, chcete-li aktualizovat okno rámce záhlaví okna.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Aktivuje položku a vrátí zpět poslední operaci úpravy na místě.|
|[COleClientItem::Release](#release)|Uvolní připojení k propojená položka OLE a zavře, pokud byla otevřena. Nezničí klientské položky.|
|[COleClientItem::Reload](#reload)|Znovu načte položky po volání `ActivateAs`.|
|[COleClientItem::Run](#run)|Spuštění aplikace přidružené k položce.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Nastaví položky v aktuálním zobrazení vykreslování.|
|[COleClientItem::SetExtent](#setextent)|Nastaví ohraničující obdélník položky OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Nastaví název serveru se zobrazí při úpravách položky OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Ukládá do mezipaměti metasoubor použitý pro vykreslení položky ikony.|
|[COleClientItem::SetItemRects](#setitemrects)|Nastaví položky ohraničující obdélník.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Nastaví režim aktualizace pro propojenou položku (pokročilé funkce).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Nastaví tiskové cílovému zařízení pro tuto položku klienta.|
|[COleClientItem::UpdateLink](#updatelink)|Aktualizuje mezipaměť prezentace položky.|

### <a name="protected-methods"></a>Chráněné metody

|Název|Popis|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Volá se rozhraním, chcete-li zjistit, jestli je povolená místní aktivace.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Volá se rozhraním, když se změní pozici položky.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Volá se rozhraním, aby zpět po aktivaci.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Volá se rozhraním se zahodit položky informace o stavu vrácení zpět.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Volá se rozhraním, chcete-li získat souřadnice položky obdélník oříznutí.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Volá se rozhraním, chcete-li získat pozici položky vzhledem k zobrazení.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Volá se rozhraním, když položka aktivuje na místě.|
|[COleClientItem::OnScrollBy](#onscrollby)|Volá se rozhraním, přejděte na položku do zobrazení.|
|[COleClientItem::OnShowItem](#onshowitem)|Volá se rozhraním, aby se zobrazila položka OLE.|

## <a name="remarks"></a>Poznámky

Položka OLE. představuje data, vytvářejí a udržují serverové aplikace, které mohou být "bezproblémově" začleněny do dokumentu tak, aby to vypadá, uživatelů a jednom dokumentu. Výsledkem je "složený dokumentu" skládá z položky OLE a aktuálního dokumentu.

Položka OLE. lze vložené nebo propojené. Pokud je vložen, jeho data se ukládají jako součást složeném dokumentu. Pokud je propojený, jeho data se ukládají jako součást samostatného souboru vytvořené serverové aplikace, a pouze odkaz na tento soubor je uložen ve složeném dokumentu. Všechny položky OLE obsahovat informace o určení, která by měla být volána k úpravám je serverová aplikace.

`COleClientItem` definuje několik přepisovatelné funkce, které jsou volány v reakci na požadavky ze serveru aplikace; Tyto k přepisovatelným obvykle fungují jako oznámení. To umožňuje serveru aplikace k informování kontejneru změny provedené uživatelem při úpravách položky OLE nebo načíst informace potřebné při úpravách.

`COleClientItem` je možné buď [coledocument –](../../mfc/reference/coledocument-class.md), [colelinkingdoc –](../../mfc/reference/colelinkingdoc-class.md), nebo [coleserverdoc –](../../mfc/reference/coleserverdoc-class.md) třídy. Použití `COleClientItem`odvodit třídu z něj a implementovat [OnChange](#onchange) členskou funkci, která definuje, jak kontejneru reaguje na změny provedené u položky. Kvůli podpoře aktivace na místě, přepsat [OnGetItemPosition](#ongetitemposition) členskou funkci. Tato funkce poskytuje informace o zobrazené pozici položky OLE.

Další informace o použití rozhraní kontejneru, najdete v článcích [kontejnery: Implementace kontejneru](../../mfc/containers-implementing-a-container.md) a [aktivace](../../mfc/activation-cpp.md).

> [!NOTE]
>  Sada Windows SDK odkazuje na vložené a propojené položky jako "objekty" a odkazuje na typy položek jako "třídy." Tento odkaz používá termín "item" pro odlišení od odpovídající objekt jazyka C++ a termín "typ" pro rozlišení OLE kategorie ze třídy C++ OLE entity.

## <a name="inheritance-hierarchy"></a>Hierarchie dědičnosti

[Třídy CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[Cdocitem –](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Požadavky

**Záhlaví:** afxole.h

##  <a name="activate"></a>  COleClientItem::Activate

Voláním této funkce provedla Zadaná operace. místo [funkce DoVerb](#doverb) tak, že můžete provést vlastní zpracováním, když dojde k výjimce.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Určuje příkaz pro spuštění. Může být jeden z následujících akcí:

|Hodnota|Význam|Symbol|
|-----------|-------------|------------|
|- 0|primární požadavek|OLEIVERB_PRIMARY|
|- 1|Sekundární příkaz|(Žádné)|
|- 1|Položka zobrazení pro úpravy|OLEIVERB_SHOW|
|- 2|Upravit položky v samostatném okně.|OLEIVERB_OPEN|
|- 3|Skrytí položky|OLEIVERB_HIDE|

Hodnota-1 je obvykle alias pro jinou operací. Pokud otevřete úpravy se nepodporují, -2 má stejný účinek jako hodnotu -1. Další hodnoty, najdete v části [Funkce IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) v sadě Windows SDK.

*pView*<br/>
Ukazatel na okno zobrazení kontejneru, který obsahuje položky OLE.; To se používá serverová aplikace pro místní aktivace. Tento parametr by měl mít hodnotu NULL, pokud kontejner nepodporuje aktivace na místě.

*lpMsg*<br/>
Ukazatel na zprávu, která způsobila položka, která má být aktivován.

### <a name="remarks"></a>Poznámky

Serverová aplikace vytvořené pomocí knihovny Microsoft Foundation Class, tato funkce způsobí, že [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) členskou funkci k odpovídající položce `COleServerItem` pro spuštění.

Pokud je primární příkaz Upravit a nula je uveden v *nVerb* parametr, serverová aplikace spuštěna umožňující položky OLE. Chcete-li upravit. Pokud aplikace typu kontejner podporuje aktivace na místě, je na místě provést úpravy. Pokud kontejner nepodporuje místní aktivace (nebo pokud je zadán příkaz Otevřít), server se spustí v samostatném okně a úprav lze provést existuje. Obvykle, když aplikace kontejneru poklepání položky OLE. hodnota primárního operaci v *nVerb* parametr určuje akci, která uživateli umožňuje pořizovat. Nicméně, pokud server podporuje jenom jednu akci, trvá tuto akci, bez ohledu na to, která je zadána hodnota v *nVerb* parametru.

Další informace najdete v tématu [Funkce IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) v sadě Windows SDK.

##  <a name="activateas"></a>  COleClientItem::ActivateAs

Používá k aktivaci položky, jako by šlo položku typu určeného zařízení převodu objektu OLE *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*lpszUserType*<br/>
Ukazatel na řetězec představující typ cílové uživatele, jako je například "Wordový dokument."

*clsidOld*<br/>
ID odkazu na třídu aktuální položky. ID třídy by měly představovat typu objekt, který vede, protože uložené, pokud je to odkaz. V takovém případě je třeba identifikátor CLSID položky, na který odkazuje na odkaz. [Coleconvertdialog –](../../mfc/reference/coleconvertdialog-class.md) automaticky poskytuje ID správné třídy pro položku.

*clsidNew*<br/>
Odkaz na ID cílové třídy.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Tomu se říká automaticky [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Obvykle nevolá přímo.

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

Volání této funkce lze inicializovat [coledataobject –](../../mfc/reference/coledataobject-class.md) pro přístup k datům v položky OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametry

*rDataObject*<br/>
Odkaz `COleDataObject` objekt, který bude inicializována tak umožnit přístup k datům v položky OLE.

##  <a name="canactivate"></a>  COleClientItem::CanActivate

Volá se rozhraním, když uživatel požádá o místní aktivace položky OLE.; Tato funkce návratová hodnota určuje, jestli je povolená místní aktivace.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je povolená místní aktivace; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace umožňuje aktivace na místě, pokud kontejner má platný okno. Potlačí tuto funkci, která implementuje zvláštní logiku pro přijetí nebo zamítnutí žádosti o aktivaci. Požadavek na aktivaci můžete například zamítne, pokud položka OLE je příliš malá nebo aktuálně viditelné.

Další informace najdete v tématu [IOleInPlaceSite::CanInPlaceActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) v sadě Windows SDK.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Zkontroluje, jestli aplikace typu kontejner můžete vytvořit vložený objekt daného `COleDataObject` objektu.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel [coledataobject –](../../mfc/reference/coledataobject-class.md) objektu, ze kterého se má vytvořit položky OLE.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud kontejner můžete vytvořit vložený objekt `COleDataObject` objektu; jinak 0.

### <a name="remarks"></a>Poznámky

`COleDataObject` Třídy je používáno v přenosech dat pro načtení dat v různých formátech ze schránky pomocí přetažení, nebo z vložené položky OLE.

Tuto funkci můžete rozhodnout k povolení nebo zakázání jejich příkazy upravit vložení a upravit Vložit jinak použít kontejnery.

Další informace najdete v článku [datové objekty a zdroje dat (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Zkontroluje, jestli aplikace typu kontejner můžete vytvořit objekt odkazovaný z daný `COleDataObject` objektu.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel [coledataobject –](../../mfc/reference/coledataobject-class.md) objektu, ze kterého se má vytvořit položky OLE.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud kontejner můžete vytvořit objekt odkazovaný z `COleDataObject` objektu.

### <a name="remarks"></a>Poznámky

`COleDataObject` Třídy je používáno v přenosech dat pro načtení dat v různých formátech ze schránky pomocí přetažení, nebo z vložené položky OLE.

Kontejnery můžete použít tuto funkci se rozhodnout, k povolení nebo zakázání jejich příkazy upravit Vložit jinak a vložit odkaz upravit.

Další informace najdete v článku [datové objekty a zdroje dat (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>  COleClientItem::CanPaste

Voláním této funkce najdete v článku, zda lze ze schránky vložit vložené položky OLE.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud vložené položky OLE můžete vložit ze schránky; jinak 0.

### <a name="remarks"></a>Poznámky

Další informace najdete v tématu [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) a [OleQueryCreateFromData](/windows/desktop/api/ole2/nf-ole2-olequerycreatefromdata) v sadě Windows SDK.

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

Voláním této funkce najdete v článku, zda propojená položka OLE můžete vkládaná ze schránky.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud ze schránky; můžete vložit propojené položky OLE. jinak 0.

### <a name="remarks"></a>Poznámky

Další informace najdete v tématu [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) a [OleQueryLinkFromData](/windows/desktop/api/ole2/nf-ole2-olequerylinkfromdata) v sadě Windows SDK.

##  <a name="close"></a>  COleClientItem::Close

Voláním této funkce změnit stav položky OLE do stavu spuštěno načíst stav, to znamená, načtení se její obslužná rutina v paměti, ale server není spuštěný.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Příznak určující, za jakých okolností je uložen položky OLE. až se obnoví načíst stav. Může mít jednu z následujících hodnot:

- Položka OLECLOSE_SAVEIFDIRTY uložit OLE.

- OLECLOSE_NOSAVE neukládejte položky OLE.

- OLECLOSE_PROMPTSAVE výzvu na, jestli se má uložit položky OLE.

### <a name="remarks"></a>Poznámky

Tato funkce nemá žádný vliv, pokud neběží položky OLE.

Další informace najdete v tématu [IOleObject::Close](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-close) v sadě Windows SDK.

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

Vytvoří `COleClientItem` objektu a přidá jej do dokumentu kontejneru kolekce položek dokumentu, která vytvoří objekt jazyka C++ a neprovádí žádné inicializace technologie OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametry

*pContainerDoc*<br/>
Ukazatel na dokument kontejneru, který bude obsahovat této položky. Může to být [coledocument –](../../mfc/reference/coledocument-class.md) odvozených děl na základě.

### <a name="remarks"></a>Poznámky

Pokud předáte ukazatele s hodnotou NULL, bez přidání provedené dokumentu kontejneru. Musíte explicitně volat [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Před použitím položky OLE se musí volat jednu z následujících členské funkce vytvoření:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

Voláním této členské funkce pro převod položky typu určeného *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*clsidNew*<br/>
ID třídy cílového typu.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Tomu se říká automaticky [coleconvertdialog –](../../mfc/reference/coleconvertdialog-class.md). Není nutné volat přímo.

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

Voláním této funkce do schránky Kopírovat položky OLE.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Hodnota TRUE, pokud informace o propojení by měl zkopíroval do schránky, což propojenou položku, aby ho šlo vložit; v opačném případě FALSE.

### <a name="remarks"></a>Poznámky

Při zápisu obslužné rutiny zpráv pro příkaz kopírování nebo vyjmutí z nabídky Úpravy se obvykle voláním této funkce. Pokud chcete provádět příkazy kopírování nebo vyjmutí, je nutné implementovat výběr položky v kontejneru aplikace.

Další informace najdete v tématu [OleSetClipboard](/windows/desktop/api/ole2/nf-ole2-olesetclipboard) v sadě Windows SDK.

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

Voláním této funkce a vytvořte kopii zadané položky OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametry

*pSrcItem*<br/>
Ukazatel na položky OLE, která má být duplicitní.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Kopie je stejný jako zdrojová položka. Tuto funkci můžete použít pro podporu operací vrácení zpět.

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

Voláním této funkce k vytvoření vloženou položku z obsah schránky.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Obvykle voláním této funkce z obslužné rutiny zpráv pro vložení příkaz v nabídce Úpravy. (Příkaz Paste je povolené rozhraním, pokud [CanPaste](#canpaste) členská funkce vrátí nenulovou hodnotu.)

Další informace najdete v tématu [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Voláním této funkce k vytvoření vloženou položku z `COleDataObject` objektu.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel [coledataobject –](../../mfc/reference/coledataobject-class.md) objektu, ze kterého se má vytvořit položky OLE.

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Operace přenosu dat, jako je například vložení ze schránky nebo operace přetažení myší, zadat `COleDataObject` objekty obsahující informace o nabízených serverové aplikace. Obvykle se používá v přepsání metody [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Další informace najdete v tématu [OleCreateFromData](/windows/desktop/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

Volání této funkce můžete vytvořit ze souboru vložené položky OLE.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Ukazatel na název souboru, ze kterého se má vytvořit položky OLE.

*identifikátor CLSID*<br/>
Vyhrazeno pro budoucí použití.

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Rozhraní volá tuto funkci z [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) Pokud uživatel zvolí OK v dialogovém okně Vložit objekt, pokud je vybrána vytvořit ze souboru – tlačítko.

Další informace najdete v tématu [OleCreateFromFile](/windows/desktop/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

Voláním této funkce pro vytvoření propojené položky z obsahu schránky.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Obvykle voláním této funkce z obslužné rutiny zpráv pro příkaz Vložit odkaz v nabídce Úpravy. (Vložit odkaz příkaz je povolen ve výchozí implementaci [coledocument –](../../mfc/reference/coledocument-class.md) Jestliže schránky obsahuje položky OLE, který může být propojený.)

Další informace najdete v tématu [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Voláním této funkce pro vytvoření propojené položky z `COleDataObject` objektu.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel [coledataobject –](../../mfc/reference/coledataobject-class.md) objektu, ze kterého se má vytvořit položky OLE.

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Volejte to během operace přetažení, když uživatel označuje, že by měl být vytvořen odkaz. To také umožňuje zpracovat příkaz Upravit vložit. Volá se rozhraním, v `COleClientItem::CreateLinkFromClipboard` a [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) Pokud byla zvolena možnost odkaz.

Další informace najdete v tématu [OleCreateLinkFromData](/windows/desktop/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Voláním této funkce pro vytvoření propojené položky OLE. ze souboru.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Ukazatel na název souboru, ze kterého se má vytvořit položky OLE.

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Rozhraní volá tuto funkci, pokud uživatel zvolí OK v dialogovém okně Vložit objekt, pokud je vybrána vytvořit ze souboru – tlačítko a zaškrtněte políčko odkaz. Je volána z [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Další informace najdete v tématu [OleCreateLinkToFile](/windows/desktop/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

Voláním této funkce k vytvoření vloženou položku; Tato funkce spustí serverové aplikace, který umožňuje uživateli vytvořit položky OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*identifikátor CLSID*<br/>
ID, které jednoznačně identifikuje typ položky OLE. Chcete-li vytvořit.

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Rozhraní volá tuto funkci, pokud uživatel zvolí OK v dialogovém okně Vložit objekt při výběru tlačítka vytvořit nový.

Další informace najdete v tématu [OleCreate](/windows/desktop/api/ole/nf-ole-olecreate), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

Voláním této funkce pro vytvoření statické položky z obsah schránky.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Statické položka obsahuje prezentaci dat, ale ne nativní data; proto jej nelze upravit. Pokud se obvykle voláním této funkce [CreateFromClipboard](#createfromclipboard) členská funkce se nezdaří.

Další informace najdete v tématu [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Voláním této funkce pro vytvoření statické položky z `COleDataObject` objektu.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Ukazatel [coledataobject –](../../mfc/reference/coledataobject-class.md) objektu, ze kterého se má vytvořit položky OLE.

*Vykreslení*<br/>
Příznak určující, jak server bude vykreslení položky OLE. Možné hodnoty najdete v části [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) v sadě Windows SDK.

*cfFormat*<br/>
Určuje formát dat schránky do mezipaměti při vytváření položky OLE.

*lpFormatEtc*<br/>
Ukazatel [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura používá, pokud *vykreslení* OLERENDER_FORMAT nebo OLERENDER_DRAW. Zadejte hodnotu pro tento parametr pouze v případě, že chcete zadat informace o dalších formátu nad rámec formátu schránky určeném *cfFormat*. Pokud tento parametr vynecháte, budou použity výchozí hodnoty pro ostatní pole v `FORMATETC` struktury.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Statické položka obsahuje prezentaci dat, ale ne nativní data; v důsledku toho jej nebylo možné upravovat. Je to v podstatě stejné jako [CreateStaticFromClipboard](#createstaticfromclipboard) s tím rozdílem, že statické položky lze vytvořit z libovolnou `COleDataObject`, ne jenom ze schránky.

Použít v [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) při výběru statické.

Další informace najdete v tématu [OleCreateStaticFromData](/windows/desktop/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), a [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) v sadě Windows SDK.

##  <a name="deactivate"></a>  COleClientItem::Deactivate

Voláním této funkce deaktivace položky OLE a uvolněte veškeré související prostředky.

```
void Deactivate();
```

### <a name="remarks"></a>Poznámky

Místní aktivní položky OLE se obvykle deaktivovat, když uživatel klikne myší na klientské oblasti mimo hranice položky. Všimněte si, že deaktivace položky OLE se zahodí jeho stav vracení zpět v důsledku toho nebudete volat [ReactivateAndUndo](#reactivateandundo) členskou funkci.

Pokud vaše aplikace podporuje vrácení zpět, nevolejte `Deactivate`; místo toho volat [DeactivateUI](#deactivateui).

Další informace najdete v tématu [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) v sadě Windows SDK.

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

Voláním této funkce, když uživatel deaktivuje položku, která se aktivovala na místě.

```
void DeactivateUI();
```

### <a name="remarks"></a>Poznámky

Tato funkce obnoví uživatelské rozhraní aplikace typu kontejner do původního stavu, skrytí všechny nabídky a další ovládací prvky, které byly vytvořeny pro aktivace na místě.

Tato funkce není vyprázdnění zpět informace o stavu pro položku. Informace se uchovávají tak, aby [ReactivateAndUndo](#reactivateandundo) můžete později použít k provedení příkazu k vrácení zpět v serverové aplikaci, v případě, že příkaz zpět kontejneru je vybrán ihned po deaktivaci položky.

Další informace najdete v tématu [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) v sadě Windows SDK.

##  <a name="delete"></a>  COleClientItem::Delete

Voláním této funkce z dokumentu kontejneru odstranit položky OLE.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametry

*bAutoDelete*<br/>
Určuje, zda je položka k odebrání z dokumentu.

### <a name="remarks"></a>Poznámky

Tato funkce volá [vydání](#release) členskou funkci, která zase odstraní objekt jazyka C++ položky, trvalé odebrání položky OLE. z dokumentu. Pokud je vložené položky OLE, odstraní se nativní data pro položku. Vždy zavře spuštěný server; Proto pokud je položka Otevřít odkaz, tato funkce zavře.

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

Volání `DoDragDrop` členská funkce k provedení operace přetažení myší.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametry

*lpItemRect*<br/>
Obdélník položky na obrazovce v souřadnicích klienta (v pixelech).

*ptOffset*<br/>
Posun od *lpItemRect* kde byl pozice myši při přetažení.

*bIncludeLink*<br/>
Nastavte na hodnotu TRUE, pokud propojení, které mají být data zkopírována do schránky. Nastavte ho na hodnotu FALSE, pokud vaše serverová aplikace nepodporuje odkazy.

*dwEffects*<br/>
Určuje efekty, které vám umožní zdroji přetažení v operaci přetažení.

*lpRectStartDrag*<br/>
Ukazatel na obdélník, který definuje, ve kterém ve skutečnosti spustí přetahování. Další informace naleznete v následující části poznámky.

### <a name="return-value"></a>Návratová hodnota

Hodnota DROPEFFECT. Pokud je DROPEFFECT_MOVE, byste měli odebrat původní data.

### <a name="remarks"></a>Poznámky

Operace přetažení myší nespustí ihned. To počká, dokud kurzor myši opustí obdélník určené *lpRectStartDrag* nebo dokud se zadaný počet milisekund prošly. Pokud *lpRectStartDrag* má hodnotu NULL, je velikost pravoúhelníku jeden pixel.

Doba zpoždění je určené nastavení klíče registru. Doba zpoždění lze změnit pomocí volání [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) nebo [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Pokud nezadáte čas zpoždění, je použita výchozí hodnota 200 MS. Přetáhněte zpoždění je uložen následujícím způsobem:

- Doba zpoždění přetáhněte Windows NT se ukládají do HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Doba zpoždění přetáhněte 3.x Windows se ukládají do VÍTĚZSTVÍ. Soubor INI [Windows} oddílu.

- Přetáhněte Windows 95/98 zpoždění je uložen v mezipaměti verzi Windows. INI.

Pro další informace o tom, přetáhněte zpoždění informace jsou uloženy v registru buď nebo. Soubor INI, naleznete v tématu [WriteProfileString](/windows/desktop/api/winbase/nf-winbase-writeprofilestringa) v sadě Windows SDK.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Volání `DoVerb` k provedení zadané operace.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Určuje příkaz pro spuštění. Může obsahovat jednu z následujících akcí:

|Hodnota|Význam|Symbol|
|-----------|-------------|------------|
|- 0|primární požadavek|OLEIVERB_PRIMARY|
|- 1|Sekundární příkaz|(Žádné)|
|- 1|Položka zobrazení pro úpravy|OLEIVERB_SHOW|
|- 2|Upravit položky v samostatném okně.|OLEIVERB_OPEN|
|- 3|Skrytí položky|OLEIVERB_HIDE|

Hodnota-1 je obvykle alias pro jinou operací. Pokud otevřete úpravy se nepodporují, -2 má stejný účinek jako hodnotu -1. Další hodnoty, najdete v části [Funkce IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) v sadě Windows SDK.

*pView*<br/>
Ukazatel na zobrazení okna. To se používá server pro místní aktivace. Tento parametr by měl mít hodnotu NULL, pokud aplikace typu kontejner neumožňuje aktivace na místě.

*lpMsg*<br/>
Ukazatel na zprávu, která způsobila položka, která má být aktivován.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud se příkaz úspěšně provedl; jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce volá [aktivovat](#activate) členská funkce k provedení operace. Také zachytává výjimky a zobrazí okno se zprávou pro uživatele, pokud je vyvolána jedna.

Pokud je primární příkaz Upravit a nula je uveden v *nVerb* parametr, serverová aplikace spuštěna umožňující položky OLE. Chcete-li upravit. Pokud aplikace typu kontejner podporuje aktivace na místě, je na místě provést úpravy. Pokud kontejner nepodporuje místní aktivace (nebo pokud je zadán příkaz Otevřít), server se spustí v samostatném okně a úprav lze provést existuje. Obvykle, když aplikace kontejneru poklepání položky OLE. hodnota primárního operaci v *nVerb* parametr určuje akci, která uživateli umožňuje pořizovat. Nicméně, pokud server podporuje jenom jednu akci, trvá tuto akci, bez ohledu na to, která je zadána hodnota v *nVerb* parametru.

##  <a name="draw"></a>  COleClientItem::Draw

Voláním této funkce vykreslení položky OLE do zadaného ohraničující obdélník v kontextu zadané zařízení.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*primární řadič domény*<br/>
Ukazatel [CDC](../../mfc/reference/cdc-class.md) objektu použitém pro vykreslení položky OLE.

*lpBounds*<br/>
Ukazatel [crect –](../../atl-mfc-shared/reference/crect-class.md) objektu nebo `RECT` strukturu, která definuje ohraničující obdélník, ve kterém k vykreslení položky OLE (v logických jednotkách, které se určuje podle kontextu zařízení).

*nDrawAspect*<br/>
Určuje aspekt OLE položky, to znamená, jak by se měla zobrazit. Pokud *nDrawAspect* se -1, poslední aspekt nastavení s použitím [SetDrawAspect](#setdrawaspect) se používá. Další informace o možných hodnot pro tento příznak, naleznete v tématu [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Funkce může používat znázornění metasouboru položky OLE, které jsou vytvořené [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) členskou funkci `COleServerItem`.

Obvykle použijete `Draw` pro zobrazení obrazovky předání kontextu zařízení obrazovky jako *primárního řadiče domény*. V takovém případě musíte zadat jenom první dva parametry.

*LpBounds* parametr identifikuje obdélníku v kontextu cílového zařízení (vzhledem k aktuální mapování režim). Vykreslování může zahrnovat škálování na obrázku a je možné uložit zobrazení, která se škáluje mezi použité zobrazení a konečném obrazu vytištěné kontejneru aplikace.

Další informace najdete v tématu [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw) v sadě Windows SDK.

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

Vrátí zobrazení, na kterém je položka místní aktivaci.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na zobrazení. jinak hodnota NULL, pokud položka není místní aktivaci.

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

Voláním této funkce se načíst velikost položky OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Ukazatel `SIZE` struktury nebo [CSize](../../atl-mfc-shared/reference/csize-class.md) objekt, který se zobrazí informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejichž rozsah se mají načíst. Možné hodnoty najdete v části [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. 0, pokud je prázdné položky OLE.

### <a name="remarks"></a>Poznámky

Tato funkce poskytuje stejné informace jako [GetExtent](#getextent). Můžete však volat `GetCachedExtent` zobrazíte informace o rozsahu během zpracování ostatních obslužných rutin OLE [OnChange](#onchange). Rozměry jsou v jednotkách MM_HIMETRIC.

To je možné, protože `GetCachedExtent` používá [IViewObject2](/windows/desktop/api/oleidl/nn-oleidl-iviewobject2) rozhraní místo použití [IOleObject](/windows/desktop/api/oleidl/nn-oleidl-ioleobject) rozhraní, aby se získal rozsah této položky. `IViewObject2` Objekt modelu COM ukládá do mezipaměti informace o rozsahu použité při předchozím volání funkce [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw).

Další informace najdete v tématu [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) v sadě Windows SDK.

##  <a name="getclassid"></a>  COleClientItem::GetClassID

Vrátí ID třídy položky do paměti, na které odkazuje *pClassID má*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametry

*pClassID má*<br/>
Ukazatel na identifikátor typu [CLSID](/windows/desktop/com/clsid-key-hklm) načíst ID třídy. Informace o identifikátoru CLSID naleznete v tématu Windows SDK.

### <a name="remarks"></a>Poznámky

ID třídy je 128bitové číslo, které jednoznačně identifikuje aplikaci, která upraví položka.

Další informace najdete v tématu [IPersist::GetClassID](/windows/desktop/api/objidl/nf-objidl-ipersist-getclassid) v sadě Windows SDK.

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

Voláním této funkce získáte `COleDataSource` objekt, který obsahuje všechna data, které by měly umístit do schránky voláním [CopyToClipboard](#copytoclipboard) členskou funkci.

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametry

*pDataSource*<br/>
Ukazatel [coledatasource –](../../mfc/reference/coledatasource-class.md) objekt, který se zobrazí data obsažená v položky OLE.

*bIncludeLink*<br/>
Hodnota TRUE, pokud propojení dat by měly být zahrnuty; v opačném případě FALSE.

*lpOffset*<br/>
Posun kurzoru myši ze zdroje objektu v pixelech.

*lpSize*<br/>
Velikost objektu v pixelech.

### <a name="remarks"></a>Poznámky

`GetClipboardData` volá se jako výchozí implementace [OnGetClipboardData](#ongetclipboarddata). Přepsat `OnGetClipboardData` pouze v případě, že chcete nabízet data formáty kromě těch, které nabízí `CopyToClipboard`. Umístit do těchto formátů `COleDataSource` objekt před nebo po volání `CopyToClipboard`a pak předejte `COleDataSource` objektu [COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) funkce. Například pokud chcete položky OLE. umístění ve svém kontejneru dokumentu vyvíjený do schránky, můžete by definovat vlastní formát pro předání těchto informací a jeho umístění `COleDataSource` před voláním `CopyToClipboard`.

##  <a name="getdocument"></a>  COleClientItem::GetDocument

Volání této funkce získáte ukazatel na dokument, který obsahuje položky OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel na dokument, který obsahuje položky OLE. Hodnota NULL, pokud položka není součástí dokumentu.

### <a name="remarks"></a>Poznámky

This – ukazatel umožňuje přístup ke `COleDocument` objekt, který je předán jako argument `COleClientItem` konstruktor.

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

Volání `GetDrawAspect` členskou funkci k určení aktuální "aspekt", nebo zobrazení položky.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Návratová hodnota

Hodnota z výčtu DVASPECT, jejichž hodnoty jsou uvedeny v referenční dokumentaci pro [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Poznámky

Aspekt Určuje, jak má být vykreslen položky.

##  <a name="getextent"></a>  COleClientItem::GetExtent

Voláním této funkce se načíst velikost položky OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Ukazatel `SIZE` struktury nebo `CSize` objekt, který se zobrazí informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejichž rozsah se mají načíst. Možné hodnoty najdete v části [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. 0, pokud je prázdné položky OLE.

### <a name="remarks"></a>Poznámky

Serverová aplikace vytvořené pomocí knihovny Microsoft Foundation Class, tato funkce způsobí, že [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) členskou funkci k odpovídající položce `COleServerItem` objektu, která se má volat. Mějte na paměti, že velikost načtených může lišit od velikosti poslední nastavil [SetExtent](#setextent) členské funkce; velikost určená `SetExtent` je považován za návrh. Rozměry jsou v jednotkách MM_HIMETRIC.

> [!NOTE]
>  Nevolejte `GetExtent` během zpracování obslužnou rutinu OLE, jako například [OnChange](#onchange). Volání [GetCachedExtent](#getcachedextent) místo.

Další informace najdete v tématu [IOleObject::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getextent) v sadě Windows SDK.

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

Voláním této členské funkce načíst popisovač pro prostředek s ikonou přidružené k serveru s konkrétní identifikátorem CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametry

*identifikátor CLSID*<br/>
Odkaz na identifikátor CLSID pro server spojený s ikonou.

### <a name="return-value"></a>Návratová hodnota

Platný popisovač prostředku ikony, nebo hodnota NULL, pokud nelze nalézt ikona serveru nebo výchozí ikona.

### <a name="remarks"></a>Poznámky

Tato členská funkce nebude spuštění serveru nebo získat ikona dynamicky, i v případě, že na serveru už běží. Místo toho tato členská funkce otevře spustitelnou bitovou kopii serveru a načte statické ikony přidružené k serveru jako byl zaregistrován.

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

Načte metasoubor použitý pro vykreslení položky ikony.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Návratová hodnota

Popisovač pro tento metasoubor v případě úspěchu; v opačném případě hodnota NULL.

### <a name="remarks"></a>Poznámky

Pokud není k dispozici žádná aktuální ikona, vrátí se výchozí ikona. To je volána automaticky metodou dialogová okna MFC/OLE a obvykle nevolá přímo.

Tato funkce také volá [SetIconicMetafile](#seticonicmetafile) pro ukládání do mezipaměti metasoubor pro pozdější použití.

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

Volání `GetInPlaceWindow` členskou funkci pro získání ukazatele na okno, ve které se otevřelo položky pro místní úpravy.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Návratová hodnota

Ukazatel položku místní úpravy okna. Hodnota NULL, pokud položka není aktivní nebo pokud není k dispozici její server.

### <a name="remarks"></a>Poznámky

Tuto funkci lze volat pouze pro položky, které jsou na místě aktivní.

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

Volání této funkce získáte aktuální stav položky OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Návratová hodnota

A `COleClientItem::ItemState` výčtu hodnotu, která může být jedna z následujících akcí: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Informace o tyto stavy, najdete v článku [kontejnery: stavy klientských položek](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Poznámky

Upozornění při změně stavu položky OLE. použijte [OnChange](#onchange) členskou funkci.

Další informace najdete v článku [kontejnery: stavy klientských položek](../../mfc/containers-client-item-states.md).

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

Vrátí stavový kód poslední operaci OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Návratová hodnota

Hodnota typu SCODE.

### <a name="remarks"></a>Poznámky

Pro členské funkce, které vrací funkce, které vrací hodnotu NULL, BOOL hodnotu FALSE nebo jiný člen `GetLastStatus` vrátí podrobnější informace o selhání. Mějte na paměti, že většina OLE členské funkce vyvolávat výjimky pro více závažné chyby. Specifické informace o interpretaci SCODE závisí na podkladové volání OLE, který vrátila poslední hodnotu SCODE.

Další informace o SCODE najdete v tématu [struktura kódy chyb COM](/windows/desktop/com/structure-of-com-error-codes) v dokumentaci Windows SDK.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Voláním této funkce se získat aktuální hodnotu možnosti aktualizace propojení pro položky OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Návratová hodnota

Jeden z následujících hodnot:

- OLEUPDATE_ALWAYS aktualizovat propojené položky, kdykoli je to možné. Tato možnost podporuje automatické aktualizace propojení přepínací tlačítko v dialogovém okně vazby.

- OLEUPDATE_ONCALL aktualizovat propojené položky pouze na žádost z aplikace typu kontejner (když [UpdateLink](#updatelink) členská funkce je volána). Tato možnost podporuje přepínač Ruční aktualizace propojení v dialogovém okně vazby.

### <a name="remarks"></a>Poznámky

Toto je pokročilá operace.

Tato funkce je volána automaticky [colelinksdialog –](../../mfc/reference/colelinksdialog-class.md) třídy.

Další informace najdete v tématu [IOleLink::GetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-getupdateoptions) v sadě Windows SDK.

##  <a name="gettype"></a>  COleClientItem::GetType

Voláním této funkce k určení, zda je položka OLE vložené nebo propojené nebo static.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Návratová hodnota

Celé číslo bez znaménka s jedním z následujících hodnot:

- Položka OT_LINK OLE je odkaz.

- Položka OT_EMBEDDED OLE je vložen.

- Položka OT_STATIC OLE je statická, to znamená, obsahuje pouze prezentace dat, není nativní data a proto nelze upravit.

##  <a name="getusertype"></a>  COleClientItem::GetUserType

Voláním této funkce získáte zobrazovaná uživateli řetězec popisující typ položky OLE, jako je například "Wordový dokument."

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametry

*nUserClassType*<br/>
Hodnota označující požadovanou variantu řetězec popisující typ položky OLE. To může mít jednu z následujících hodnot:

- USERCLASSTYPE_FULL zadejte celý název zobrazený uživateli.

- USERCLASSTYPE_SHORT A krátký název (maximálně 15 znaků) pro použití v rozbalovací nabídky a dialogovém okně Upravit odkazy.

- USERCLASSTYPE_APPNAME název aplikace, údržba třídy.

*rString*<br/>
Odkaz na [CString](../../atl-mfc-shared/reference/cstringt-class.md) objektu, ke kterému má být vrácen řetězec popisující typ položky OLE.

### <a name="remarks"></a>Poznámky

Často je to položka v registrační databázi systému.

Pokud úplný název typu je požadovaná, ale není k dispozici, použije se místo toho krátký název. Pokud není nalezena žádná položka pro typ položky OLE v registrační databázi, nebo pokud nejsou žádné typy uživatel zaregistrovaný pro typ položky OLE, potom typ uživatel aktuálně uloženy ve položky OLE se používá. Pokud typ uživatelského jména je prázdný řetězec, použije se "Neznámý objekt".

Další informace najdete v tématu [IOleObject::GetUserType](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getusertype) v sadě Windows SDK.

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

Voláním této funkce najdete v článku, zda je položka OLE místě aktivní.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je na místě aktivní; položky OLE. jinak 0.

### <a name="remarks"></a>Poznámky

Je běžné k provádění různých logiky v závislosti na tom, zda se právě upravuje položka na místě. Funkce zkontroluje, zda je aktuální stav položky rovná buď `activeState` nebo `activeUIState`.

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Voláním této funkce najdete v článku, zda je aktuální položky OLE.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je aktuální; položky OLE. jinak 0.

### <a name="remarks"></a>Poznámky

Propojená položka může být zastaralá. Pokud jeho zdrojový dokument se aktualizoval. Vložené položky, která obsahuje odkazy v něm můžete podobně jako zastaralé. Funkce provede kontrolu rekurzivní položky OLE. Mějte na paměti, určující, zda je aktuální položky OLE. může být nákladné jako jako ve skutečnosti provádí se aktualizace.

Tomu se říká automaticky [colelinksdialog –](../../mfc/reference/colelinksdialog-class.md) implementace.

Další informace najdete v tématu [IOleObject::IsUpToDate](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-isuptodate) v sadě Windows SDK.

##  <a name="ismodified"></a>  COleClientItem::IsModified

Voláním této funkce najdete v článku, jestli položky OLE se změny (od posledního uložení změněn).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je změněn; položky OLE. jinak 0.

### <a name="remarks"></a>Poznámky

Další informace najdete v tématu [IPersistStorage::IsDirty](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-isdirty) v sadě Windows SDK.

##  <a name="isopen"></a>  COleClientItem::IsOpen

Voláním této funkce najdete v článku, zda je otevřená; položky OLE. To znamená otevřít v instanci serveru aplikace spuštěné v samostatném okně.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je otevřená; položky OLE. jinak 0.

### <a name="remarks"></a>Poznámky

Používá se k určení toho, kdy nakreslete objekt pomocí vzoru šrafování. Otevřený objekt by měl mít nesouvislého vzoru vykreslen na objekt. Můžete použít [crecttracker –](../../mfc/reference/crecttracker-class.md) objekt jak toho dosáhnout.

##  <a name="isrunning"></a>  COleClientItem::IsRunning

Voláním této funkce najdete v článku, jestli běží položky OLE. To znamená, zda je položka načtena a spuštěna v serverové aplikaci.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud běží položky OLE. jinak 0.

### <a name="remarks"></a>Poznámky

Další informace najdete v tématu [OleIsRunning](/windows/desktop/api/ole2/nf-ole2-oleisrunning) v sadě Windows SDK.

##  <a name="onactivate"></a>  COleClientItem::OnActivate

Volá se rozhraním oznámit položky, že právě aktivaci na místě.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Poznámky

Všimněte si, že tato funkce je volána k označení, zda je spuštěn server, nejsou k označení, že jeho uživatelské rozhraní nainstalované aplikace typu kontejner. V tomto okamžiku objekt nemá žádné aktivní uživatelské rozhraní (není `activeUIState`). Není nainstalovaná. jeho nabídky nebo panelu nástrojů. [OnActivateUI](#onactivateui) členská funkce je volána, pokud k tomu dojde.

Výchozí implementace volá [OnChange](#onchange) členskou funkci s OLE_CHANGEDSTATE jako parametr. Tuto funkci provádět vlastní zpracování, když se položka stane aktivní místní přepište.

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

Rámec volá `OnActivateUI` kdy objekt má zadáno aktivního stavu uživatelského rozhraní.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Poznámky

Objekt má nainstalovat nyní nabídky a panelu nástrojů.

Výchozí implementace pamatuje HWND na server pro pozdější `GetServerWindow` volání.

##  <a name="onchange"></a>  COleClientItem::OnChange

Volá se rozhraním, když uživatel změní, uloží nebo zavře položku OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametry

*nCode*<br/>
Z důvodu serveru změnit tuto položku. Může mít jednu z následujících hodnot:

- OLE_CHANGED OLE vzhledu položky změnila.

- Položka OLE_SAVED OLE se uložil.

- Položka OLE_CLOSED OLE byl uzavřen.

- Položka OLE_CHANGED_STATE OLE byl změněn z jednoho stavu do druhého.

*dwParam*<br/>
Pokud *nCode* OLE_SAVED nebo OLE_CLOSED, tento parametr se nepoužívá. Pokud *nCode* OLE_CHANGED, je tento parametr určuje aspekt položky OLE, které se změnily. Možné hodnoty najdete v článku *dwParam* parametr [COleClientItem::Draw](#draw). Pokud *nCode* OLE_CHANGED_STATE, je tento parametr je `COleClientItem::ItemState` hodnotu výčtu a popisuje stav zadání. To může mít jednu z následujících hodnot: `emptyState`, `loadedState`, `openState`, `activeState`, nebo `activeUIState`.

### <a name="remarks"></a>Poznámky

(Pokud server aplikace je zapsáno s použitím knihovny Microsoft Foundation Class, tato funkce je volána v reakci `Notify` členské funkce `COleServerDoc` nebo `COleServerItem`.) Výchozí implementace označuje dokument kontejneru jako změněnou Pokud *nCode* OLE_CHANGED nebo OLE_SAVED.

Pro OLE_CHANGED_STATE, aktuální stav vrácený [GetItemState](#getitemstate) stále bude starý stav, což znamená, která byla před tuto změnu stavu aktuální stav.

Přepište tato funkce reagovat na změny stavu položky OLE. Obvykle je aktualizovat vzhled položky podle oblasti, ve kterém se zobrazí položka proto už není platná. Na začátku přepsání volejte implementaci základní třídy.

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

Volá se rozhraním pro oznámení kontejneru, který změní rozsah položky OLE. během místní aktivace.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametry

*rectPos*<br/>
Určuje pozici položky vzhledem ke klientské oblasti aplikace typu kontejner.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud úspěšně dojde ke změně pozice položky; jinak 0.

### <a name="remarks"></a>Poznámky

Výchozí implementace Určuje nové obdélník viditelné položky OLE a volání [SetItemRects](#setitemrects) s novými hodnotami. Výchozí implementace vypočítá viditelné obdélník položky a předá tyto informace k serveru.

Tuto funkci použít zvláštní pravidla operace změny velikosti a přesunutí přepište. Pokud je aplikace napsané v knihovně MFC, toto volání dochází, protože server volá [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

Volá se rozhraním, když položky OLE změní ze stavu aktivní na místě ( `activeState`) do načíst stavu, což znamená, že je deaktivováno po aktivace na místě.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Poznámky

Všimněte si, že tato funkce je volána k označení, že položky OLE uzavřeno, není to jeho uživatelské rozhraní se odebral z aplikace typu kontejner. Pokud k tomu dojde, [OnDeactivateUI](#ondeactivateui) členská funkce je volána.

Výchozí implementace volá [OnChange](#onchange) členskou funkci s OLE_CHANGEDSTATE jako parametr. Potlačí tuto funkci provádět vlastní zpracování při deaktivaci aktivní položky v místě. Například pokud podporujete příkaz Zpět v kontejneru aplikace, můžete přepsat má zahodit stav vrácení zpět, tato funkce určující, že jakmile zboží je deaktivováno nelze vrátit zpět poslední operace prováděné s položky OLE.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Volá se rozhraním, když uživatel spustí příkaz zpět po aktivaci položky OLE na místě.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace volá [DeactivateUI](#deactivateui) deaktivace uživatelské rozhraní serveru. Potlačí tuto funkci při implementaci příkazu zpět v kontejneru aplikace. V přepsání volání funkce verze základní třídy a pak vrátit zpět poslední příkaz provést v aplikaci.

Další informace najdete v tématu [IOleInPlaceSite::DeactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) v sadě Windows SDK.

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

Volá se, když uživatel deaktivuje položku, která se aktivovala na místě.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametry

*bUndoable*<br/>
Určuje, zda jsou změny vrátit.

### <a name="remarks"></a>Poznámky

Tato funkce obnoví uživatelské rozhraní aplikace typu kontejner do původního stavu, skrytí všechny nabídky a další ovládací prvky, které byly vytvořeny pro aktivace na místě.

Pokud *bUndoable* má hodnotu FALSE, kontejneru byste zakázat příkaz zpět, výsledkem bude zahazuje zpět stav kontejneru, protože znamená to, že poslední operace prováděné na serveru nevratná.

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

Volá se rozhraním, když uživatel provede akci, která zruší stav vracení zpět při úpravách položky OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Poznámky

Výchozí implementace nemá žádný účinek. Potlačí tuto funkci při implementaci příkazu zpět v kontejneru aplikace. V přepsání zahoďte stav vrácení zpět aplikace typu kontejner.

Server vytvořené pomocí knihovny Microsoft Foundation Class, serveru může způsobit, že tuto funkci volá pomocí volání [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Další informace najdete v tématu [IOleInPlaceSite::DiscardUndoState](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) v sadě Windows SDK.

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

Volá se rozhraním, chcete-li získat `COleDataSource` objekt, který obsahuje všechna data, které by měly umístit do schránky volání na buď [CopyToClipboard](#copytoclipboard) nebo [metody DoDragDrop](#dodragdrop) členskou funkci.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Nastavte na hodnotu TRUE, pokud mají být odkaz data zkopírována do schránky. Nastavte na hodnotu FALSE, pokud váš server aplikace nepodporuje odkazy.

*lpOffset*<br/>
Ukazatel na Posun kurzoru myši ze zdroje objektu v pixelech.

*lpSize*<br/>
Ukazatel na velikost objektu v pixelech.

### <a name="return-value"></a>Návratová hodnota

Ukazatel [coledatasource –](../../mfc/reference/coledatasource-class.md) objekt, který obsahuje data ve schránce.

### <a name="remarks"></a>Poznámky

Výchozí implementace této funkce se volá [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

Rámec volá `OnGetClipRect` členskou funkci zobrazíte obdélník oříznutí souřadnice položky, který je zpracováván na místě.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametry

*rClipRect*<br/>
Ukazatel na objekt třídy [crect –](../../atl-mfc-shared/reference/crect-class.md) , který bude obsahovat obdélník oříznutí souřadnice položky.

### <a name="remarks"></a>Poznámky

Souřadnice jsou uváděny v pixelech vzhledem ke klientské oblasti okna aplikace kontejneru.

Výchozí implementace jednoduše vrací klientský obdélník zobrazení, na kterém je položka místní aktivní.

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

Rámec volá `OnGetItemPosition` členskou funkci, aby se získaly souřadnice položky, který je zpracováván na místě.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametry

*rposition.*<br/>
Odkaz [crect –](../../atl-mfc-shared/reference/crect-class.md) objekt, který bude obsahovat souřadnice polohy položky.

### <a name="remarks"></a>Poznámky

Souřadnice jsou uváděny v pixelech vzhledem ke klientské oblasti okna aplikace kontejneru.

Výchozí implementace této funkce nemá žádný účinek. Aplikace, které podporují místní úpravy vyžadovat jeho implementace.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Volá se rozhraním, když položka aktivuje na místě.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametry

*ppMainFrame*<br/>
Ukazatel na ukazatel na okno hlavního rámce.

*ppDocFrame*<br/>
Ukazatel na ukazatel na rámec okna dokumentu.

*lpFrameInfo*<br/>
Ukazatel [OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) struktura, která se zobrazí informace o okna rámce.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce slouží k načtení informací o nadřazeném okně položky OLE.

Pokud je kontejner aplikace MDI, výchozí implementace vrací ukazatel na [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) objekt *ppMainFrame* a ukazatel na aktivní [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)objekt *ppDocFrame*. Jestli je kontejner aplikace SDI, výchozí implementace vrací ukazatel [CFrameWnd](../../mfc/reference/cframewnd-class.md) objektu v *ppMainFrame* a vrátí hodnotu NULL v *ppDocFrame*. Výchozí implementace také vyplní členy *lpFrameInfo*.

Přepsat tuto funkci pouze v případě, že výchozí implementace není podle aplikace; Například pokud má vaše aplikace paradigma uživatelského rozhraní, které se liší od SDI nebo MDI. To je moderní overridable.

Další informace najdete v tématu [IOleInPlaceSite::GetWindowContext](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) a [OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) struktura v sadě Windows SDK.

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

Volá se rozhraním, během aktivace na místě vložení nabídky aplikace typu kontejner do prázdné nabídky.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Odkazuje na prázdné nabídky.

*lpMenuWidths*<br/>
Odkazuje na pole šest dlouhé hodnoty indikující, kolik nabídky jsou v každé z těchto skupin nabídky: soubor, upravit, kontejner, objekt okna nápovědy. Aplikace typu kontejner je zodpovědná za soubor, kontejner a okno nabídky skupiny, odpovídající prvky 0, 2 a 4 tohoto pole.

### <a name="remarks"></a>Poznámky

Tato nabídka je pak předán na server, který vloží vlastní nabídky, vytváření složené nabídky. Voláním této funkce může být opakovaně sestavení několika složené nabídky.

Výchozí implementace vloží do *pMenuShared* nabídky místní kontejner, což znamená, soubor, kontejner a okno skupiny nabídek. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) slouží k nastavení tohoto prostředku nabídky. Výchozí implementace také přiřadí příslušné hodnoty pro prvky 0, 2 a 4 v *lpMenuWidths*, v závislosti na nabídce prostředků. Potlačí tuto funkci v případě, že výchozí implementace není vhodná pro vaše aplikace; Například pokud vaše aplikace nepoužívá šablony dokumentů pro přidružení k dokumentu typy prostředků. Pokud přepíšete tuto funkci, kterou byste měli také přepsat [OnSetMenu](#onsetmenu) a [OnRemoveMenus](#onremovemenus). To je moderní overridable.

Další informace najdete v tématu [IOleInPlaceFrame::InsertMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) v sadě Windows SDK.

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

Volá se rozhraním, aby se vložily nabídky kontejneru odebrání zadaného složená nabídka. po skončení aktivace na místě.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Odkazuje na složená nabídka. a to provedením volání [OnInsertMenus](#oninsertmenus) členskou funkci.

### <a name="remarks"></a>Poznámky

Výchozí implementace odebere z *pMenuShared* kontejneru místní nabídky, které je, soubor, kontejner a okno skupiny nabídek. Potlačí tuto funkci v případě, že výchozí implementace není vhodná pro vaše aplikace; Například pokud vaše aplikace nepoužívá šablony dokumentů pro přidružení k dokumentu typy prostředků. Pokud přepíšete tuto funkci, měli byste pravděpodobně přepsat [OnInsertMenus](#oninsertmenus) a [OnSetMenu](#onsetmenu) také. To je moderní overridable.

Podnabídek v *pMenuShared* může sdílet více než jeden složené nabídky. Pokud má server opakovaně volat `OnInsertMenus`. Proto byste neměli odstraňovat jakékoli podnabídek v přepsání metody `OnRemoveMenus`; by měla pouze odpojit.

Další informace najdete v tématu [IOleInPlaceFrame::RemoveMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) v sadě Windows SDK.

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

Volá se rozhraním, aby posouval položky OLE v reakci na požadavky ze serveru.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametry

*sizeExtent*<br/>
Určuje vzdálenost, v pixelech, přejděte v x a y pokynů.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud byla položka posunul; 0, pokud položka nelze posunu.

### <a name="remarks"></a>Poznámky

Například pokud uživatel přesune mimo oblast viditelné při provádění úprav na místě, se částečně zobrazila položka OLE voláním této funkce je kurzor ve viditelném stavu. Výchozí implementace nemá žádný účinek. Potlačí tuto funkci, přejděte položky podle zadaného množství. Všimněte si, že v důsledku posouvání, viditelnou část položky OLE. můžete změnit. Volání [SetItemRects](#setitemrects) aktualizovat položky viditelné obdélník.

Další informace najdete v tématu [IOleInPlaceSite::Scroll](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-scroll) v sadě Windows SDK.

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

Volá se rozhraním dvakrát při místní aktivaci začíná a končí; první čas instalace složená nabídka a podruhé (s *holemenu* rovna hodnotě NULL) jeho odstranění.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Ukazatel na složená nabídka. a to provedením volání [OnInsertMenus](#oninsertmenus) členské funkce a `InsertMenu` funkce.

*holemenu*<br/>
Popisovač vrácený popisovač nabídky `OleCreateMenuDescriptor` funkce nebo hodnota NULL, pokud kód dispatching se má odebrat.

*hwndActiveObject*<br/>
Popisovač okna pro úpravy pro položky OLE. To je okno, které budou přijímat příkazy pro úpravy z OLE.

### <a name="remarks"></a>Poznámky

Výchozí implementace nainstaluje nebo odebere složené nabídky a pak zavolá [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor) funkce k instalaci nebo odebrání dispatching kódu. Tato funkce přepište, pokud výchozí implementace není vhodná pro vaši aplikaci. Pokud přepíšete tuto funkci, měli byste pravděpodobně přepsat [OnInsertMenus](#oninsertmenus) a [OnRemoveMenus](#onremovemenus) také. To je moderní overridable.

Další informace najdete v tématu [OleCreateMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor), a [IOleInPlaceFrame::SetMenu](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) v sadě Windows SDK.

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

Volá se rozhraním, aby zobrazení a skrytí ovládacích panelů aplikace typu kontejner.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametry

*pFrameWnd*<br/>
Ukazatel na okno rámce aplikace kontejneru. To může být hlavní okno rámce nebo podřízené okno MDI.

*bShow*<br/>
Určuje, zda mají ovládací pruhy zobrazený nebo skrytý.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud volání funkce způsobí, že změna ve státě ovládací pruhy 0 Pokud volání způsobí ignorování jakýchkoli změn, nebo pokud *pFrameWnd* neukazuje na okno rámce kontejneru.

### <a name="remarks"></a>Poznámky

Tato funkce vrátí 0, pokud ovládací pruhy již v určeném stavu *bShow.* K tomu může dojít například, pokud jsou skryté ovládací pruhy a *bShow* je FALSE.

Výchozí implementace panelu nástrojů odebere z okna nejvyšší úrovně rámce.

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

Volá se rozhraním, aby se zobrazila položka OLE, zviditelnění zcela během úprav.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Poznámky

Používá se při svou aplikaci typu kontejner podporuje odkazy na vložené položky (tj. Pokud mají odvozené třídě dokumentu z [colelinkingdoc –](../../mfc/reference/colelinkingdoc-class.md)). Tato funkce je volána v průběhu aktivace na místě nebo když je položka OLE zdroj odkazu a chce uživatel upravit. Výchozí implementace aktivuje první zobrazení v dokumentu kontejneru. Přepsání této funkce posune dokument tak, aby se zobrazila položka OLE.

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

Volá se rozhraním při místní aktivaci za účelem aktualizace záhlaví okna rámce.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud tato funkce se úspěšně aktualizovala název rámce, jinak hodnotu nula.

### <a name="remarks"></a>Poznámky

Výchozí implementace nezmění název okna rámce. Přepsat tuto funkci, pokud chcete, aby název jiné rámce pro vaši aplikaci, například " *aplikace server* - *položky* v *docname*" (tj. "Microsoft Excel – tabulky do sestavy. DOC"). To je moderní overridable.

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

Voláním této funkce vrátit zpět poslední operace prováděné uživatelem během úprav na místě a opětovná aktivace položky OLE.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Pokud svou aplikaci typu kontejner podporuje příkaz zpět, voláním této funkce, pokud uživatel vybere příkaz zpět ihned po deaktivaci položky OLE.

Pokud je serverová aplikace napsané pomocí knihovny tříd Microsoft Foundation, tato funkce způsobí, že server pro volání [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Další informace najdete v tématu [IOleInPlaceObject::ReactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) v sadě Windows SDK.

##  <a name="release"></a>  COleClientItem::Release

Voláním této funkce chcete vyčistit prostředky používané položkou OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Příznak určující, za jakých okolností je uložen položky OLE. až se obnoví načíst stav. Seznam možných hodnot najdete v tématu [COleClientItem::Close](#close).

### <a name="remarks"></a>Poznámky

`Release` je volán `COleClientItem` destruktor.

Další informace najdete v tématu [IUnknown::Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) v sadě Windows SDK.

##  <a name="reload"></a>  COleClientItem::Reload

Zavře a znovu načte položky.

```
BOOL Reload();
```

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Volání `Reload` funkce po aktivaci položky jako položka jiného typu voláním [ActivateAs](#activateas).

##  <a name="run"></a>  COleClientItem::Run

Spuštění aplikace přidružené k této položce.

```
void Run();
```

### <a name="remarks"></a>Poznámky

Volání `Run` členská funkce spuštění serverové aplikace před aktivací položky. To se provádí automaticky [aktivovat](#activate) a [funkce DoVerb](#doverb), takže obvykle není nutné volat tuto funkci. Voláním této funkce, pokud je potřeba spustit na serveru k nastavte atribut položky, jako je třeba [SetExtent](#setextent), před provedením [funkce DoVerb](#doverb).

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

Volání `SetDrawAspect` členskou funkci pro nastavení "aspekt", nebo zobrazení položky.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametry

*nDrawAspect*<br/>
Hodnota z výčtu DVASPECT. Tento parametr může mít jednu z následujících hodnot:

- Položky DVASPECT_CONTENT je reprezentována způsobem, že může být zobrazen jako vložený objekt uvnitř svého kontejneru.

- DVASPECT_THUMBNAIL položky se vykreslí v reprezentaci "miniaturu" tak, aby ji bylo možné zobrazit v nástroji pro procházení.

- Položka DVASPECT_ICON je reprezentován ikonou.

- Položka DVASPECT_DOCPRINT je reprezentována jako kdyby byly zobrazeny, pomocí příkazu tisknout z nabídky soubor.

### <a name="remarks"></a>Poznámky

Aspekt Určuje, jak se má položka zobrazovat [nakreslit](#draw) když výchozí hodnotu pro tuto funkci *nDrawAspect* argument se používá.

Tato funkce je volána automaticky změnit ikonu (a další dialogová okna, které volají přímo dialogové okno Změnit ikonu) umožňující aspekt ikonickým zobrazení při požadavku uživatele.

##  <a name="setextent"></a>  COleClientItem::SetExtent

Voláním této funkce určete, kolik místa je k dispozici pro položky OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametry

*Velikost*<br/>
A [CSize](../../atl-mfc-shared/reference/csize-class.md) objekt, který obsahuje informace o velikosti.

*nDrawAspect*<br/>
Určuje aspekt položky OLE, jejichž rozsah je nastavit. Možné hodnoty najdete v části [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Poznámky

Serverová aplikace vytvořené pomocí knihovny Microsoft Foundation Class, to způsobí, že [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) členskou funkci k odpovídající položce `COleServerItem` objektu, která se má volat. Položky OLE. potom můžete odpovídajícím způsobem upravit jeho zobrazení. Dimenze musí být v jednotkách MM_HIMETRIC. Voláním této funkce, když uživatel změní velikost položky OLE. nebo pokud podporujete nějakou formu vyjednávání rozložení.

Další informace najdete v tématu [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent) v sadě Windows SDK.

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

Voláním této funkce zadejte název aplikace typu kontejner a název kontejneru pro vložené položky OLE.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametry

*lpszHost*<br/>
Ukazatel na uživatelské zobrazovaný název aplikace typu kontejner.

*lpszHostObj*<br/>
Ukazatel na řetězec identifikující kontejner, který obsahuje položky OLE.

### <a name="remarks"></a>Poznámky

Serverová aplikace vytvořené pomocí knihovny Microsoft Foundation Class, tato funkce volá [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) členskou funkci `COleServerDoc` dokumentu, který obsahuje položky OLE. Tyto informace se používá v názvy oken, když se upravuje položka OLE. Pokaždé, když načtení dokumentu kontejneru rozhraní volá tuto funkci pro všechny položky OLE v dokumentu. `SetHostNames` platí pouze pro vložené položky. Není nutné volat tuto funkci pokaždé, když se aktivuje vložené položky OLE pro úpravy.

To se také nazývá automaticky s názvem aplikace a název dokumentu při načtení objektu, nebo když je soubor uložen pod jiným názvem. Proto není obvykle nutné tuto funkci volat přímo.

Další informace najdete v tématu [IOleObject::SetHostNames](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-sethostnames) v sadě Windows SDK.

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

Ukládá do mezipaměti metasoubor použitý pro vykreslení položky ikony.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametry

*hMetaPict*<br/>
Popisovač pro tento metasoubor použitý pro vykreslení položky ikonu.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Použití [GetIconicMetafile](#geticonicmetafile) načíst metasouboru.

*HMetaPict* parametr je zkopírován do položky; proto *hMetaPict* volající musí být uvolněna.

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

Volání této funkce nastavíte ohraničující obdélník nebo viditelné obdélník položky OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*lprcPosRect*<br/>
Ukazatel na obdélník, který obsahuje rozsah položky OLE. vzhledem k jeho nadřazenému oknu, v souřadnicích klienta.

*lprcClipRect*<br/>
Ukazatel na obdélník, který obsahuje hranice viditelnou část položky OLE. vzhledem k jeho nadřazenému oknu, v souřadnicích klienta.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud je úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce se volá výchozí implementace [OnChangeItemPosition](#onchangeitemposition) členskou funkci. Tuto funkci byste měli volat pokaždé, když se pozice nebo OLE viditelnou část položky změny. Obvykle to znamená, že volání ze zobrazení [upravuje místně](../../mfc/reference/cwnd-class.md#onsize) a [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) členské funkce.

Další informace najdete v tématu [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) v sadě Windows SDK.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Voláním této funkce nastavit možnost aktualizace propojení pro prezentaci určitou propojenou položku.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametry

*dwUpdateOpt*<br/>
Hodnota možnosti odkaz – aktualizace pro tuto položku. Tato hodnota musí být jedna z následujících akcí:

- OLEUPDATE_ALWAYS aktualizovat propojené položky, kdykoli je to možné. Tato možnost podporuje automatické aktualizace propojení přepínací tlačítko v dialogovém okně vazby.

- OLEUPDATE_ONCALL aktualizovat propojené položky pouze na žádost z aplikace typu kontejner (když [UpdateLink](#updatelink) členská funkce je volána). Tato možnost podporuje přepínač Ruční aktualizace propojení v dialogovém okně vazby.

### <a name="remarks"></a>Poznámky

Obvykle byste neměli měnit možnosti aktualizace uživatelem v dialogovém okně vazby.

Další informace najdete v tématu [IOleLink::SetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-setupdateoptions) v sadě Windows SDK.

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

Voláním této funkce, chcete-li změnit tisk cílovému zařízení pro tuto položku.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametry

*ptd*<br/>
Ukazatel [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) datová struktura, která obsahuje informace o nové tiskové cílové zařízení. Může mít hodnotu NULL.

*PPD*<br/>
Ukazatel [PRINTDLG](https://msdn.microsoft.com/library/windows/desktop/ms646940) datová struktura, která obsahuje informace o nové tiskové cílové zařízení. Může mít hodnotu NULL.

### <a name="return-value"></a>Návratová hodnota

Nenulové, pokud funkce byla úspěšná. jinak 0.

### <a name="remarks"></a>Poznámky

Tato funkce aktualizuje tisk cílovému zařízení pro položku, ale ne k aktualizaci mezipaměti prezentace. Chcete-li aktualizovat mezipaměť prezentaci pro některou položku, zavolejte [UpdateLink](#updatelink).

Argumenty pro tuto funkci obsahují informace, které systém technologie OLE se používá k identifikaci cílové zařízení. `PRINTDLG` Struktura obsahuje informace, které Windows používá k inicializaci dialogového okna běžné tisk. Poté, co uživatel zavře dialogové okno, Windows vrátí informace o výběru uživatele v této struktuře. `m_pd` Členem [cprintdialog –](../../mfc/reference/cprintdialog-class.md) je objekt `PRINTDLG` struktury.

Další informace o této struktuře naleznete v tématu [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) v sadě Windows SDK.

Další informace najdete v tématu [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) v sadě Windows SDK.

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

Voláním této funkce, které chcete provést aktualizaci okamžitě prezentace dat položky OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Návratová hodnota

V případě úspěchu; nenulovou hodnotu. jinak 0.

### <a name="remarks"></a>Poznámky

Propojené položky vyhledá funkce zdroj odkazu k získání nového prezentaci pro položky OLE. Tento proces může zahrnovat jeden nebo více aplikace serveru, které by mohly být časově náročné. Pro vložené položky pracuje funkce rekurzivně, kontroluje, zda obsahuje vloženou položku odkazy, které můžou být zastaralé a jejich aktualizace. Uživatel také aktualizovat ručně pomocí dialogového okna odkazy jednotlivé odkazy.

Další informace najdete v tématu [IOleLink::Update](/windows/desktop/api/oleidl/nf-oleidl-iolelink-update) v sadě Windows SDK.

## <a name="see-also"></a>Viz také

[Ukázky knihovny MFC MFCBIND](../../visual-cpp-samples.md)<br/>
[Ukázky knihovny MFC OCLIENT](../../visual-cpp-samples.md)<br/>
[CDocItem – třída](../../mfc/reference/cdocitem-class.md)<br/>
[Graf hierarchie](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem – třída](../../mfc/reference/coleserveritem-class.md)
